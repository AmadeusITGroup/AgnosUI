import{b as c,a as m,j as g,w as v,r as l}from"./dom-gfxqXJpK-DnwY-KAj.js";import{e as y}from"./extendWidget-CRSgS6m7.js";import{t as _}from"./stores-CNc_rSPE.js";import{k as C,b as H}from"./writables-CgpOQ4hA-Cd7Z63K9.js";import{c as D}from"./common-BqUjUBPy-4D9Ln06d.js";var W=Object.defineProperty,b=i=>{throw TypeError(i)},$=(i,e,t)=>e in i?W(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,r=(i,e,t)=>$(i,typeof e!="symbol"?e+"":e,t),w=(i,e,t)=>e.has(i)||b("Cannot "+t),a=(i,e,t)=>(w(i,e,"read from private field"),t?t.call(i):e.get(i)),h=(i,e,t)=>e.has(i)?b("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),A=(i,e,t,s)=>(w(i,e,"write to private field"),e.set(i,t),t),M=(i,e,t,s)=>({set _(n){A(i,e,n)},get _(){return a(i,e,s)}}),u,d,o;const P={autoHide:!0,delay:5e3},N={autoHide:H,delay:C(0,1/0,{strict:!0})};function E(i){let e;const t=y(D,P,N)(i),s=c(()=>{clearTimeout(e),t.stores.autoHide$()&&(e=setTimeout(()=>t.api.close(),t.stores.delay$()))}),n=m(()=>({attributes:{role:l("alert"),"aria-atomic":l("true"),class:c(()=>t.stores.className$())},classNames:{"au-toast":_,toast:_}})),p=m(()=>({attributes:{type:l("button"),"aria-label":c(()=>t.stores.ariaCloseButtonLabel$())},events:{click:t.api.close}}));return{...t,directives:{...t.directives,autoHideDirective:g(s),bodyDirective:n,closeButtonDirective:p}}}const T={duration:5e3,position:"bottomRight",dismissible:!1};class F{constructor(e){h(this,u,0),h(this,d,v([])),r(this,"toasts",c(()=>a(this,d).call(this).sort((t,s)=>s.id-t.id).slice(0,this.options().limit))),r(this,"options",v(T)),h(this,o,new Map),r(this,"addTimer",(t,s=this.options().duration)=>{s>0&&a(this,o).set(t,{timeout:setTimeout(()=>this.removeToast(t),s),started:performance.now(),duration:s})}),r(this,"pauseTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);s&&s.timeout&&(clearTimeout(s.timeout),s.timeout=null,s.paused=performance.now())}}),r(this,"resumeTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);if(s){const p=(s.paused??s.started)-s.started,f=(s.duration??0)-p;this.addTimer(t,f),s.duration=f,s.paused=void 0}}}),r(this,"eventsDirective",m(t=>({events:{pointerenter:()=>this.options().pauseOnHover&&this.pauseTimer(t()),pointerleave:()=>this.options().pauseOnHover&&this.resumeTimer(t())}}))),r(this,"addToast",t=>{const s=t.autoHide??this.options().duration>0;return a(this,d).update(n=>[...n,{id:M(this,u)._++,props:t}]),s&&this.addTimer(a(this,u)-1,t.delay),a(this,u)-1}),r(this,"removeToast",t=>{a(this,o).delete(t),a(this,d).update(s=>s.filter(n=>n.id!==t))}),r(this,"updateToasts",()=>{this.options().duration===0&&(this.options().dismissible=!0)}),r(this,"closeAll",()=>{a(this,d).set([]),a(this,o).clear()}),this.options.set({...T,...e}),this.options.subscribe(()=>{this.updateToasts()})}get timers(){return new Map(a(this,o))}}u=new WeakMap;d=new WeakMap;o=new WeakMap;export{F as T,E as c,T as d};
