import{b as u,a as m,k as y,r as l,w as v}from"./dom-gfxqXJpK-BAcWixjJ.js";import{e as b}from"./extendWidget-BcmC0c8l.js";import{t as _}from"./stores-DrD8dowx.js";import{k as C,c as H}from"./writables-CgpOQ4hA-BeXDOspc.js";import{c as W}from"./common-BqUjUBPy-Yu2l_NWp.js";import{c as D}from"./widget-zFin9FlD.js";var $=Object.defineProperty,g=i=>{throw TypeError(i)},A=(i,e,t)=>e in i?$(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,r=(i,e,t)=>A(i,typeof e!="symbol"?e+"":e,t),w=(i,e,t)=>e.has(i)||g("Cannot "+t),a=(i,e,t)=>(w(i,e,"read from private field"),t?t.call(i):e.get(i)),h=(i,e,t)=>e.has(i)?g("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),M=(i,e,t,s)=>(w(i,e,"write to private field"),e.set(i,t),t),P=(i,e,t,s)=>({set _(n){M(i,e,n)},get _(){return a(i,e,s)}}),d,c,o;const k={autoHide:!0,delay:5e3},N={autoHide:H,delay:C(0,1/0,{strict:!0})},I=D("toast",i=>{let e;const t=b(W,k,N)(i),s=u(()=>{clearTimeout(e),t.stores.autoHide$()&&(e=setTimeout(()=>t.api.close(),t.stores.delay$()))}),n=m(()=>({attributes:{role:l("alert"),"aria-atomic":l("true"),class:u(()=>t.stores.className$())},classNames:{"au-toast":_,toast:_}})),p=m(()=>({attributes:{type:l("button"),"aria-label":u(()=>t.stores.ariaCloseButtonLabel$())},events:{click:t.api.close}}));return{...t,directives:{...t.directives,autoHideDirective:y(s),bodyDirective:n,closeButtonDirective:p}}}),T={duration:5e3,position:"bottomRight",dismissible:!1};class R{constructor(e){h(this,d,0),h(this,c,v([])),r(this,"toasts",u(()=>a(this,c).call(this).sort((t,s)=>s.id-t.id).slice(0,this.options().limit))),r(this,"options",v(T)),h(this,o,new Map),r(this,"addTimer",(t,s=this.options().duration)=>{s>0&&a(this,o).set(t,{timeout:setTimeout(()=>this.removeToast(t),s),started:performance.now(),duration:s})}),r(this,"pauseTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);s&&s.timeout&&(clearTimeout(s.timeout),s.timeout=null,s.paused=performance.now())}}),r(this,"resumeTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);if(s){const p=(s.paused??s.started)-s.started,f=(s.duration??0)-p;this.addTimer(t,f),s.duration=f,s.paused=void 0}}}),r(this,"eventsDirective",m(t=>({events:{pointerenter:()=>this.options().pauseOnHover&&this.pauseTimer(t()),pointerleave:()=>this.options().pauseOnHover&&this.resumeTimer(t())}}))),r(this,"addToast",t=>{const s=t.autoHide??this.options().duration>0;return a(this,c).update(n=>[...n,{id:P(this,d)._++,props:t}]),s&&this.addTimer(a(this,d)-1,t.delay),a(this,d)-1}),r(this,"removeToast",t=>{a(this,o).delete(t),a(this,c).update(s=>s.filter(n=>n.id!==t))}),r(this,"updateToasts",()=>{this.options().duration===0&&(this.options().dismissible=!0)}),r(this,"closeAll",()=>{a(this,c).set([]),a(this,o).clear()}),this.options.set({...T,...e}),this.options.subscribe(()=>{this.updateToasts()})}get timers(){return new Map(a(this,o))}}d=new WeakMap;c=new WeakMap;o=new WeakMap;export{R as T,I as c,T as d};
