import{aD as v}from"./COvVlgKq.js";import{g as S,c as V}from"./Ctmrvw7H.js";import{b as k,i as w,c as l,a as g,r as f,w as y,d as D,g as O,e as $}from"./RklJk25m.js";function P(e){let t;const o=V(r=>{let n=!1;const a=e.subscribe(c=>{t=c,n&&r()});return n=!0,a});function s(){return v()?(o(),t):S(e)}return"set"in e?{get current(){return s()},set current(r){e.set(r)}}:{get current(){return s()}}}const R=Symbol(),p=Symbol();function N(e){return function(t){k(()=>{for(const[o,s]of Object.entries(t))e[`${o}$`]?.set(s)})}}function j(e,t){if(e===t)return null;let o=!1;const s={},r=new Set([...Object.keys(e),...Object.keys(t)]);for(const n of r){const a=t[n];e[n]!==a&&(s[n]=a,o=!0)}return o?s:null}function W(e,t=f(void 0),o={},s=y(void 0)){const{normalizeValue:r=w,equal:n=Object.is}=o,a=()=>e,c=(i,u=a)=>{const b=i===void 0?void 0:r(i);return b===p?(console.error("Not using invalid value",i),u()):b===void 0?u():b},d=l(()=>c(t()),{equal:n}),h=l(()=>c(s(),d),{equal:n});return g(h,i=>{if(i!==void 0){const u=r(i);if(u===p){console.error("Not setting invalid value",i);return}i=u}s.set(i)})}const m=e=>!!(e&&typeof e=="function"&&"subscribe"in e),z=e=>m(e)?e:f(e),A=e=>m(e)?e:y(e),I=(e,t)=>{const o={};if(t){const s=m(t);for(const r of e)o[r]=s?l(()=>t()[r]):z(t[r])}return o},E=(e,t,o)=>{const s={},r=Object.keys(e),n=I(r,t?.config),a=t?.props;for(const c of r){const d=a?.[c];s[`${c}$`]=W(e[c],n[c],o?.[c],A(d))}return s},C=(e,t,o)=>{const s=E(e,t,o);return[s,N(s)]},L=e=>{const t=[],o=[],s={};for(const[r,n]of Object.entries(e))r.endsWith("$")&&(t.push(r.substring(0,r.length-1)),o.push(n),s[r]=D(n));return{stores:s,state$:l(()=>{const r=o.map(O),n={};return t.forEach((a,c)=>{n[a]=r[c]}),n})}},T=(e,t,o=r=>r[0],s=(r,n)=>n===r)=>{let r=t[0]();return g($(t,{derive(n){const a=o(n),c=!s(n[0],a);return c&&t[0].set(a),(c||!s(r,a))&&(r=a,e()(a)),a},equal:s}),t[0].set.bind(t[0]))};f(!0);f(!1);export{R as F,p as I,j as a,T as b,P as f,L as s,z as t,C as w};
