import{I as Y,n as v,w as Z,c as m,d as T,e as U,f as nn,g as tn,h as _}from"./stores.SxxUJTei.js";import{c as en,p as j,m as on,d as sn,a as an,i as rn,b as R,f as ln}from"./app.BeURa239.js";function k(n){return n===!0||n===!1}function cn(n){return typeof n=="function"}function un(n){return typeof n=="string"}const dn=n=>e=>e===null||n(e),g=n=>e=>n(e)?e:Y,O={normalizeValue:g(k)},pn={normalizeValue:g(dn(k))},$n={normalizeValue:g(un)},V={normalizeValue:g(cn),equal:Object.is},W=new Promise(v),fn=(n,e)=>{n.style.display=e==="show"?"":"none"},bn={animated:!0,animatedOnInit:!1,initDone:null,visible:!0,transition:fn,onShown:v,onHidden:v,onVisibleChange:v},mn={animated:O,animatedOnInit:O,visible:O,transition:V,onShown:V,onHidden:V,onVisibleChange:V,initDone:pn},Sn=n=>{const[{animated$:e,initDone$:l,visible$:r,transition$:u,onShown$:D,onHidden$:C,onVisibleChange$:w,animatedOnInit$:y},p]=Z(bn,n,mn),{element$:A,directive:G}=en(),x=m(()=>!!A()),h=T(w,[r],([t])=>t),f=U(null),E=m(()=>!!f()),B=()=>{let t;return f.update(o=>(o?.abort.abort(),t=o?.context,null)),t},J=(t,o,c,s)=>_(()=>{const $=new AbortController,a=$.signal,d=B()??{},{promise:b,resolve:z}=j(),S={abort:$,animated:o,visible:t,context:d,element:c,transitionFn:s,promise:b};return f.set(S),z((async()=>{var M;try{await s(c,t?"show":"hide",o,a,d)}finally{a.aborted?await W:(f.set(null),(M=(t?D:C)())==null||M())}})()),S}),K=m(()=>!E()&&h()&&x()),Q=m(()=>!E()&&!h()),H=m(()=>l()?e():y()),I=U(null);let N,L=r(),i=null;const q=nn([h,A,H,I,u,f],([t,o,c,s,$,a])=>{const d=N!==o;N=o;const b=L!==t;if(L=t,o){l()==null&&l.set(!0);const z=s!=null&&a&&a.animated!=s;if(d||b||z){(b||s!=null)&&(i=null);const S=s??i?.animated??(d&&!t?!1:c);a=J(t,S,o,$),i?.resolve(a.promise),i=null}}else d&&(B(),a=null),(b||t&&i?.animated!==s)&&(i=t&&s!=null?{animated:s,...j()}:null);return i?.promise??a?.promise});let F={};const P=async(t=!r(),o=H())=>{const c={};F=c;try{await _(()=>{try{return I.set(o),r.set(t),q()}finally{I.set(null)}})}finally{F!==c&&await W}},X=on(G,an(t=>{t&&p(t)}),sn(q));return{...tn({visible$:h,element$:A,elementPresent$:x,transitioning$:E,shown$:K,hidden$:Q}),patch:p,directives:{directive:X},actions:{},api:{show:P.bind(null,!0),hide:P.bind(null,!1),toggle:P}}};function vn(n){return window.getComputedStyle(n).transitionProperty!=="none"}function wn(n){const{transitionDelay:e,transitionDuration:l}=window.getComputedStyle(n),r=parseFloat(e),u=parseFloat(l);return(r+u)*1e3}const Vn=n=>async(e,l,r,u,D)=>{const C=n(e,l,r,D)??v;if(rn(e)&&r&&vn(e)){const w=R(u,"abort"),y=R(e,"transitionend"),p=ln(wn(e));await Promise.race([w.promise,y.promise,p.promise]),w.unsubscribe(),y.unsubscribe(),p.unsubscribe()}u.aborted||C()};export{Sn as a,$n as b,Vn as c,O as t};
