import{L as Y,aH as W,g as Z,m as nn,b as en,ax as tn,a8 as sn}from"./CCa7hPa2.js";import{g as on}from"./CCYm-FyV.js";import{I as rn,n as g,j as an,k as ln,f as y,l as un,w as F,g as cn,m as dn,o as j,q as fn,t as mn,u as pn}from"./Clz_R8pH.js";import{p as M,a as R,c as bn}from"./Bnr_hhk2.js";function wn(n){Y(n,n.v+1)}function yn(n){let e=0,o=sn(0),i;return()=>{W()&&(Z(o),nn(()=>(e===0&&(i=en(()=>n(()=>wn(o)))),e+=1,()=>{tn().then(()=>{e-=1,e===0&&(i?.(),i=void 0)})})))}}function Hn(n){let e;const o=yn(a=>{let d=!1;const p=n.subscribe(f=>{e=f,d&&a()});return d=!0,p});function i(){return W()?(o(),e):on(n)}return"set"in n?{get current(){return i()},set current(a){n.set(a)}}:{get current(){return i()}}}function G(n){return n===!0||n===!1}function gn(n){return typeof n=="function"}function hn(n){return typeof n=="string"}const $n=n=>e=>e===null||n(e);function vn(n){return e=>n.includes(e)}const h=n=>e=>n(e)?e:rn,O={normalizeValue:h(G)},Sn={normalizeValue:h($n(G))},On={normalizeValue:h(hn)},C={normalizeValue:h(gn),equal:Object.is};function kn(n){return{normalizeValue:h(vn(n))}}const U=new Promise(g),Vn=(n,e)=>{n.style.display=e==="show"?"":"none"},Dn={animated:!0,animatedOnInit:!1,initDone:null,visible:!0,transition:Vn,onShown:g,onHidden:g,onVisibleChange:g},Cn={animated:O,animatedOnInit:O,visible:O,transition:C,onShown:C,onHidden:C,onVisibleChange:C,initDone:Sn},Bn=n=>{const[{animated$:e,initDone$:o,visible$:i,transition$:a,onShown$:d,onHidden$:p,onVisibleChange$:f,animatedOnInit$:$},v]=an(Dn,n,Cn),{element$:E,directive:J}=ln(),A=y(()=>!!E()),S=un(f,[i],([t])=>t),b=F(null),k=()=>{let t;return b.update(s=>(s?.abort.abort(),t=s?.context,null)),t},K=(t,s,c,l)=>j(()=>{const V=new AbortController,u=V.signal,m=k()??{},{promise:w,resolve:H}=M(),D={abort:V,animated:s,visible:t,context:m,element:c,transitionFn:l,promise:w};return b.set(D),H((async()=>{var q;try{await l(c,t?"show":"hide",s,u,m)}finally{u.aborted?await U:(b.set(null),(q=(t?d:p)())==null||q())}})()),D}),B=y(()=>o()?e():$()),z=F(null);let L,N=i(),r=null;const I=cn([S,E,B,z,a,b],([t,s,c,l,V,u])=>{const m=L!==s;L=s;const w=N!==t;if(N=t,s){o()==null&&o.set(!0);const H=l!=null&&u&&u.animated!=l;if(m||w||H){(w||l!=null)&&(r=null);const D=l??r?.animated??(m&&!t?!1:c);u=K(t,D,s,V),r?.resolve(u.promise),r=null}}else m&&(k(),u=null),(w||t&&r?.animated!==l)&&(r=t&&l!=null?{animated:l,...M()}:null);return r?.promise??u?.promise});let _={};const P=async(t=!i(),s=B())=>{const c={};_=c;try{await j(()=>{try{return z.set(s),i.set(t),I()}finally{z.set(null)}})}finally{_!==c&&await U}},x=y(()=>(A()&&I(),!!b())),Q=y(()=>!x()&&S()&&A()),T=y(()=>!x()&&!S()),X=fn(J,mn(I));return{...dn({visible$:S,element$:E,elementPresent$:A,transitioning$:x,shown$:Q,hidden$:T}),patch:v,directives:{directive:X},api:{show:P.bind(null,!0),hide:P.bind(null,!1),toggle:P}}};function En(n){return window.getComputedStyle(n).transitionProperty!=="none"}function An(n){const{transitionDelay:e,transitionDuration:o}=window.getComputedStyle(n),i=parseFloat(e),a=parseFloat(o);return(i+a)*1e3}const Ln=n=>async(e,o,i,a,d)=>{const p=n(e,o,i,d)??g;if(pn(e)&&i&&En(e)){const f=R(a,"abort"),$=R(e,"transitionend"),v=bn(An(e));await Promise.race([f.promise,$.promise,v.promise]),f.unsubscribe(),$.unsubscribe(),v.unsubscribe()}a.aborted||p()};export{Bn as a,C as b,Ln as c,On as d,kn as e,Hn as f,O as t};
