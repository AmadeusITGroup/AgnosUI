import{M as Y,aH as W,g as Z,a8 as nn,m as tn,b as en,ax as sn}from"./DTamszzQ.js";import{g as on}from"./CoDKfKQr.js";import{I as rn,l as an,n as y,i as w,m as ln,w as M,j as un,h as j,o as cn}from"./BnHOHWYN.js";import{c as dn,p as q,m as fn,d as mn,a as pn,f as R,g as bn}from"./MA6XYiAZ.js";function vn(n){Y(n,n.v+1)}function wn(n){let t=0,o=nn(0),i;return()=>{W()&&(Z(o),tn(()=>(t===0&&(i=en(()=>n(()=>vn(o)))),t+=1,()=>{sn().then(()=>{t-=1,t===0&&(i?.(),i=void 0)})})))}}function Hn(n){let t;const o=wn(a=>{let d=!1;const p=n.subscribe(f=>{t=f,d&&a()});return d=!0,p});function i(){return W()?(o(),t):on(n)}return"set"in n?{get current(){return i()},set current(a){n.set(a)}}:{get current(){return i()}}}function G(n){return n===!0||n===!1}function yn(n){return typeof n=="function"}function gn(n){return typeof n=="string"}const hn=n=>t=>t===null||n(t);function $n(n){return t=>n.includes(t)}const g=n=>t=>n(t)?t:rn,O={normalizeValue:g(G)},Sn={normalizeValue:g(hn(G))},On={normalizeValue:g(gn)},C={normalizeValue:g(yn),equal:Object.is};function Bn(n){return{normalizeValue:g($n(n))}}const U=new Promise(y),Vn=(n,t)=>{n.style.display=t==="show"?"":"none"},Dn={animated:!0,animatedOnInit:!1,initDone:null,visible:!0,transition:Vn,onShown:y,onHidden:y,onVisibleChange:y},Cn={animated:O,animatedOnInit:O,visible:O,transition:C,onShown:C,onHidden:C,onVisibleChange:C,initDone:Sn},Nn=n=>{const[{animated$:t,initDone$:o,visible$:i,transition$:a,onShown$:d,onHidden$:p,onVisibleChange$:f,animatedOnInit$:h},$]=an(Dn,n,Cn),{element$:E,directive:J}=dn(),A=w(()=>!!E()),S=ln(f,[i],([e])=>e),b=M(null),B=()=>{let e;return b.update(s=>(s?.abort.abort(),e=s?.context,null)),e},K=(e,s,c,l)=>j(()=>{const V=new AbortController,u=V.signal,m=B()??{},{promise:v,resolve:H}=q(),D={abort:V,animated:s,visible:e,context:m,element:c,transitionFn:l,promise:v};return b.set(D),H((async()=>{var L;try{await l(c,e?"show":"hide",s,u,m)}finally{u.aborted?await U:(b.set(null),(L=(e?d:p)())==null||L())}})()),D}),N=w(()=>o()?t():h()),z=M(null);let _,k=i(),r=null;const I=un([S,E,N,z,a,b],([e,s,c,l,V,u])=>{const m=_!==s;_=s;const v=k!==e;if(k=e,s){o()==null&&o.set(!0);const H=l!=null&&u&&u.animated!=l;if(m||v||H){(v||l!=null)&&(r=null);const D=l??r?.animated??(m&&!e?!1:c);u=K(e,D,s,V),r?.resolve(u.promise),r=null}}else m&&(B(),u=null),(v||e&&r?.animated!==l)&&(r=e&&l!=null?{animated:l,...q()}:null);return r?.promise??u?.promise});let F={};const P=async(e=!i(),s=N())=>{const c={};F=c;try{await j(()=>{try{return z.set(s),i.set(e),I()}finally{z.set(null)}})}finally{F!==c&&await U}},x=w(()=>(A()&&I(),!!b())),Q=w(()=>!x()&&S()&&A()),T=w(()=>!x()&&!S()),X=fn(J,mn(I));return{...cn({visible$:S,element$:E,elementPresent$:A,transitioning$:x,shown$:Q,hidden$:T}),patch:$,directives:{directive:X},api:{show:P.bind(null,!0),hide:P.bind(null,!1),toggle:P}}};function En(n){return window.getComputedStyle(n).transitionProperty!=="none"}function An(n){const{transitionDelay:t,transitionDuration:o}=window.getComputedStyle(n),i=parseFloat(t),a=parseFloat(o);return(i+a)*1e3}const _n=n=>async(t,o,i,a,d)=>{const p=n(t,o,i,d)??y;if(pn(t)&&i&&En(t)){const f=R(a,"abort"),h=R(t,"transitionend"),$=bn(An(t));await Promise.race([f.promise,h.promise,$.promise]),f.unsubscribe(),h.unsubscribe(),$.unsubscribe()}a.aborted||p()};export{O as a,C as b,_n as c,Nn as d,Bn as e,Hn as f,On as t};
