import{a as We,c as Xe,d as Ye,f as Ze}from"./chunk-A7T7RP5R.js";import{f as Be,m as ze,p as Ge,r as Ue}from"./chunk-WQLJIVWX.js";import"./chunk-UMNJNVSJ.js";import{$b as o,Ab as Fe,Bb as Ke,Cb as Ve,Db as E,Ga as M,H as u,Mb as je,N as ne,Nb as b,Ob as B,P as g,Ra as Ce,T as re,U as T,Ub as $e,V as k,Wa as $,Y as A,Ya as Pe,Za as _e,a as h,ac as x,b as ee,bc as z,cc as v,d as te,fa as f,fb as Te,fc as He,ga as j,gb as H,ha as l,hb as ke,ib as Ae,lb as Ie,ma as Re,nb as xe,oa as De,ob as Oe,qb as S,rb as I,sb as ie,tb as se,ub as ae,zb as Le}from"./chunk-4LTN246Z.js";var de=0;function st(){return de}function m(r,e){return(...t)=>{try{return de=e,r(...t)}finally{de=0}}}function at(r){return!r}function qe(r){return r}function p(r){return Array.isArray(r)}function R(r){return(typeof r=="object"||typeof r=="function")&&r!=null}var N=Symbol(),q=Symbol(),L=class{predicates;fns=[];constructor(e){this.predicates=e}push(e){this.fns.push(Qe(this.predicates,e))}mergeIn(e){let t=this.predicates?e.fns.map(n=>Qe(this.predicates,n)):e.fns;this.fns.push(...t)}},G=class extends L{get defaultValue(){return!1}compute(e){return this.fns.some(t=>{let n=t(e);return n&&n!==q})}},D=class r extends L{ignore;static ignoreNull(e){return new r(e,t=>t===null)}constructor(e,t){super(e),this.ignore=t}get defaultValue(){return[]}compute(e){return this.fns.reduce((t,n)=>{let i=n(e);return i===void 0||i===q?t:p(i)?[...t,...this.ignore?i.filter(s=>!this.ignore(s)):i]:this.ignore&&this.ignore(i)?t:[...t,i]},[])}},ue=class extends D{constructor(e){super(e,void 0)}},le=class extends L{key;get defaultValue(){return this.key.reducer.getInitial()}constructor(e,t){super(e),this.key=t}compute(e){if(this.fns.length===0)return this.key.reducer.getInitial();let t=this.key.reducer.getInitial();for(let n=0;n<this.fns.length;n++){let i=this.fns[n](e);i!==q&&(t=this.key.reducer.reduce(t,i))}return t}};function Qe(r,e){return r.length===0?e:t=>{for(let n of r){let i=t.stateOf(n.path),s=l(i.structure.pathKeys).length-n.depth;for(let a=0;a<s;a++)i=i.structure.parent;if(!n.fn(i.context))return q}return e(t)}}var C=class{predicates;hidden;disabledReasons;readonly;syncErrors;syncTreeErrors;asyncErrors;metadata=new Map;constructor(e){this.predicates=e,this.hidden=new G(e),this.disabledReasons=new ue(e),this.readonly=new G(e),this.syncErrors=D.ignoreNull(e),this.syncTreeErrors=D.ignoreNull(e),this.asyncErrors=D.ignoreNull(e)}hasMetadata(e){return this.metadata.has(e)}getMetadataKeys(){return this.metadata.keys()}getMetadata(e){return this.metadata.has(e)||this.metadata.set(e,new le(this.predicates,e)),this.metadata.get(e)}mergeIn(e){this.hidden.mergeIn(e.hidden),this.disabledReasons.mergeIn(e.disabledReasons),this.readonly.mergeIn(e.readonly),this.syncErrors.mergeIn(e.syncErrors),this.syncTreeErrors.mergeIn(e.syncTreeErrors),this.asyncErrors.mergeIn(e.asyncErrors);for(let t of e.getMetadataKeys()){let n=e.metadata.get(t);this.getMetadata(t).mergeIn(n)}}},U=class{depth;constructor(e){this.depth=e}build(){return new W(this,[],0)}},P=class r extends U{constructor(e){super(e)}current;all=[];addHiddenRule(e){this.getCurrent().addHiddenRule(e)}addDisabledReasonRule(e){this.getCurrent().addDisabledReasonRule(e)}addReadonlyRule(e){this.getCurrent().addReadonlyRule(e)}addSyncErrorRule(e){this.getCurrent().addSyncErrorRule(e)}addSyncTreeErrorRule(e){this.getCurrent().addSyncTreeErrorRule(e)}addAsyncErrorRule(e){this.getCurrent().addAsyncErrorRule(e)}addMetadataRule(e,t){this.getCurrent().addMetadataRule(e,t)}getChild(e){if(e===N){let t=this.getCurrent().children;t.size>(t.has(N)?1:0)&&(this.current=void 0)}return this.getCurrent().getChild(e)}hasLogic(e){return this===e?!0:this.all.some(({builder:t})=>t.hasLogic(e))}mergeIn(e,t){t?this.all.push({builder:e,predicate:{fn:m(t.fn,this.depth),path:t.path}}):this.all.push({builder:e}),this.current=void 0}getCurrent(){return this.current===void 0&&(this.current=new F(this.depth),this.all.push({builder:this.current})),this.current}static newRoot(){return new r(0)}},F=class extends U{logic=new C([]);children=new Map;constructor(e){super(e)}addHiddenRule(e){this.logic.hidden.push(m(e,this.depth))}addDisabledReasonRule(e){this.logic.disabledReasons.push(m(e,this.depth))}addReadonlyRule(e){this.logic.readonly.push(m(e,this.depth))}addSyncErrorRule(e){this.logic.syncErrors.push(m(e,this.depth))}addSyncTreeErrorRule(e){this.logic.syncTreeErrors.push(m(e,this.depth))}addAsyncErrorRule(e){this.logic.asyncErrors.push(m(e,this.depth))}addMetadataRule(e,t){this.logic.getMetadata(e).push(m(t,this.depth))}getChild(e){return this.children.has(e)||this.children.set(e,new P(this.depth+1)),this.children.get(e)}hasLogic(e){return this===e}},W=class r{builder;predicates;depth;logic;constructor(e,t,n){this.builder=e,this.predicates=t,this.depth=n,this.logic=e?ot(e,t,n):new C([])}getChild(e){let t=this.builder?et(this.builder,e):[];if(t.length===0)return new r(void 0,[],this.depth+1);if(t.length===1){let{builder:n,predicates:i}=t[0];return new r(n,[...this.predicates,...i.map(s=>he(s,this.depth))],this.depth+1)}else{let n=t.map(({builder:i,predicates:s})=>new r(i,[...this.predicates,...s.map(a=>he(a,this.depth))],this.depth+1));return new ce(n)}}hasLogic(e){return this.builder?.hasLogic(e)??!1}},ce=class r{all;logic;constructor(e){this.all=e,this.logic=new C([]);for(let t of e)this.logic.mergeIn(t.logic)}getChild(e){return new r(this.all.flatMap(t=>t.getChild(e)))}hasLogic(e){return this.all.some(t=>t.hasLogic(e))}};function et(r,e){if(r instanceof P)return r.all.flatMap(({builder:t,predicate:n})=>{let i=et(t,e);return n?i.map(({builder:s,predicates:a})=>({builder:s,predicates:[...a,n]})):i});if(r instanceof F)return[...e!==N&&r.children.has(N)?[{builder:r.getChild(N),predicates:[]}]:[],...r.children.has(e)?[{builder:r.getChild(e),predicates:[]}]:[]];throw new u(1909,!1)}function ot(r,e,t){let n=new C(e);if(r instanceof P){let i=r.all.map(({builder:s,predicate:a})=>new W(s,a?[...e,he(a,t)]:e,t));for(let s of i)n.mergeIn(s.logic)}else if(r instanceof F)n.mergeIn(r.logic);else throw new u(1909,!1);return n}function he(r,e){return ee(h({},r),{depth:e})}var tt=Symbol("PATH"),K=class r{keys;parent;keyInParent;root;children=new Map;fieldPathProxy=new Proxy(this,dt);logicBuilder;constructor(e,t,n,i){this.keys=e,this.parent=n,this.keyInParent=i,this.root=t??this,n||(this.logicBuilder=P.newRoot())}get builder(){return this.logicBuilder?this.logicBuilder:this.parent.builder.getChild(this.keyInParent)}getChild(e){return this.children.has(e)||this.children.set(e,new r([...this.keys,e],this.root,this,e)),this.children.get(e)}mergeIn(e,t){let n=e.compile();this.builder.mergeIn(n.builder,t)}static unwrapFieldPath(e){return e[tt]}static newRoot(){return new r([],void 0,void 0,void 0)}},dt={get(r,e){return e===tt?r:r.getChild(e).fieldPathProxy}},oe,O=new Map,X=class r{schemaFn;constructor(e){this.schemaFn=e}compile(){if(O.has(this))return O.get(this);let e=K.newRoot();O.set(this,e);let t=oe;try{oe=e,this.schemaFn(e.fieldPathProxy)}finally{oe=t}return e}static create(e){return e instanceof r?e:new r(e)}static rootCompile(e){try{return O.clear(),e===void 0?K.newRoot():e instanceof r?e.compile():new r(e).compile()}finally{O.clear()}}};function ut(r){return r instanceof X||typeof r=="function"}var y={list(){return{reduce:(r,e)=>e===void 0?r:[...r,e],getInitial:()=>[]}},min(){return{reduce:(r,e)=>r===void 0||e===void 0?r??e:Math.min(r,e),getInitial:()=>{}}},max(){return{reduce:(r,e)=>r===void 0||e===void 0?r??e:Math.max(r,e),getInitial:()=>{}}},or(){return{reduce:(r,e)=>r||e,getInitial:()=>!1}},and(){return{reduce:(r,e)=>r&&e,getInitial:()=>!0}},override:lt};function lt(r){return{reduce:(e,t)=>t,getInitial:()=>r?.()}}var Y=class{reducer;create;brand;constructor(e,t){this.reducer=e,this.create=t}};function w(r){return new Y(r??y.override())}var ct=w(y.or()),ht=w(y.max()),ft=w(y.min()),gt=w(y.max()),mt=w(y.min()),pt=w(y.list());function yt(r){return r.errors().length>0?"invalid":r.pending()?"unknown":"valid"}var fe=class{node;constructor(e){this.node=e}rawSyncTreeErrors=o(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.syncTreeErrors.compute(this.node.context),...this.node.structure.parent?.validationState.rawSyncTreeErrors()??[]]);syncErrors=o(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.syncErrors.compute(this.node.context),...this.syncTreeErrors(),...bt(this.node.submitState.serverErrors())]);syncValid=o(()=>this.shouldSkipValidation()?!0:this.node.structure.reduceChildren(this.syncErrors().length===0,(e,t)=>t&&e.validationState.syncValid(),at));syncTreeErrors=o(()=>this.rawSyncTreeErrors().filter(e=>e.fieldTree===this.node.fieldProxy));rawAsyncErrors=o(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.asyncErrors.compute(this.node.context),...this.node.structure.parent?.validationState.rawAsyncErrors()??[]]);asyncErrors=o(()=>this.shouldSkipValidation()?[]:this.rawAsyncErrors().filter(e=>e==="pending"||e.fieldTree===this.node.fieldProxy));errors=o(()=>[...this.syncErrors(),...this.asyncErrors().filter(e=>e!=="pending")]);errorSummary=o(()=>this.node.structure.reduceChildren(this.errors(),(e,t)=>[...t,...e.errorSummary()]));pending=o(()=>this.node.structure.reduceChildren(this.asyncErrors().includes("pending"),(e,t)=>t||e.validationState.asyncErrors().includes("pending")));status=o(()=>{if(this.shouldSkipValidation())return"valid";let e=yt(this);return this.node.structure.reduceChildren(e,(t,n)=>n==="invalid"||t.validationState.status()==="invalid"?"invalid":n==="unknown"||t.validationState.status()==="unknown"?"unknown":"valid",t=>t==="invalid")});valid=o(()=>this.status()==="valid");invalid=o(()=>this.status()==="invalid");shouldSkipValidation=o(()=>this.node.hidden()||this.node.disabled()||this.node.readonly())};function bt(r){return r===void 0?[]:p(r)?r:[r]}var Je=w(),ge=class{node;cache=new WeakMap;constructor(e){this.node=e}resolve(e){if(!this.cache.has(e)){let t=o(()=>{let n=K.unwrapFieldPath(e),i=this.node,s=st();for(;s>0||!i.structure.logic.hasLogic(n.root.builder);)if(s--,i=i.structure.parent,i===void 0)throw new u(1900,!1);for(let a of n.keys)if(i=i.structure.getChild(a),i===void 0)throw new u(1901,!1);return i.fieldProxy});this.cache.set(e,t)}return this.cache.get(e)()}get fieldTree(){return this.node.fieldProxy}get state(){return this.node}get value(){return this.node.structure.value}get key(){return this.node.structure.keyInParent}get pathKeys(){return this.node.structure.pathKeys}index=o(()=>{let e=this.key();if(!p(l(this.node.structure.parent.value)))throw new u(1906,!1);return Number(e)});fieldTreeOf=e=>this.resolve(e);stateOf=e=>this.resolve(e)();valueOf=e=>{let t=this.resolve(e)().value();if(t instanceof Ze)throw new u(1907,!1);return t}},me=class{node;metadata=new Map;constructor(e){this.node=e;for(let t of this.node.logicNode.logic.getMetadataKeys())if(t.create){let n=this.node.logicNode.logic.getMetadata(t),i=l(()=>re(this.node.structure.injector,()=>t.create(o(()=>n.compute(this.node.context)))));this.metadata.set(t,i)}}get(e){if(this.has(e)&&!this.metadata.has(e)){if(e.create)throw Error("Managed metadata cannot be created lazily");let t=this.node.logicNode.logic.getMetadata(e);this.metadata.set(e,o(()=>t.compute(this.node.context)))}return this.metadata.get(e)}has(e){return this.node.logicNode.logic.hasMetadata(e)}},vt={get(r,e,t){let n=r(),i=n.structure.getChild(e);if(i!==void 0)return i.fieldProxy;let s=l(n.value);if(p(s)){if(e==="length")return n.value().length;if(e===Symbol.iterator)return()=>(n.value(),Array.prototype[Symbol.iterator].apply(n.fieldProxy))}if(R(s)&&e===Symbol.iterator)return function*(){for(let a in t)yield[a,t[a]]}},getOwnPropertyDescriptor(r,e){let t=l(r().value),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&!n.configurable&&(n.configurable=!0),n},ownKeys(r){let e=l(r().value);return typeof e=="object"&&e!==null?Reflect.ownKeys(e):[]}};function Nt(r,e){let t=o(()=>r()[e()]);return t[te]=r[te],t.set=n=>{r.update(i=>wt(i,n,e()))},t.update=n=>{t.set(n(l(t)))},t.asReadonly=()=>t,t}function wt(r,e,t){if(p(r)){let n=[...r];return n[t]=e,n}else return ee(h({},r),{[t]:e})}var Z=class{logic;node;createChildNode;identitySymbol=Symbol();_injector=void 0;get injector(){return this._injector??=A.create({providers:[],parent:this.fieldManager.injector}),this._injector}constructor(e,t,n){this.logic=e,this.node=t,this.createChildNode=n}children(){let e=this.childrenMap();return e===void 0?[]:Array.from(e.byPropertyKey.values()).map(t=>l(t.reader))}getChild(e){let t=e.toString(),n=l(this.childrenMap)?.byPropertyKey.get(t)?.reader;return n||(n=this.createReader(t)),n()}reduceChildren(e,t,n){let i=this.childrenMap();if(!i)return e;let s=e;for(let a of i.byPropertyKey.values()){if(n?.(s))break;s=t(l(a.reader),s)}return s}destroy(){this.injector.destroy()}createKeyInParent(e,t,n){if(e.kind==="root")return nt;if(t===void 0){let i=n;return o(()=>{if(this.parent.structure.getChild(i)!==this.node)throw new u(1902,!1);return i})}else{let i=n;return o(()=>{let s=this.parent.structure.value();if(!p(s))throw new u(1903,!1);let a=s[i];if(R(a)&&a.hasOwnProperty(this.parent.structure.identitySymbol)&&a[this.parent.structure.identitySymbol]===t)return i;for(let d=0;d<s.length;d++){let c=s[d];if(R(c)&&c.hasOwnProperty(this.parent.structure.identitySymbol)&&c[this.parent.structure.identitySymbol]===t)return i=d.toString()}throw new u(1904,!1)})}}createChildrenMap(){return x({source:this.value,computation:(e,t)=>{if(!R(e))return;let n=t?.value??{byPropertyKey:new Map},i,s=p(e);n!==void 0&&(s?i=St(n,e,this.identitySymbol):i=Et(n,e));for(let a of Object.keys(e)){let d,c=e[a];if(c===void 0){n.byPropertyKey.has(a)&&(i??=h({},n),i.byPropertyKey.delete(a));continue}s&&R(c)&&!p(c)&&(d=c[this.identitySymbol]??=Symbol(""));let _;d&&(n.byTrackingKey?.has(d)||(i??=h({},n),i.byTrackingKey??=new Map,i.byTrackingKey.set(d,this.createChildNode(a,d,s))),_=(i??n).byTrackingKey.get(d));let J=n.byPropertyKey.get(a);J===void 0?(i??=h({},n),i.byPropertyKey.set(a,{reader:this.createReader(a),node:_??this.createChildNode(a,d,s)})):_&&_!==J.node&&(i??=h({},n),J.node=_)}return i??n}})}createReader(e){return o(()=>this.childrenMap()?.byPropertyKey.get(e)?.node)}},pe=class extends Z{fieldManager;value;get parent(){}get root(){return this.node}get pathKeys(){return Mt}get keyInParent(){return nt}childrenMap;constructor(e,t,n,i,s){super(t,e,s),this.fieldManager=n,this.value=i,this.childrenMap=this.createChildrenMap()}},ye=class extends Z{logic;parent;root;pathKeys;keyInParent;value;childrenMap;get fieldManager(){return this.root.structure.fieldManager}constructor(e,t,n,i,s,a){super(t,e,a),this.logic=t,this.parent=n,this.root=this.parent.structure.root,this.keyInParent=this.createKeyInParent({kind:"child",parent:n,pathNode:void 0,logic:t,initialKeyInParent:s,identityInParent:i,fieldAdapter:void 0},i,s),this.pathKeys=o(()=>[...n.structure.pathKeys(),this.keyInParent()]),this.value=Nt(this.parent.structure.value,this.keyInParent),this.childrenMap=this.createChildrenMap(),this.fieldManager.structures.add(this)}};var Mt=o(()=>[]),nt=o(()=>{throw new u(1905,!1)});function St(r,e,t){let n,i=new Set(r.byPropertyKey.keys()),s=new Set(r.byTrackingKey?.keys());for(let a=0;a<e.length;a++){let d=e[a];i.delete(a.toString()),R(d)&&d.hasOwnProperty(t)&&s.delete(d[t])}if(i.size>0){n??=h({},r);for(let a of i)n.byPropertyKey.delete(a)}if(s.size>0){n??=h({},r);for(let a of s)n.byTrackingKey?.delete(a)}return n}function Et(r,e){let t;for(let n of r.byPropertyKey.keys())e.hasOwnProperty(n)||(t??=h({},r),t.byPropertyKey.delete(n));return t}var be=class{node;selfSubmitting=f(!1);serverErrors;constructor(e){this.node=e,this.serverErrors=x({source:this.node.structure.value,computation:()=>[]})}submitting=o(()=>this.selfSubmitting()||(this.node.structure.parent?.submitting()??!1))},V=class{structure;validationState;metadataState;nodeState;submitState;fieldAdapter;_context=void 0;get context(){return this._context??=new ge(this)}fieldProxy=new Proxy(()=>this,vt);pathNode;constructor(e){this.pathNode=e.pathNode,this.fieldAdapter=e.fieldAdapter,this.structure=this.fieldAdapter.createStructure(this,e),this.validationState=this.fieldAdapter.createValidationState(this,e),this.nodeState=this.fieldAdapter.createNodeState(this,e),this.metadataState=new me(this),this.submitState=new be(this)}pendingSync=x({source:()=>this.value(),computation:(e,t)=>{t?.value?.abort()}});get logicNode(){return this.structure.logic}get value(){return this.structure.value}_controlValue=x(()=>this.value());get controlValue(){return this._controlValue.asReadonly()}get keyInParent(){return this.structure.keyInParent}get errors(){return this.validationState.errors}get errorSummary(){return this.validationState.errorSummary}get pending(){return this.validationState.pending}get valid(){return this.validationState.valid}get invalid(){return this.validationState.invalid}get dirty(){return this.nodeState.dirty}get touched(){return this.nodeState.touched}get disabled(){return this.nodeState.disabled}get disabledReasons(){return this.nodeState.disabledReasons}get hidden(){return this.nodeState.hidden}get readonly(){return this.nodeState.readonly}get fieldBindings(){return this.nodeState.fieldBindings}get submitting(){return this.submitState.submitting}get name(){return this.nodeState.name}get max(){return this.metadata(ft)}get maxLength(){return this.metadata(mt)}get min(){return this.metadata(ht)}get minLength(){return this.metadata(gt)}get pattern(){return this.metadata(pt)??Rt}get required(){return this.metadata(ct)??Dt}metadata(e){return this.metadataState.get(e)}hasMetadata(e){return this.metadataState.has(e)}markAsTouched(){this.nodeState.markAsTouched(),this.pendingSync()?.abort(),this.sync()}markAsDirty(){this.nodeState.markAsDirty()}reset(e){l(()=>this._reset(e))}_reset(e){e!==void 0&&this.value.set(e),this.nodeState.markAsUntouched(),this.nodeState.markAsPristine();for(let t of this.structure.children())t._reset()}setControlValue(e){this._controlValue.set(e),this.markAsDirty(),this.debounceSync()}sync(){this.value.set(this.controlValue())}async debounceSync(){this.pendingSync()?.abort();let e=this.nodeState.debouncer();if(e){let t=new AbortController,n=e(t.signal);if(n&&(this.pendingSync.set(t),await n,t.signal.aborted))return}this.sync()}static newRoot(e,t,n,i){return i.newRoot(e,t,n,i)}createStructure(e){return e.kind==="root"?new pe(this,e.logic,e.fieldManager,e.value,this.newChild.bind(this)):new ye(this,e.logic,e.parent,e.identityInParent,e.initialKeyInParent,this.newChild.bind(this))}newChild(e,t,n){let i,s;return n?(i=this.pathNode.getChild(N),s=this.structure.logic.getChild(N)):(i=this.pathNode.getChild(e),s=this.structure.logic.getChild(e)),this.fieldAdapter.newChild({kind:"child",parent:this,pathNode:i,logic:s,initialKeyInParent:e,identityInParent:t,fieldAdapter:this.fieldAdapter})}},Rt=o(()=>[]),Dt=o(()=>!1),ve=class{node;selfTouched=f(!1);selfDirty=f(!1);markAsTouched(){this.selfTouched.set(!0)}markAsDirty(){this.selfDirty.set(!0)}markAsPristine(){this.selfDirty.set(!1)}markAsUntouched(){this.selfTouched.set(!1)}fieldBindings=f([]);constructor(e){this.node=e}dirty=o(()=>{let e=this.selfDirty()&&!this.isNonInteractive();return this.node.structure.reduceChildren(e,(t,n)=>n||t.nodeState.dirty(),qe)});touched=o(()=>{let e=this.selfTouched()&&!this.isNonInteractive();return this.node.structure.reduceChildren(e,(t,n)=>n||t.nodeState.touched(),qe)});disabledReasons=o(()=>[...this.node.structure.parent?.nodeState.disabledReasons()??[],...this.node.logicNode.logic.disabledReasons.compute(this.node.context)]);disabled=o(()=>!!this.disabledReasons().length);readonly=o(()=>(this.node.structure.parent?.nodeState.readonly()||this.node.logicNode.logic.readonly.compute(this.node.context))??!1);hidden=o(()=>(this.node.structure.parent?.nodeState.hidden()||this.node.logicNode.logic.hidden.compute(this.node.context))??!1);name=o(()=>{let e=this.node.structure.parent;return e?`${e.name()}.${this.node.structure.keyInParent()}`:this.node.structure.fieldManager.rootName});debouncer=o(()=>{if(this.node.logicNode.logic.hasMetadata(Je)){let t=this.node.logicNode.logic.getMetadata(Je).compute(this.node.context);if(t)return n=>t(this.node.context,n)}return this.node.structure.parent?.nodeState.debouncer?.()});isNonInteractive=o(()=>this.hidden()||this.disabled()||this.readonly())},Ne=class{newRoot(e,t,n,i){return new V({kind:"root",fieldManager:e,value:t,pathNode:n,logic:n.builder.build(),fieldAdapter:i})}newChild(e){return new V(e)}createNodeState(e){return new ve(e)}createValidationState(e){return new fe(e)}createStructure(e,t){return e.createStructure(t)}},we=class{injector;rootName;constructor(e,t){this.injector=e,this.rootName=t??`${this.injector.get(De)}.form${Ct++}`}structures=new Set;createFieldManagementEffect(e){j(()=>{let t=new Set;this.markStructuresLive(e,t);for(let n of this.structures)t.has(n)||(this.structures.delete(n),l(()=>n.destroy()))},{injector:this.injector})}markStructuresLive(e,t){t.add(e);for(let n of e.children())this.markStructuresLive(n.structure,t)}},Ct=0;function Pt(r){let e,t,n;return r.length===3?[e,t,n]=r:r.length===2?ut(r[1])?[e,t]=r:[e,n]=r:[e]=r,[e,t,n]}function Me(...r){let[e,t,n]=Pt(r),i=n?.injector??g(A),s=re(i,()=>X.rootCompile(t)),a=new we(i,n?.name),d=n?.adapter??new Ne,c=V.newRoot(a,e,s,d);return a.createFieldManagementEffect(c.structure),c.fieldProxy}var _t=new ne("");var Se=class{field;constructor(e){this.field=e}control=this;get value(){return this.field().value()}get valid(){return this.field().valid()}get invalid(){return this.field().invalid()}get pending(){return this.field().pending()}get disabled(){return this.field().disabled()}get enabled(){return!this.field().disabled()}get errors(){let e=this.field().errors();if(e.length===0)return null;let t={};for(let n of e)t[n.kind]=n;return t}get pristine(){return!this.field().dirty()}get dirty(){return this.field().dirty()}get touched(){return this.field().touched()}get untouched(){return!this.field().touched()}get status(){if(this.field().disabled())return"DISABLED";if(this.field().valid())return"VALID";if(this.field().invalid())return"INVALID";if(this.field().pending())return"PENDING";throw new u(1910,!1)}valueAccessor=null;hasValidator(e){return e===Xe.required?this.field().required():!1}updateValueAndValidity(){}},Tt=new ne(""),kt={create:H,update:Ae},it=(()=>{class r{element=g(Re).nativeElement;injector=g(A);field=v.required();state=o(()=>this.field()());[Ce]=kt;config=g(_t,{optional:!0});classes=Object.entries(this.config?.classes??{}).map(([t,n])=>[t,o(()=>n(this))]);controlValueAccessors=g(We,{optional:!0,self:!0});interopNgControl;get \u0275interopControl(){return this.controlValueAccessors?.[0]??this.interopNgControl?.valueAccessor??void 0}getOrCreateNgControl(){return this.interopNgControl??=new Se(this.state)}\u0275register(){j(t=>{let n=this.state();n.nodeState.fieldBindings.update(i=>[...i,this]),t(()=>{n.nodeState.fieldBindings.update(i=>i.filter(s=>s!==this))})},{injector:this.injector})}static \u0275fac=function(n){return new(n||r)};static \u0275dir=Pe({type:r,selectors:[["","field",""]],inputs:{field:[1,"field"]},features:[$e([{provide:Tt,useExisting:r},{provide:Ye,useFactory:()=>g(r).getOrCreateNgControl()}])]})}return r})();function It(r,e){if(r&1){let t=Le();se(0,"input",2),Ve("blur",function(){T(t);let i=E();return k(i.touched.emit(!0))})("mouseleave",function(){T(t);let i=E();return k(i.api.leave())})("mouseenter",function(){let i=T(t).$index,s=E();return k(s.api.setHoveredRating(i+1))})("click",function(){let i=T(t).$index,s=E();return k(s.api.setRating(i+1))}),ae()}if(r&2){let t=e.$index,n=E();Fe("checked",t+1===n.state.visibleRating()),Te("aria-label",n.getAriaLabel(t))}}var Q=class r extends ze{constructor(){super(Ge(Be,{events:{onHover:t=>this.hover.emit(t),onLeave:t=>this.leave.emit(t),onRatingChange:t=>{this.value.set(t)}}}),{value:"rating"});this.maxRating=v(void 0,{transform:Ue});this.value=He(0);this.disabled=v(!1);this.ariaLabel=v();this.className=v();this.hover=z();this.leave=z();this.touched=z()}getAriaLabel(t){return`${this.state.ariaLabel()} star ${t+1}`}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=$({type:r,selectors:[["app-rating"]],inputs:{maxRating:[1,"maxRating"],value:[1,"value"],disabled:[1,"disabled"],ariaLabel:[1,"ariaLabel"],className:[1,"className"]},outputs:{value:"valueChange",hover:"hover",leave:"leave",touched:"touched"},features:[_e],decls:3,vars:2,consts:[[1,"rating"],["type","radio","name","rating-1",1,"mask","mask-star-2","bg-orange-400",3,"checked"],["type","radio","name","rating-1",1,"mask","mask-star-2","bg-orange-400",3,"blur","mouseleave","mouseenter","click","checked"]],template:function(n,i){n&1&&(se(0,"div",0),xe(1,It,1,2,"input",1,Ie),ae()),n&2&&(je(i.state.className()),M(),Oe(i.state.stars()))},encapsulation:2,changeDetection:0})}};var Ee=class r{constructor(){this.model=f({rating:3});this.form=Me(this.model);this.hovered=f(0);this.left=f(0)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=$({type:r,selectors:[["ng-component"]],decls:13,vars:5,consts:[[3,"hover","leave","field"],[1,"mt-2"],["id","defaultRating"],["id","defaultHovered"],["id","defaultLeft"]],template:function(t,n){t&1&&(S(0,"app-rating",0),Ke("hover",function(s){return n.hovered.set(s)})("leave",function(s){return n.left.set(s)}),I(),H(),S(1,"div",1),b(2," Current rate: "),S(3,"span",2),b(4),I(),ie(5,"br"),b(6," Hovered: "),S(7,"span",3),b(8),I(),ie(9,"br"),b(10," Left: "),S(11,"span",4),b(12),I()()),t&2&&(ke(n.form.rating),M(4),B(n.model().rating),M(4),B(n.hovered()),M(4),B(n.left()))},dependencies:[Q,it],encapsulation:2})}};export{Ee as default};
