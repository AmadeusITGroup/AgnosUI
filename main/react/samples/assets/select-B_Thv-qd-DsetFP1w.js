import{j as n}from"./App-XNADZBio.js";import{u as ue,S as U}from"./config-IDcthEqk.js";import{a as M,u as q}from"./directive-Kqp31pwt-B9mGN0Lt.js";import{c as de}from"./index-Bh3NuAq4.js";import{w as pe,c,g as me,M as ge,H as fe,a as he,v as z,s as ve,b as be,p as xe,D as we,f as L,d as $,t as $e,i as B}from"./directive-DCYlDznf-DygjZu6c.js";import{c as De,o as Ie,a as Ce,b as Fe}from"./floatingUI-DRjdSp9n.js";import{c as ye}from"./focustrack-kYlkIgWx.js";import{c as je}from"./navManager-BYkvikQO.js";const Ne={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:s=>s.querySelectorAll(".au-select-badge,input"),itemIdFn:s=>""+s,onOpenChange:L,onFilterTextChange:L,onSelectedChange:L,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:"",slotBadgeLabel:({itemContext:s})=>s.item,slotItem:({itemContext:s})=>s.item};function Se(s){const[{id$:a,open$:r,filterText$:g,items$:p,itemIdFn$:h,onOpenChange$:D,onFilterTextChange$:I,onSelectedChange$:C,allowedPlacements$:F,navSelector$:y,className$:j,badgeClassName$:v,ariaLabel$:N,menuClassName$:b,...P},G]=pe(Ne,s),{selected$:S}=P,k=c(()=>a()??me()),T=ge(g,I),{hasFocus$:J,directive:Q}=ye(),u=fe(D,[r,J],([e,t])=>e&&t),A=c(()=>{const e=new Map,t=h();for(const i of S()){const l=t(i);e.set(l,{item:i,id:t(i),selected:!0})}return e}),V=c(()=>[...A().values()]),f=function(){const e=he(0);return z(e,t=>{const{length:i}=x();t!=null&&(i?t<0?t=i-1:t>=i&&(t=0):t=void 0),e.set(t)})}(),E=c(()=>{const e=new Map;if(u()){const t=A(),i=h();for(const l of p()){const d=i(l);e.set(d,{item:l,id:d,selected:t.has(d)})}}return e}),x=c(()=>u()?[...E().values()]:[]),K=c(()=>{const e=x(),t=f();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:X,referenceDirective:Y},stores:{placement$:R}}=De({props:{computePositionOptions:z(c(()=>({middleware:[Ie(5),Ce({allowedPlacements:F()}),Fe()]})))}}),{directive:Z,refreshElements:ee,focusFirst:te,focusLast:se,focusLeft:O,focusRight:H}=je(),ie=c(()=>({keys:{Home:te,End:se,ArrowLeft:O,ArrowRight:H},selector:y()})),W=(e,t)=>{const i=e.target;ee(),o.api.unselect(t),i instanceof HTMLElement&&setTimeout(()=>{O({event:e,referenceElement:i})||H({event:e,referenceElement:i})}),e.preventDefault()},ae=$(()=>({attributes:{role:"combobox","aria-haspopup":"listbox","aria-expanded":c(()=>`${u()}`),"aria-controls":c(()=>`${k()}-menu`)}})),ne=$(e=>({attributes:{tabindex:-1,class:v},classNames:{"au-select-badge":!0},events:{keydown:t=>o.actions.onBadgeKeydown(t,e().item)}})),oe=$(()=>({attributes:{role:"listbox",id:c(()=>`${k()}-menu`),"data-popper-placement":R,class:b},events:{mousedown:e=>e.preventDefault()}})),re=$(e=>({attributes:{role:"option","aria-selected":c(()=>`${e().selected}`),style:"cursor: pointer"},classNames:{"au-select-item":!0,selected:c(()=>e().selected)},events:{click:()=>o.api.toggleItem(e().item)}})),o={...ve({id$:k,visibleItems$:x,highlighted$:K,open$:u,selectedContexts$:V,filterText$:T,placement$:R,className$:j,badgeClassName$:v,ariaLabel$:N,menuClassName$:b,...P}),patch:G,api:{clear(){S.set([])},select(e){o.api.toggleItem(e,!0)},unselect(e){o.api.toggleItem(e,!1)},toggleItem(e,t){const i=h(),l=i(e),w=A().has(l);t==null&&(t=!w),!(t&&!E().has(l)||!t&&!w)&&S.update(m=>{var _;if(m=[...m],t&&!w)m.push(e);else if(!t&&w){const ce=m.findIndex(le=>i(le)===l);m.splice(ce,1)}return(_=C())==null||_(m),m})},clearText(){},highlight(e){const t=x().findIndex(i=>i.item===e);f.set(t===-1?void 0:t)},highlightFirst(){f.set(0)},highlightPrevious(){f.update(e=>e!=null?e-1:-1)},highlightNext(){f.update(e=>e!=null?e+1:1/0)},highlightLast(){f.set(-1)},open:()=>o.api.toggle(!0),close:()=>o.api.toggle(!1),toggle(e){u.update(t=>e??!t)}},directives:{hasFocusDirective:Q,floatingDirective:X,referenceDirective:Y,inputContainerDirective:be(xe(Z,ie),ae),badgeAttributesDirective:ne,menuAttributesDirective:oe,itemAttributesDirective:re},actions:{onInput({target:e}){const t=e.value;we(()=>{u.set(t!=null&&t!==""),T.set(t)})},onRemoveBadgeClick(e,t){W(e,t)},onInputKeydown(e){const{ctrlKey:t,key:i}=e;let l=!0;switch(i){case"ArrowDown":{u()?t?o.api.highlightLast():o.api.highlightNext():(o.api.open(),o.api.highlightFirst());break}case"ArrowUp":t?o.api.highlightFirst():o.api.highlightPrevious();break;case"Enter":{const d=K();d&&o.api.toggleItem(d.item);break}case"Escape":u.set(!1);break;default:l=!1}l&&e.preventDefault()},onBadgeKeydown(e,t){let i=!1;switch(e.key){case"Backspace":case"Delete":{W(e,t),i=!0;break}}i&&e.preventDefault()}}};return o}const ke=Se;function Ae(s){return n.jsx(n.Fragment,{children:""+s.itemContext.item})}function Le(s){return n.jsx(n.Fragment,{children:""+s.itemContext.item})}function Me({itemContext:s,slotContext:a}){return n.jsx("div",{...q(a.widget.directives.badgeAttributesDirective,s),children:n.jsx(U,{slotContent:a.state.slotBadgeLabel,props:{...a,itemContext:s}})})}function Be({slotContext:s}){const a=[];for(const r of s.state.selectedContexts)a.push(n.jsx(Me,{itemContext:r,slotContext:s},r.id));return a.length?n.jsx(n.Fragment,{children:a}):null}function Pe({itemContext:s,slotContext:a}){const r=de("dropdown-item","position-relative",{"text-bg-primary":s===a.state.highlighted});return n.jsx("li",{className:r,...q(a.widget.directives.itemAttributesDirective,s),children:n.jsx(U,{slotContent:a.state.slotItem,props:{...a,itemContext:s}})})}function Te({slotContext:s}){const{directives:{hasFocusDirective:a,floatingDirective:r,menuAttributesDirective:g}}=s.widget;return n.jsx("ul",{...M([B,"dropdown-menu show"],a,r,g),children:s.state.visibleItems.map(p=>n.jsx(Pe,{slotContext:s,itemContext:p},p.id))})}const Ee={slotBadgeLabel:Ae,slotItem:Le};function qe(s){const[a,r]=ue(ke,s,"select",Ee),g={state:a,widget:$e(r)},{id:p,ariaLabel:h,visibleItems:D,filterText:I,open:C,className:F}=a,y=`${p}-menu`,{directives:{hasFocusDirective:j,referenceDirective:v,inputContainerDirective:N}}=r;return n.jsxs("div",{...M([B,`au-select dropdown border border-1 p-1 mb-3 d-block ${F}`],v),children:[n.jsxs("div",{...M([B,"d-flex align-items-center flex-wrap gap-1"],j,N),children:[n.jsx(Be,{slotContext:g}),n.jsx("input",{id:p,"aria-label":h,className:"au-select-input flex-grow-1 border-0",type:"text",value:I,"aria-autocomplete":"list",autoCorrect:"off",autoCapitalize:"none",autoComplete:"off",onInput:r.actions.onInput,onKeyDown:b=>r.actions.onInputKeydown(b.nativeEvent)})]}),C&&D.length>0&&n.jsx(Te,{slotContext:g,menuId:y})]})}export{qe as S};
