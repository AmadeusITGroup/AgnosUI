import{r as p,j as m}from"./index-BcYjlfja.js";import{w as P,s as R,m as U,n as X}from"./stores-CeiBlAbJ.js";import{c as Y}from"./baseTransitions-BYPTjzTt.js";import{c as Z}from"./collapse-BQC9zBIz-Ux_-Eq7M.js";import{c as $,w as _,n as f}from"./func-DR0n-ShK-BRtNsj1u.js";import{t as u,a as l,b as d}from"./writables-DoU_XYTX-Cc045fOB.js";import{r as ee,d as te,b as ie,u as E}from"./directive-RRHM0Y0Q.js";import{g as se}from"./dom-B9Oy3i4s-Hs1W5kAC.js";import{u as F,S as N}from"./config-CGWD5yQR.js";function ae(e,i,n){let r;return i.length==2?(n=n??i[0],r=i.find(s=>s!==n)):i.length>2&&(r=i[0]),r&&e.forEach(s=>{s.state$().itemId!==r&&s.state$().itemVisible&&s.patch({itemVisible:!1})}),e}function j(e,i){return e.find(n=>n.state$().itemId===i)}const t={closeOthers:!1,onShown:f,onHidden:f,className:"",itemId:"",itemDestroyOnHide:!0,itemDisabled:!1,itemVisible:!1,itemAnimated:!0,itemTransition:Z,itemHeadingTag:"",onItemShown:f,onItemHidden:f,onItemVisibleChange:f,slotItemStructure:void 0,slotItemBody:void 0,slotItemHeader:void 0,itemClass:"",itemHeaderClass:"",itemButtonClass:"",itemBodyContainerClass:"",itemBodyClass:""},W={itemId:t.itemId,itemDestroyOnHide:t.itemDestroyOnHide,itemDisabled:t.itemDisabled,itemVisible:t.itemVisible,itemAnimated:t.itemAnimated,itemTransition:t.itemTransition,onItemShown:t.onItemShown,onItemHidden:t.onItemHidden,onItemVisibleChange:t.onItemVisibleChange,slotItemStructure:t.slotItemStructure,slotItemBody:t.slotItemBody,slotItemHeader:t.slotItemHeader,itemClass:t.itemClass,itemHeaderClass:t.itemHeaderClass,itemButtonClass:t.itemButtonClass,itemBodyContainerClass:t.itemBodyContainerClass,itemBodyClass:t.itemBodyClass,itemHeadingTag:t.itemHeadingTag},x=Object.keys(W),oe={closeOthers:u,onShown:l,onHidden:l,itemId:d,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimated:u,itemTransition:l,onItemShown:l,onItemHidden:l,onItemVisibleChange:l,itemClass:d,itemHeaderClass:d,itemButtonClass:d,itemBodyContainerClass:d,itemBodyClass:d,itemHeadingTag:d},ne={itemId:d,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimated:u,itemTransition:l,onItemShown:l,onItemHidden:l,onItemVisibleChange:l,itemClass:d,itemHeaderClass:d,itemButtonClass:d,itemBodyContainerClass:d,itemBodyClass:d,itemHeadingTag:d};function re(e,i,n){const[{itemAnimated$:r,itemTransition$:s,itemDestroyOnHide$:c,onItemShown$:h,onItemHidden$:C,onItemVisibleChange$:B,itemVisible$:g,itemId$:S,itemDisabled$:y,...A},V]=P(W,n,ne),v=_(!1),w=$(()=>se()),b=$(()=>S()||w()),T=$(()=>c()===!1||!D.state$().hidden),D=Y({props:{transition:s,visible:g,onVisibleChange:B,animated:r,animatedOnInit:!1,initDone:v,onHidden:()=>{i()(b()),C()()},onShown:()=>{e()(b()),h()()}}});return{...R({itemVisible$:g,itemId$:b,shouldBeInDOM$:T,itemDisabled$:y,...A}),patch:V,actions:{click:()=>{y()||g.update(H=>!H)}},api:{initDone:()=>{v.set(!0)},collapse:()=>{g.set(!1)},expand:()=>{g.set(!0)},toggle:()=>{g.update(H=>!H)}},directives:{collapseDirective:ie(D.directives.directive),accordionItemDirective:f}}}function de(e){const[{closeOthers$:i,onShown$:n,onHidden$:r,itemId$:s,itemAnimated$:c,itemClass$:h,itemDisabled$:C,itemVisible$:B,itemTransition$:g,itemDestroyOnHide$:S,itemBodyClass$:y,itemButtonClass$:A,itemBodyContainerClass$:V,itemHeaderClass$:v,itemHeadingTag$:w,onItemVisibleChange$:b,onItemHidden$:T,onItemShown$:D,slotItemStructure$:H,slotItemBody$:z,slotItemHeader$:q,...G},J]=P(t,e,oe),K={itemId:s,itemClass:h,itemAnimated:c,itemDisabled:C,itemVisible:B,itemTransition:g,itemDestroyOnHide:S,itemBodyClass:y,itemButtonClass:A,itemBodyContainerClass:V,itemHeaderClass:v,itemHeadingTag:w,onItemVisibleChange:b,onItemHidden:T,onItemShown:D,slotItemStructure:H,slotItemBody:z,slotItemHeader:q},I=ee(),O=$(()=>{const a=[];return I().forEach(o=>{o.state$().itemVisible&&a.push(o.state$().itemId)}),a}),k=_(O()[0]),L=$(()=>{i()&&(ae(I(),O(),k()),k.set(O()[0]))}),Q=$(()=>{L()});return{...R({itemsWidget$:I,...G}),patch:J,actions:{},api:{expand:a=>{var o;(o=j(I(),a))==null||o.api.expand()},collapse:a=>{var o;(o=j(I(),a))==null||o.api.collapse()},toggle:a=>{var o;(o=j(I(),a))==null||o.api.toggle()},expandAll:()=>{I().forEach(a=>a.api.expand())},collapseAll:()=>{I().forEach(a=>a.api.collapse())},registerItem:a=>{const o=re(n,r,{config:U(x,X(x,a==null?void 0:a.config),K),props:a==null?void 0:a.props});return o.directives.accordionItemDirective=()=>({destroy:I.register(o)}),o}},directives:{accordionDirective:te(Q)}}}const me=de,M=p.createContext({}),ce=e=>{const i=E(e.widget.directives.collapseDirective),r=new RegExp("^h[1-6]$").test(e.state.itemHeadingTag)?e.state.itemHeadingTag:"h2";return m.jsxs(m.Fragment,{children:[m.jsx(r,{className:`accordion-header ${e.state.itemHeaderClass}`,children:m.jsx("button",{type:"button",id:`${e.state.itemId}-toggle`,onClick:e.widget.actions.click,className:`accordion-button ${e.state.itemButtonClass} ${e.state.itemVisible?"":"collapsed"}`,disabled:e.state.itemDisabled,"aria-controls":`${e.state.itemId}-collapse`,"aria-disabled":e.state.itemDisabled,"aria-expanded":e.state.itemVisible,children:m.jsx(N,{slotContent:e.state.slotItemHeader,props:e})})}),e.state.shouldBeInDOM?m.jsx("div",{className:`accordion-collapse ${e.state.itemBodyContainerClass}`,id:`${e.state.itemId}-collapse`,"aria-labelledby":`${e.state.itemId}-toggle`,ref:i,children:m.jsx("div",{className:`accordion-body ${e.state.itemBodyClass}`,children:m.jsx(N,{slotContent:e.state.slotItemBody,props:e})})}):null]})},le={slotItemStructure:ce},He=p.forwardRef(function(i,n){const{registerItem:r}=p.useContext(M),[s,c]=F(r,i,null,{...le}),h={state:s,widget:c},C=E(c.directives.accordionItemDirective);return p.useImperativeHandle(n,()=>c.api,[]),p.useEffect(()=>{c.api.initDone()},[]),m.jsx("div",{className:`accordion-item ${s.itemClass}`,id:s.itemId,ref:C,children:m.jsx(N,{slotContent:s.slotItemStructure,props:h})})}),ye=p.forwardRef(function(i,n){const[r,s]=F(me,i,"accordion");p.useImperativeHandle(n,()=>s.api,[]);const c=E(s.directives.accordionDirective);return m.jsx(M.Provider,{value:s.api,children:m.jsx("div",{className:`accordion ${r.className}`,ref:c,children:i.children})})});export{ye as A,He as a};
