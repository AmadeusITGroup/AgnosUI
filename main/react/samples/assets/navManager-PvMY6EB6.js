import{w as S,c as N}from"./func-B0ufEirG.js";import{r as k}from"./directive-0FrlA-7l.js";import{c as C}from"./dom-2S7XI5EU.js";const D=t=>{let s=t;for(;s;){const o=getComputedStyle(s);if(s.inert||s.hidden||o.display==="none"||o.visibility==="hidden")return!0;s=s.parentElement}return!1},d=t=>{var o;if(t.disabled)return!1;const s=(o=t.parentElement)==null?void 0:o.closest("fieldset");return s?d(s):!0},L=t=>t.isContentEditable||!!t.hasAttribute("tabindex"),$={INPUT:t=>t.type!=="hidden"&&d(t),SELECT:d,TEXTAREA:d,BUTTON:d,A:t=>!!t.href||L(t)},P=t=>!D(t)&&($[t.tagName]??L)(t),x=(t,s)=>{if(t===s)return 0;const o=t.compareDocumentPosition(s);if(o&Node.DOCUMENT_POSITION_FOLLOWING)return-1;if(o&Node.DOCUMENT_POSITION_PRECEDING)return 1;throw new Error("failed to compare elements")},E=t=>getComputedStyle(t).direction,K=new Set(["text","search","url","tel","password"]),R=t=>t instanceof HTMLInputElement&&K.has(t.type),M=t=>{let s=t.key;return t.shiftKey&&(s=`Shift+${s}`),t.altKey&&(s=`Alt+${s}`),t.ctrlKey&&(s=`Ctrl+${s}`),t.metaKey&&(s=`Meta+${s}`),s},U=t=>{const{target:s,key:o}=t;if(R(s)&&(o==="ArrowLeft"||o==="ArrowRight"||o==="Home"||o==="End")){let i;if(o==="ArrowLeft"||o==="ArrowRight"){const u=E(s);i=o===(u==="ltr"?"ArrowLeft":"ArrowRight")}else i=o==="Home";const h=s.selectionStart===s.selectionEnd?s.selectionStart:null;if(i&&h!==0||!i&&h!==s.value.length)return!0}return!1},_=t=>[t],z=()=>{const t=k(),s=S({}),o=()=>s.set({}),i=N(()=>{s();const e=[];for(const r of t())e.push(...r());return e}),h=N(()=>C(i()),{equal:Object.is}),u=N(()=>[...i()].sort(x)),l=()=>{const e=h();return e?E(e):"ltr"},m=(e,r)=>(e&&(r==null||r.preventDefault()),e),p=(e,r=0)=>{const c=u();for(;e>=0&&e<c.length;){const n=c[e];if(P(n)){if(n.focus(),r!=0&&R(n)){const a=l()!==E(n),f=r>0!==a?0:n.value.length;n.setSelectionRange(f,f,f===0?"forward":"backward")}return n}if(r===0)break;e+=r}return null},T=e=>({event:r,referenceElement:c=(r==null?void 0:r.target)??document.activeElement}={})=>{const n=c?u().indexOf(c):-1;return n>-1?m(p(n+e,e),r):null},F=(e,r)=>{const c=a=>{var O;if(U(a))return;const f=M(a),A=(O=r.keys)==null?void 0:O[f];A&&(o(),A({event:a,directiveElement:e,navManager:b}))};e.addEventListener("keydown",c);const n=t.register(()=>((r==null?void 0:r.selector)??_)(e));return{update(a){r=a},destroy(){e.removeEventListener("keydown",c),n()}}},y=T(-1),g=T(1),w=({event:e}={})=>m(p(0,1),e),I=({event:e}={})=>m(p(u().length-1,-1),e),b={elementsInDomOrder$:u,directive:F,focusIndex:p,focusPrevious:y,focusNext:g,focusFirst:w,focusFirstLeft:(...e)=>(l()==="rtl"?I:w)(...e),focusFirstRight:(...e)=>(l()==="rtl"?w:I)(...e),focusLast:I,focusLeft:(...e)=>(l()==="rtl"?g:y)(...e),focusRight:(...e)=>(l()==="rtl"?y:g)(...e),refreshElements:o};return b};export{z as c};
