import{h as F,w as S,b as N,A as k,e as D}from"./dom-CzJpOnsw-BpVpkhUo.js";const x=t=>{let s=t;for(;s;){const r=getComputedStyle(s);if(s.inert||s.hidden||r.display==="none"||r.visibility==="hidden")return!0;s=s.parentElement}return!1},h=t=>{if(t.disabled)return!1;const s=t.parentElement?.closest("fieldset");return s?h(s):!0},O=t=>t.isContentEditable||!!t.hasAttribute("tabindex"),C={INPUT:t=>t.type!=="hidden"&&h(t),SELECT:h,TEXTAREA:h,BUTTON:h,A:t=>!!t.href||O(t)},$=t=>document.contains(t)&&!x(t)&&(C[t.tagName]??O)(t),P=(t,s)=>{if(t===s)return 0;const r=t.compareDocumentPosition(s);if(r&Node.DOCUMENT_POSITION_FOLLOWING)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING)return 1;throw new Error("failed to compare elements")},b=t=>getComputedStyle(t).direction,K=new Set(["text","search","url","tel","password"]),L=t=>t instanceof HTMLInputElement&&K.has(t.type),M=t=>{let s=t.key;return t.shiftKey&&(s=`Shift+${s}`),t.altKey&&(s=`Alt+${s}`),t.ctrlKey&&(s=`Ctrl+${s}`),t.metaKey&&(s=`Meta+${s}`),s},U=t=>{const{target:s,key:r}=t;if(L(s)&&(r==="ArrowLeft"||r==="ArrowRight"||r==="Home"||r==="End")){let i;if(r==="ArrowLeft"||r==="ArrowRight"){const a=b(s);i=r===(a==="ltr"?"ArrowLeft":"ArrowRight")}else i=r==="Home";const l=s.selectionStart===s.selectionEnd?s.selectionStart:null;if(i&&l!==0||!i&&l!==s.value.length)return!0}return!1},_=t=>[t],q=()=>{const t=F(),s=S({}),r=(e=!0)=>{s.set({}),e&&(l(),a())},i=N(()=>{s();const e=[];for(const o of t())e.push(...o());return e}),l=N(()=>k(i()),{equal:Object.is}),a=N(()=>[...i()].sort(P)),f=()=>{const e=l();return e?b(e):"ltr"},p=(e,o)=>(e&&o?.preventDefault(),e),g=(e,o=0)=>{const c=a();for(;e>=0&&e<c.length;){const n=c[e];if($(n)){if(n.focus(),o!=0&&L(n)){const u=f()!==b(n),d=o>0!==u?0:n.value.length;n.setSelectionRange(d,d,d===0?"forward":"backward")}return n}if(o===0)break;e+=o}return null},A=e=>({event:o,referenceElement:c=o?.target??document.activeElement}={})=>{const n=c?a().indexOf(c):-1;return n>-1?p(g(n+e,e),o):null},R=D((e,o)=>{const c=u=>{if(U(u))return;const d=M(u),T=o.keys?.[d];T&&(r(!1),T({event:u,directiveElement:e,navManager:E,context:o.context}))};e.addEventListener("keydown",c);const n=t.register(()=>(o?.selector??_)(e));return{update(u){o=u},destroy(){e.removeEventListener("keydown",c),n()}}}),y=A(-1),m=A(1),w=({event:e}={})=>p(g(0,1),e),I=({event:e}={})=>p(g(a().length-1,-1),e),E={elementsInDomOrder$:a,directive:R,focusIndex:g,focusPrevious:y,focusNext:m,focusFirst:w,focusFirstLeft:(...e)=>(f()==="rtl"?I:w)(...e),focusFirstRight:(...e)=>(f()==="rtl"?w:I)(...e),focusLast:I,focusLeft:(...e)=>(f()==="rtl"?m:y)(...e),focusRight:(...e)=>(f()==="rtl"?y:m)(...e),refreshElements:r};return E};export{q as c};
