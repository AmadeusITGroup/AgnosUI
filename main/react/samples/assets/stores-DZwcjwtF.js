import{a as k,c as l,g as p,b as g,d as b,e as O,r as m,w as h,i as S,f as D}from"./func-DR0n-ShK-BRtNsj1u.js";const P=t=>({actions:t.actions,api:t.api,directives:t.directives,state$:t.state$,stores:t.stores}),y=Symbol();function W(t){return function(s){g(()=>{var r;for(const[o,e]of Object.entries(s??{}))(r=t[`${o}$`])==null||r.set(e)})}}function A(t,s){if(t===s)return null;let r=!1;const o={},e=new Set([...Object.keys(t),...Object.keys(s)]);for(const n of e){const a=s[n];t[n]!==a&&(o[n]=a,r=!0)}return r?o:null}function $(t,s=m(void 0),r={},o=h(void 0)){const{normalizeValue:e=S,equal:n=Object.is}=r,a=()=>t,c=(i,u=a)=>{const f=i===void 0?void 0:e(i);return f===y?(console.error("Not using invalid value",i),u()):f===void 0?u():f},d=l(()=>c(s()),{equal:n}),V=l(()=>c(o(),d),{equal:n});return b(V,i=>{if(i!==void 0){const u=e(i);if(u===y){console.error("Not setting invalid value",i);return}i=u}o.set(i)})}const v=t=>!!(t&&typeof t=="function"&&"subscribe"in t),z=t=>v(t)?t:m(t),N=t=>v(t)?t:h(t),q=(t,s)=>{const r={};if(s){const o=v(s);for(const e of t)r[e]=o?l(()=>s()[e]):z(s[e])}return r},j=(t,s,r)=>{const o={};for(const e of t){const n=s==null?void 0:s[e],a=r==null?void 0:r[e];o[e]=n&&a?l(()=>n()??a()):n||a}return o},w=(t,s,r)=>{const o={},e=Object.keys(t),n=q(e,s==null?void 0:s.config),a=s==null?void 0:s.props;for(const c of e){const d=a==null?void 0:a[c];o[`${c}$`]=$(t[c],n[c],r==null?void 0:r[c],N(d))}return o},E=(t,s,r)=>{const o=w(t,s,r);return[o,W(o)]},L=t=>{const s=[],r=[],o={};for(const e of Object.keys(t))if(e.endsWith("$")){const n=t[e];s.push(e.substring(0,e.length-1)),r.push(n),o[e]=k(n)}return{stores:o,state$:l(()=>{const e=r.map(p),n={};return s.forEach((a,c)=>{n[a]=e[c]}),n})}},R=(t,s,r=e=>e[0],o=(e,n)=>n===e)=>{let e=s[0]();return b(O(s,{derive(n){const a=r(n),c=!o(n[0],a);return c&&s[0].set(a),(c||!o(e,a))&&(e=a,t()(a)),a},equal:o}),s[0].set.bind(s[0]))},U=(t,s,r=S,o=D)=>b(l(()=>r(t()),{equal:o}),e=>{const n=r(e);o(t(),n)||(t.set(n),s()(n))});export{y as I,U as a,R as b,w as c,A as f,j as m,q as n,L as s,P as t,E as w};
