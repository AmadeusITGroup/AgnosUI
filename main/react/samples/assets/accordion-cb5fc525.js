import{r as $,j as d}from"./index-a1897422.js";import{w as k,s as P,m as U,n as X,b as Y}from"./stores-ae26ce61.js";import{c as Z}from"./baseTransitions-334ad8bd.js";import{c as ee}from"./collapse-f47ea866.js";import{c as v,w as R,n as g,r as te}from"./func-f2d0b1ef.js";import{t as u,a as I,b as m}from"./writables-3ebf213a.js";import{r as ie,d as se,b as ae,u as E}from"./directive-b30080a6.js";import{S as j}from"./slot-50fa40d8.js";import{u as F}from"./config-b1c82cd5.js";let ne=0;function oe(){return`accordion-item-${ne++}`}function re(e,s,o){let r;return s.length==2?(o=o??s[0],r=s.find(a=>a!==o)):s.length>2&&(r=s[0]),r&&e.forEach(a=>{a.state$().itemId!==r&&a.state$().itemVisible&&a.patch({itemVisible:!1})}),e}function S(e,s){return e.find(o=>o.state$().itemId===s)}const i={closeOthers:!1,onShown:g,onHidden:g,className:"",itemId:"",itemDestroyOnHide:!0,itemDisabled:!1,itemVisible:!1,itemAnimation:!0,itemTransition:ee,itemHeadingTag:"",onItemShown:g,onItemHidden:g,onItemVisibleChange:g,slotItemStructure:void 0,slotItemBody:void 0,slotItemHeader:void 0,itemClass:"",itemHeaderClass:"",itemButtonClass:"",itemCollapseClass:"",itemBodyClass:""},W={itemId:i.itemId,itemDestroyOnHide:i.itemDestroyOnHide,itemDisabled:i.itemDisabled,itemVisible:i.itemVisible,itemAnimation:i.itemAnimation,itemTransition:i.itemTransition,onItemShown:i.onItemShown,onItemHidden:i.onItemHidden,onItemVisibleChange:i.onItemVisibleChange,slotItemStructure:i.slotItemStructure,slotItemBody:i.slotItemBody,slotItemHeader:i.slotItemHeader,itemClass:i.itemClass,itemHeaderClass:i.itemHeaderClass,itemButtonClass:i.itemButtonClass,itemCollapseClass:i.itemCollapseClass,itemBodyClass:i.itemBodyClass,itemHeadingTag:i.itemHeadingTag},x=Object.keys(W),me={closeOthers:u,onShown:I,onHidden:I,itemId:m,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimation:u,itemTransition:I,onItemShown:I,onItemHidden:I,onItemVisibleChange:I,itemClass:m,itemHeaderClass:m,itemButtonClass:m,itemCollapseClass:m,itemBodyClass:m,itemHeadingTag:m},de={itemId:m,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimation:u,itemTransition:I,onItemShown:I,onItemHidden:I,onItemVisibleChange:I,itemClass:m,itemHeaderClass:m,itemButtonClass:m,itemCollapseClass:m,itemBodyClass:m,itemHeadingTag:m};function le(e,s,o){const[{itemAnimation$:r,itemTransition$:a,itemDestroyOnHide$:l,onItemShown$:b,onItemHidden$:h,onItemVisibleChange$:A,itemVisible$:p,itemId$:V,itemDisabled$:C,...B},w]=k(W,o,de),D=R(!1),H=Y(te(g),[V],([f])=>f||oe()),T=v(()=>l()===!1||!y.state$().hidden),y=Z({props:{transition:a,visible:p,onVisibleChange:A,animation:r,animationOnInit:!1,initDone:D,onHidden:()=>{s()(H()),h()()},onShown:()=>{e()(H()),b()()}}});return{...P({itemVisible$:p,itemId$:H,shouldBeInDOM$:T,itemDisabled$:C,...B}),patch:w,actions:{click:()=>{C()||p.update(f=>!f)}},api:{initDone:()=>{D.set(!0)},collapse:()=>{p.set(!1)},expand:()=>{p.set(!0)},toggle:()=>{p.update(f=>!f)}},directives:{collapseDirective:ae(y.directives.directive),accordionItemDirective:g}}}function ce(e){const[{closeOthers$:s,onShown$:o,onHidden$:r,itemId$:a,itemAnimation$:l,itemClass$:b,itemDisabled$:h,itemVisible$:A,itemTransition$:p,itemDestroyOnHide$:V,itemBodyClass$:C,itemButtonClass$:B,itemCollapseClass$:w,itemHeaderClass$:D,itemHeadingTag$:H,onItemVisibleChange$:T,onItemHidden$:y,onItemShown$:f,slotItemStructure$:z,slotItemBody$:_,slotItemHeader$:q,...G},J]=k(i,e,me),K={itemId:a,itemClass:b,itemAnimation:l,itemDisabled:h,itemVisible:A,itemTransition:p,itemDestroyOnHide:V,itemBodyClass:C,itemButtonClass:B,itemCollapseClass:w,itemHeaderClass:D,itemHeadingTag:H,onItemVisibleChange:T,onItemHidden:y,onItemShown:f,slotItemStructure:z,slotItemBody:_,slotItemHeader:q},c=ie(),O=v(()=>{const t=[];return c().forEach(n=>{n.state$().itemVisible&&t.push(n.state$().itemId)}),t}),N=R(O()[0]),L=v(()=>{s()&&(re(c(),O(),N()),N.set(O()[0]))}),Q=v(()=>{L()});return{...P({itemsWidget$:c,...G}),patch:J,actions:{},api:{isExpanded:t=>{const n=S(c(),t);return n?n.state$().itemVisible:!1},expand:t=>{var n;(n=S(c(),t))==null||n.api.expand()},collapse:t=>{var n;(n=S(c(),t))==null||n.api.collapse()},toggle:t=>{var n;(n=S(c(),t))==null||n.api.toggle()},expandAll:()=>{c().forEach(t=>t.api.expand())},collapseAll:()=>{c().forEach(t=>t.api.collapse())},registerItem:t=>{const n=le(o,r,{config:U(x,X(x,t==null?void 0:t.config),K),props:t==null?void 0:t.props});return n.directives.accordionItemDirective=()=>({destroy:c.register(n)}),n}},directives:{accordionDirective:se(Q)}}}const Ie=ce,M=$.createContext({}),ue=e=>{const s=E(e.widget.directives.collapseDirective),r=new RegExp("^h[1-6]$").test(e.state.itemHeadingTag)?e.state.itemHeadingTag:"h2";return d.jsxs(d.Fragment,{children:[d.jsx(r,{className:`accordion-header ${e.state.itemHeaderClass}`,children:d.jsx("button",{type:"button",id:`${e.state.itemId}-toggle`,onClick:e.widget.actions.click,className:`accordion-button ${e.state.itemButtonClass} ${e.state.itemVisible?"":"collapsed"}`,disabled:e.state.itemDisabled,"aria-controls":`${e.state.itemId}-collapse`,"aria-disabled":e.state.itemDisabled,"aria-expanded":e.state.itemVisible,children:d.jsx(j,{slotContent:e.state.slotItemHeader,props:e})})}),e.state.shouldBeInDOM?d.jsx("div",{className:`accordion-collapse ${e.state.itemCollapseClass}`,id:`${e.state.itemId}-collapse`,"aria-labelledby":`${e.state.itemId}-toggle`,ref:s,children:d.jsx("div",{className:`accordion-body ${e.state.itemBodyClass}`,children:d.jsx(j,{slotContent:e.state.slotItemBody,props:e})})}):null]})},pe={slotItemStructure:ue},Se=$.forwardRef(function(s,o){const{registerItem:r}=$.useContext(M),[a,l]=F(r,s,null,{...pe}),b={state:a,widget:l},h=E(l.directives.accordionItemDirective);return $.useImperativeHandle(o,()=>l.api,[]),$.useEffect(()=>{l.api.initDone()},[]),d.jsx("div",{className:`accordion-item ${a.itemClass}`,id:a.itemId,ref:h,children:d.jsx(j,{slotContent:a.slotItemStructure,props:b})})}),ve=$.forwardRef(function(s,o){const[r,a]=F(Ie,s,"accordion");$.useImperativeHandle(o,()=>a.api,[]);const l=E(a.directives.accordionDirective);return d.jsx(M.Provider,{value:a.api,children:d.jsx("div",{className:`accordion ${r.className}`,ref:l,children:s.children})})});export{ve as A,Se as a};
