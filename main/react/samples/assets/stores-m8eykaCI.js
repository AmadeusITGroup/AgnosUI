import{a as v,c as u,g as O,b as D,d as b,e as W,r as h,w as S,i as V,f as $}from"./func-BRtNsj1u.js";const E=e=>({actions:e.actions,api:e.api,directives:e.directives,state$:e.state$,stores:e.stores}),m=Symbol();function z(e){return function(t){D(()=>{var n;for(const[r,s]of Object.entries(t??{}))(n=e[`${r}$`])==null||n.set(s)})}}function L(e,t){if(e===t)return null;let n=!1;const r={},s=new Set([...Object.keys(e),...Object.keys(t)]);for(const a of s){const o=t[a];e[a]!==o&&(r[a]=o,n=!0)}return n?r:null}function N(e,t=h(void 0),n={},r=S(void 0)){const{normalizeValue:s=V,equal:a=Object.is}=n,o=()=>e,c=(i,l=o)=>{const f=i===void 0?void 0:s(i);return f===m?(console.error("Not using invalid value",i),l()):f===void 0?l():f},d=u(()=>c(t()),{equal:a}),k=u(()=>c(r(),d),{equal:a});return b(k,i=>{if(i!==void 0){const l=s(i);if(l===m){console.error("Not setting invalid value",i);return}i=l}r.set(i)})}const y=e=>!!(e&&typeof e=="function"&&"subscribe"in e),w=e=>y(e)?e:h(e),I=e=>y(e)?e:S(e),P=(e,t)=>{const n={};if(t){const r=y(t);for(const s of e)n[s]=r?u(()=>t()[s]):w(t[s])}return n},R=(e,t,n)=>{const r={};for(const s of e){const a=t==null?void 0:t[s],o=n==null?void 0:n[s];r[s]=a&&o?u(()=>a()??o()):a||o}return r},A=(e,t,n)=>{const r={},s=Object.keys(e),a=P(s,t==null?void 0:t.config),o=t==null?void 0:t.props;for(const c of s){const d=o==null?void 0:o[c];r[`${c}$`]=N(e[c],a[c],n==null?void 0:n[c],I(d))}return r},U=(e,t,n)=>{const r=A(e,t,n);return[r,z(r)]},F=e=>{const t=[],n=[],r={};for(const s of Object.keys(e))if(s.endsWith("$")){const a=e[s];t.push(s.substring(0,s.length-1)),n.push(a),r[s]=v(a)}return{stores:r,state$:u(()=>{const s=n.map(O),a={};return t.forEach((o,c)=>{a[o]=s[c]}),a})}},_=(e,t,n=s=>s[0],r=(s,a)=>a===s)=>{let s=t[0]();return b(W(t,{derive(a){const o=n(a),c=!r(a[0],o);return c&&t[0].set(o),(c||!r(s,o))&&(s=o,e()(o)),o},equal:r}),t[0].set.bind(t[0]))},q=(e,t,n=V,r=$)=>b(u(()=>n(e()),{equal:r}),s=>{const a=n(s);r(e(),a)||(e.set(a),t()(a))});export{m as I,q as a,_ as b,A as c,L as f,R as m,P as n,F as s,E as t,U as w};
