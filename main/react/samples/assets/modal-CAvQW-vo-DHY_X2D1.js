import{b as o,g as v,r as $,k as U,a as f,m as T,l as X,E as Y,n as i,f as Z}from"./dom-Bcg9ORcA-M5rAttAR.js";import{c as a,b as n,t as k,e as _}from"./writables-e0tyaQpe-cVeRZSkA.js";import{w as ee,s as te}from"./stores-D2Z0mQG4.js";import{c as O}from"./baseTransitions-BtTWYQfd.js";import{d as oe}from"./promise-Y53vc4Ia-Bsa-6Y_7.js";import{p as A,f as se,a as ie,r as ne,s as ae}from"./focusElement-BfCJk8CA.js";import{c as re}from"./widget-D4NOSiJx.js";const ce=Symbol(),le=Symbol(),de=Symbol(),be={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:i,closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:i,onBeforeClose:i,onVisibleChange:i,onHidden:i,onShown:i,visible:!1},me={animated:a,ariaCloseButtonLabel:k,backdrop:a,backdropClass:k,backdropTransition:n,closeButton:a,closeOnOutsideClick:a,container:_,className:k,modalTransition:n,onBeforeClose:n,onVisibleChange:n,onHidden:n,onShown:n,visible:a},E=U(),pe=o(()=>E().length>0),ue=o(()=>{pe()?ie():ne()}),ve=o(()=>{ue()}),we=re("modal",H=>{const[{animated$:r,backdrop$:g,backdropTransition$:P,closeOnOutsideClick$:V,container$:p,modalTransition$:M,onBeforeClose$:N,onVisibleChange$:F,onHidden$:I,onShown$:L,ariaCloseButtonLabel$:C,className$:h,backdropClass$:y,visible$:w,...x},c]=ee(be,H,me),s=O({props:{transition:M,visible:w,animated:r,animatedOnInit:r,onVisibleChange:F,onHidden:I,onShown:L}}),u=s.stores.visible$,D=O({props:{transition:P,visible:w,animated:r,animatedOnInit:r}}),S=o(()=>s.stores.transitioning$()||g()&&D.stores.transitioning$()),l=o(()=>!S()&&!u()),q=o(()=>!g()||l());let d;const b=e=>{d=e;const t={get result(){return d},set result(m){d=m},cancel:!1};N()(t),!t.cancel&&c({visible:!1})},R=v(A,o(()=>({container:p()}))),W=v(A,o(()=>{const e=p(),t=e?s.stores.element$():void 0;return{container:e,insertBefore:t?.parentElement===e?t:void 0}})),j=$(void 0,()=>E.register(B)),z=o(()=>{s.stores.elementPresent$()&&!l()&&j(),ve()}),G=f(()=>({attributes:{type:$("button"),"aria-label":C},events:{click:()=>b(le)}})),J=f(()=>({attributes:{class:y}})),K=f(()=>({attributes:{class:h,tabIndex:$("-1")},events:{click:e=>{e.currentTarget===e.target&&V()&&b(ce)},keydown:e=>{const{key:t}=e;switch(t){case"Escape":b(de),e.stopPropagation();break}}}})),B={...te({backdropHidden$:q,container$:p,hidden$:l,transitioning$:S,visible$:u,modalElement$:s.stores.element$,ariaCloseButtonLabel$:C,className$:h,backdropClass$:y,...x}),directives:{modalPortalDirective:R,backdropPortalDirective:W,backdropDirective:T(D.directives.directive,J),modalDirective:T(s.directives.directive,Y(ae),X(z),K,se),closeButtonDirective:G,dialogDirective:v(Z((e,t)=>{const m=Q=>{Q?e.showModal():e.close()};return m(t),{update:m}}),u)},patch:c,api:{close:b,async open(){return c({visible:!0}),await oe(l).promise,d},patch:c}};return B});export{ce as a,le as b,we as c,de as m};
