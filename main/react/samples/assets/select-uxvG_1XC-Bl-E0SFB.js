import{j as n}from"./App-DI9ur9y5.js";import{S as G}from"./slot-Cdz7cIIo.js";import{a as A,u as M}from"./directive-DNXkB1Wc-C2TCiq2W.js";import{c as pe}from"./index-DYzswQoO.js";import{u as me}from"./config-DXsJDUvi.js";import{w as ge,f as r,q as fe,K as he,F as ve,e as be,g as U,s as xe,l as $e,N as De,n as y,o as h,B as we,t as Ce,c as P}from"./directive-CKEccryv-DE_yN9bX.js";import{c as Fe,o as Ie,a as je,b as Ne}from"./floatingUI-DqDACtmC.js";import{c as Se}from"./focustrack-BuVWCW5N.js";import{c as ke}from"./navManager-BSvgb3xz.js";import{e as Le}from"./extendWidget-DCTbm56T.js";const ye={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:s=>s.querySelectorAll(".au-select-badge,input"),itemIdFn:s=>""+s,onOpenChange:y,onFilterTextChange:y,onSelectedChange:y,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:""};function Ae(s){const[{id$:a,open$:c,filterText$:m,items$:g,itemIdFn$:v,onOpenChange$:C,onFilterTextChange$:F,onSelectedChange$:I,allowedPlacements$:j,navSelector$:N,className$:S,badgeClassName$:b,ariaLabel$:x,menuClassName$:T,...E},J]=ge(ye,s),{selected$:k}=E,$=r(()=>a()??fe()),B=he(m,F),{hasFocus$:K,directive:Q}=Se(),u=ve(C,[c,K],([e,t])=>e&&t),L=r(()=>{const e=new Map,t=v();for(const i of k()){const l=t(i);e.set(l,{item:i,id:t(i),selected:!0})}return e}),V=r(()=>[...L().values()]),f=function(){const e=be(0);return U(e,t=>{const{length:i}=D();t!=null&&(i?t<0?t=i-1:t>=i&&(t=0):t=void 0),e.set(t)})}(),O=r(()=>{const e=new Map;if(u()){const t=L(),i=v();for(const l of g()){const d=i(l);e.set(d,{item:l,id:d,selected:t.has(d)})}}return e}),D=r(()=>u()?[...O().values()]:[]),R=r(()=>{const e=D(),t=f();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:X,referenceDirective:Y},stores:{placement$:W}}=Fe({props:{computePositionOptions:U(r(()=>({middleware:[Ie(5),je({allowedPlacements:j()}),Ne()]})))}}),{directive:Z,refreshElements:ee,focusFirst:te,focusLast:se,focusLeft:_,focusRight:H}=ke(),ie=r(()=>({keys:{Home:te,End:se,ArrowLeft:_,ArrowRight:H},selector:N()})),q=(e,t)=>{const i=e.target;ee(),o.api.unselect(t),i instanceof HTMLElement&&setTimeout(()=>{_({event:e,referenceElement:i})||H({event:e,referenceElement:i})}),e.preventDefault()},ae=h(()=>({attributes:{role:"combobox","aria-haspopup":"listbox","aria-expanded":r(()=>`${u()}`),"aria-controls":r(()=>`${$()}-menu`)}})),ne=h(e=>({attributes:{tabindex:-1,class:b},classNames:{"au-select-badge":!0},events:{keydown:t=>{let i=!1;switch(t.key){case"Backspace":case"Delete":{q(t,e().item),i=!0;break}}i&&t.preventDefault()}}})),oe=h(()=>({attributes:{role:"listbox",id:r(()=>`${$()}-menu`),"data-popper-placement":W,class:T},events:{mousedown:e=>e.preventDefault()}})),re=h(e=>({attributes:{role:"option","aria-selected":r(()=>`${e().selected}`),style:"cursor: pointer"},classNames:{"au-select-item":!0,selected:r(()=>e().selected)},events:{click:()=>o.api.toggleItem(e().item)}})),ce=h(()=>({attributes:{id:$(),type:"text","aria-label":x(),"aria-autocomplete":"list",autocorrect:"off",autocapitalize:"none",autocomplete:"off"},classNames:{"au-select-input":!0},events:{input:e=>{const t=e.target.value;we(()=>{u.set(t!=null&&t!==""),B.set(t)})},keydown:({ctrlKey:e,key:t,preventDefault:i})=>{let l=!0;switch(t){case"ArrowDown":{u()?e?o.api.highlightLast():o.api.highlightNext():(o.api.open(),o.api.highlightFirst());break}case"ArrowUp":e?o.api.highlightFirst():o.api.highlightPrevious();break;case"Enter":{const d=R();d&&o.api.toggleItem(d.item);break}case"Escape":u.set(!1);break;default:l=!1}l&&i()}}})),le=h(e=>({events:{click:t=>{q(t,e().item)}}})),o={...xe({id$:$,visibleItems$:D,highlighted$:R,open$:u,selectedContexts$:V,filterText$:B,placement$:W,className$:S,badgeClassName$:b,ariaLabel$:x,menuClassName$:T,...E}),patch:J,api:{clear(){k.set([])},select(e){o.api.toggleItem(e,!0)},unselect(e){o.api.toggleItem(e,!1)},toggleItem(e,t){const i=v(),l=i(e),w=L().has(l);t==null&&(t=!w),!(t&&!O().has(l)||!t&&!w)&&k.update(p=>{var z;if(p=[...p],t&&!w)p.push(e);else if(!t&&w){const ue=p.findIndex(de=>i(de)===l);p.splice(ue,1)}return(z=I())==null||z(p),p})},clearText(){},highlight(e){const t=D().findIndex(i=>i.item===e);f.set(t===-1?void 0:t)},highlightFirst(){f.set(0)},highlightPrevious(){f.update(e=>e!=null?e-1:-1)},highlightNext(){f.update(e=>e!=null?e+1:1/0)},highlightLast(){f.set(-1)},open:()=>o.api.toggle(!0),close:()=>o.api.toggle(!1),toggle(e){u.update(t=>e??!t)}},directives:{hasFocusDirective:Q,floatingDirective:X,referenceDirective:Y,inputContainerDirective:$e(De(Z,ie),ae),badgeAttributesDirective:ne,menuAttributesDirective:oe,itemAttributesDirective:re,inputDirective:ce,badgeCloseButtonDirective:le}};return o}const Pe={badgeLabel:({itemContext:s})=>s.item,itemLabel:({itemContext:s})=>s.item},Me=Le(Ae,Pe,{}),Te=Me;function Ee(s){return n.jsx(n.Fragment,{children:""+s.itemContext.item})}function Be(s){return n.jsx(n.Fragment,{children:""+s.itemContext.item})}function Oe({itemContext:s,slotContext:a}){return n.jsx("div",{...M(a.widget.directives.badgeAttributesDirective,s),children:n.jsx(G,{slotContent:a.state.badgeLabel,props:{...a,itemContext:s}})})}function Re({slotContext:s}){const a=[];for(const c of s.state.selectedContexts)a.push(n.jsx(Oe,{itemContext:c,slotContext:s},c.id));return a.length?n.jsx(n.Fragment,{children:a}):null}function We({itemContext:s,slotContext:a}){const c=pe("dropdown-item","position-relative",{"text-bg-primary":s===a.state.highlighted});return n.jsx("li",{className:c,...M(a.widget.directives.itemAttributesDirective,s),children:n.jsx(G,{slotContent:a.state.itemLabel,props:{...a,itemContext:s}})})}function _e({slotContext:s}){const{directives:{hasFocusDirective:a,floatingDirective:c,menuAttributesDirective:m}}=s.widget;return n.jsx("ul",{...A([P,"dropdown-menu show"],a,c,m),children:s.state.visibleItems.map(g=>n.jsx(We,{slotContext:s,itemContext:g},g.id))})}const He={badgeLabel:Ee,itemLabel:Be};function Ze(s){const[a,c]=me(Te,s,"select",He),m={state:a,widget:Ce(c)},{id:g,visibleItems:v,filterText:C,open:F,className:I}=a,j=`${g}-menu`,{directives:{hasFocusDirective:N,referenceDirective:S,inputContainerDirective:b,inputDirective:x}}=c;return n.jsxs("div",{...A([P,`au-select dropdown border border-1 p-1 mb-3 d-block ${I}`],S),children:[n.jsxs("div",{...A([P,"d-flex align-items-center flex-wrap gap-1"],N,b),children:[n.jsx(Re,{slotContext:m}),n.jsx("input",{value:C,...M(x),onChange:()=>{}})]}),F&&v.length>0&&n.jsx(_e,{slotContext:m,menuId:j})]})}export{Ze as S};
