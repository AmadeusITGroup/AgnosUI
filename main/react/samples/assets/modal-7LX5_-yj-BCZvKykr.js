import{e as L,m as D,j as W,b as a,C as _,n as c,z as S,r as P,h as ee,a as B}from"./dom-CzJpOnsw-BpVpkhUo.js";import{b as u,c as b,t as w,j as te}from"./writables-e0tyaQpe-D1Gha3PC.js";import{w as oe,s as re}from"./stores-DStrda4r.js";import{c as V}from"./baseTransitions-CUyVbC3e.js";import{d as ne}from"./promise-XSP94FjG-B8_DOdqg.js";import{c as ie}from"./widget-vd6sDzmv.js";const I=L((e,n)=>{let t,o;const i=()=>{o&&(o.parentNode?.replaceChild(e,o),o=null)},r=d=>{if(d!==t&&(d?.container!==t?.container||d?.insertBefore!==t?.insertBefore)){t=d;const p=t?.container??t?.insertBefore?.parentElement;if(p){const v=t?.insertBefore??null;(e.parentElement!==p||e.nextSibling!==v)&&(o||(o=e.parentNode?.insertBefore(e.ownerDocument.createComment("portal"),e)),p.insertBefore(e,v))}else i()}};return r(n),{update:r,destroy:()=>{i(),e.parentNode?.removeChild(e)}}}),se=e=>{const n=new Map,t=o=>{const i=o.parentElement;i&&o!==document.body&&(Array.from(i.children).forEach(r=>{r!==o&&r.nodeName!=="SCRIPT"&&(n.set(r,r.hasAttribute("inert")),r.toggleAttribute("inert",!0))}),t(i))};return t(e),()=>n.forEach((o,i)=>{i.toggleAttribute("inert",o)})};let F=c;const ae=e=>{F(),F=e?se(e):c},{directive:ce,elements$:le}=_(),de=a(()=>{const e=le();return e[e.length-1]},{equal:Object.is}),me=a(()=>ae(de())),be=D(ce,W(me)),pe=()=>{const e=Math.abs(window.innerWidth-document.documentElement.clientWidth),n=document.body,t=n.style,{overflow:o,paddingRight:i}=t;if(e>0){const r=parseFloat(window.getComputedStyle(n).paddingRight);t.paddingRight=`${r+e}px`}return t.overflow="hidden",()=>{e>0&&(t.paddingRight=i),t.overflow=o}};let C=c;const ue=()=>{C(),C=pe()},ve=()=>{C(),C=c},fe=Symbol(),$e=Symbol(),ge={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:c,closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:c,onBeforeClose:c,onVisibleChange:c,onHidden:c,onShown:c,visible:!1},he={animated:u,ariaCloseButtonLabel:w,backdrop:u,backdropClass:w,backdropTransition:b,closeButton:u,closeOnOutsideClick:u,container:te,className:w,modalTransition:b,onBeforeClose:b,onVisibleChange:b,onHidden:b,onShown:b,visible:u},j=ee(),Ce=a(()=>j().length>0),ye=a(()=>{Ce()?ue():ve()}),ke=a(()=>{ye()}),Ee=ie("modal",e=>{const[{animated$:n,backdrop$:t,backdropTransition$:o,closeOnOutsideClick$:i,container$:r,modalTransition$:d,onBeforeClose$:p,onVisibleChange$:v,onHidden$:T,onShown$:x,ariaCloseButtonLabel$:A,className$:E,backdropClass$:O,visible$:N,...q},f]=oe(ge,e,he),m=V({props:{transition:d,visible:N,animated:n,animatedOnInit:n,onVisibleChange:v,onHidden:T,onShown:x}}),y=m.stores.visible$,R=V({props:{transition:o,visible:N,animated:n,animatedOnInit:n}}),H=a(()=>m.stores.transitioning$()||t()&&R.stores.transitioning$()),$=a(()=>!H()&&!y()),z=a(()=>!t()||$());let g;const k=s=>{g=s;const l={get result(){return g},set result(h){g=h},cancel:!1};p()(l),!l.cancel&&f({visible:!1})},G=S(I,a(()=>({container:r()}))),J=S(I,a(()=>{const s=r(),l=s?m.stores.element$():void 0;return{container:s,insertBefore:l?.parentElement===s?l:void 0}})),K=P(void 0,()=>j.register(M)),Q=a(()=>{m.stores.elementPresent$()&&!$()&&K(),ke()}),U=B(()=>({attributes:{type:P("button"),"aria-label":A},events:{click:()=>k($e)}})),X=B(()=>({attributes:{class:O}})),Y=B(()=>({attributes:{class:E},events:{click:s=>{s.currentTarget===s.target&&i()&&k(fe)}}})),M={...re({backdropHidden$:z,container$:r,hidden$:$,transitioning$:H,visible$:y,modalElement$:m.stores.element$,ariaCloseButtonLabel$:A,className$:E,backdropClass$:O,...q}),directives:{modalPortalDirective:G,backdropPortalDirective:J,backdropDirective:D(R.directives.directive,X),modalDirective:D(m.directives.directive,be,W(Q),Y),closeButtonDirective:U,dialogDirective:S(L((s,l)=>{const h=Z=>{Z?s.showModal():s.close()};return h(l),{update:h}}),y)},patch:f,api:{close:k,async open(){return f({visible:!0}),await ne($).promise,g},patch:f}};return M});export{fe as a,Ee as c,$e as m};
