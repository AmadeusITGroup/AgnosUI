import{j as o}from"./App-CyvC_5t0.js";import{S as p}from"./slot-Dra5swoq.js";import{u as E}from"./directive-DNXkB1Wc-B0-Q0JWz.js";import{u as O}from"./config-B4y1ZCnE.js";import{w as R,f as S,g as m,s as q,K,m as U,a as y,n as V,b as G}from"./directive-CKEccryv-BrWl76X8.js";import{c as J}from"./navManager-BJWTxkCt.js";import{b as Q,h as X,a as T}from"./writables-DCiBdIBK-CaNqvQxH.js";import{e as Y}from"./extendWidget-DH8OAK3L.js";import{c as Z}from"./index-RliMuNdx.js";import"./config-DyC-BDse.js";import"./widget-DaA-pe23-17JDiM7P.js";import"./stores-B90XF8Sy-CKPsorV2.js";const ee={className:"",nodes:[],onExpandToggle:V,navSelector:r=>r.querySelectorAll("button"),ariaLabelToggleFn:r=>`Toggle ${r}`},te={className:Q,nodes:X,onExpandToggle:T,navSelector:T,ariaLabelToggleFn:T};function re(r){const[{nodes$:s,onExpandToggle$:n,navSelector$:d,ariaLabelToggleFn$:u,...v},I]=R(ee,r,te),x=new Map,A={get(e){return e.isExpanded}},g=S({}),_=m(()=>(b(),g(),A)),{elementsInDomOrder$:L,directive:$,refreshElements:C,focusIndex:M,focusPrevious:k,focusNext:F,focusFirst:P,focusLast:W}=J(),z=m(()=>({keys:{ArrowUp:k,ArrowDown:F,Home:P,End:W},selector:d()})),D=(e,t,i)=>{var a;const l={...e,ariaLabel:e.ariaLabel??e.label,level:t,children:[],isExpanded:(a=e.children)!=null&&a.length?e.isExpanded??!1:void 0};return x.set(l,{parent:i}),e.children&&(l.children=e.children.map(c=>D(c,t+1,l))),l},b=m(()=>(x.clear(),s().map(e=>D(e,0,void 0)))),N=S(b()[0]),f=e=>{const t=x.get(e);return t||console.error(`Node ${e.label} doesn't exist in the map`),t},B=G((e,t)=>{let i;const a=()=>{i&&i.htmlElement===e&&(i.htmlElement=void 0),i=void 0},l=c=>{a(),i=f(c.item),i&&(i.htmlElement&&console.warn("The tree item directive should be used once per element"),i.htmlElement=e)};return l(t),{update:l,destroy:a}}),w=e=>{var t;if(e){const i=(t=f(e))==null?void 0:t.htmlElement;if(i){const a=L().indexOf(i);M(a,0)}}},H=y(e=>({events:{focus:()=>{const{item:t}=e();N.set(t)},click:()=>{const{item:t}=e();h(t)},keydown:t=>{var i,a;const{key:l}=t,{item:c}=e(),j=c.isExpanded;switch(C(),l){case"ArrowLeft":j?h(c):w((i=f(c))==null?void 0:i.parent);break;case"ArrowRight":j?w((a=c.children)==null?void 0:a[0]):h(c);break;default:return}t.preventDefault(),t.stopPropagation()}},attributes:{"aria-label":m(()=>{const{item:t}=e();return u()(t.ariaLabel)}),tabindex:m(()=>{const{item:t}=e();return t===N()?"0":"-1"}),type:"button"},classNames:{"au-tree-expand-icon":!0,"au-tree-expand-icon-expanded":m(()=>{g();const{item:t}=e();return t.isExpanded??!1})}})),h=e=>{f(e)===void 0||e.isExpanded===void 0||(e.isExpanded=!e.isExpanded,g.set({}),n()(e))};return{...q({normalizedNodes$:b,expandedMap$:_,...v}),patch:I,api:{},directives:{navigationDirective:K($,z),itemToggleDirective:U(B,H),itemAttributesDirective:y(e=>({attributes:{role:"treeitem","aria-selected":"false","aria-expanded":m(()=>{var t;const{item:i}=e();return g(),(t=i.isExpanded)==null?void 0:t.toString()})}}))}}}const se={structure:void 0,item:void 0,itemContent:void 0,itemToggle:void 0},ie=Y(re,se,{structure:void 0,item:void 0,itemContent:void 0,itemToggle:void 0}),oe=ie,ne=({directive:r,item:s})=>o.jsx("button",{...E(r,{item:s})}),ae=r=>{const{directives:s,item:n}=r;return n.children.length>0?o.jsx(ne,{directive:s.itemToggleDirective,item:n}):o.jsx("span",{className:"au-tree-expand-icon-placeholder"})},le=r=>{const{state:s,item:n}=r;return o.jsxs("span",{className:"au-tree-item",children:[o.jsx(p,{slotContent:s.itemToggle,props:{...r}}),n.label]})},ce=r=>{const{state:s,directives:n,item:d}=r;return o.jsxs("li",{...E(n.itemAttributesDirective,{item:d}),children:[o.jsx(p,{slotContent:s.itemContent,props:{...r,item:d}}),s.expandedMap.get(d)&&o.jsx("ul",{role:"group",children:d.children.map((u,v)=>o.jsx(p,{slotContent:s.item,props:{...r,item:u}},u.label+u.level+v))})]})},de=r=>{const{state:s}=r;return o.jsx("ul",{role:"tree",className:Z("au-tree",s.className),...E(r.directives.navigationDirective),children:s.normalizedNodes.map((n,d)=>o.jsx(p,{slotContent:s.item,props:{item:n,...r}},n.label+n.level+d))})},me={structure:de,item:ce,itemContent:le,itemToggle:ae};function ue(r){const s=O(oe,r,"tree",{...me});return o.jsx(p,{slotContent:s.state.structure,props:s})}const Se=()=>{const r=[{label:"Node 1",isExpanded:!0,children:[{label:"Node 1.1",children:[{label:"Node 1.1.1"}]},{label:"Node 1.2",children:[{label:"Node 1.2.1"}]}]}];return o.jsx(ue,{nodes:r})};export{Se as default};
