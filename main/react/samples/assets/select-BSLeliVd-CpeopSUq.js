import{j as a}from"./App-XNADZBio.js";import{u as Z,S as W}from"./config-CU1Tiraw.js";import{a as A,u as ee}from"./directive-_62WM8Ul-DhygzKo7.js";import{w as te,c as g,q as se,l as ne,a as ae,g as O,s as oe,e as ie,b as B,t as re}from"./stores-CbKlqneq.js";import{c as le,o as ce,a as de,b as ue}from"./floatingUI-D23tb5J1.js";import{c as pe}from"./focustrack-DYzMzbdN.js";import{c as ge}from"./navManager-BWO2ZCYr.js";import{g as me,h as fe}from"./directive-DpAaJgAE-dbIg0imW.js";const he={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:s=>s.querySelectorAll(".au-select-badge,input"),itemIdFn:s=>""+s,onOpenChange:B,onFilterTextChange:B,onSelectedChange:B,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:"",slotBadgeLabel:({itemContext:s})=>s.item,slotItem:({itemContext:s})=>s.item};function ve(s){const[{id$:i,open$:o,filterText$:u,items$:l,itemIdFn$:m,onOpenChange$:f,onFilterTextChange$:y,onSelectedChange$:x,allowedPlacements$:j,navSelector$:N,...w},$]=te(he,s),{selected$:b}=w,C=g(()=>i()??me()),I=se(u,y),{hasFocus$:S,directive:k}=pe(),d=ne(f,[o,S],([e,t])=>e&&t),M=g(()=>{const e=new Map,t=m();for(const n of b()){const c=t(n);e.set(c,{item:n,id:t(n),selected:!0})}return e}),_=g(()=>[...M().values()]),v=function(){const e=ae(0);return O(e,t=>{const{length:n}=D();t!=null&&(n?t<0?t=n-1:t>=n&&(t=0):t=void 0),e.set(t)})}(),L=g(()=>{const e=new Map;if(d()){const t=M(),n=m();for(const c of l()){const p=n(c);e.set(p,{item:c,id:p,selected:t.has(p)})}}return e}),D=g(()=>d()?[...L().values()]:[]),P=g(()=>{const e=D(),t=v();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:H,referenceDirective:q},stores:{placement$:z}}=le({props:{computePositionOptions:O(g(()=>({middleware:[ce(5),de({allowedPlacements:j()}),ue()]})))}}),{directive:U,refreshElements:G,focusFirst:J,focusLast:Q,focusLeft:T,focusRight:E}=ge(),V=g(()=>({keys:{Home:J,End:Q,ArrowLeft:T,ArrowRight:E},selector:N()})),K=(e,t)=>{const n=e.target;G(),r.api.unselect(t),n instanceof HTMLElement&&setTimeout(()=>{T({event:e,referenceElement:n})||E({event:e,referenceElement:n})}),e.preventDefault()},r={...oe({id$:C,visibleItems$:D,highlighted$:P,open$:d,selectedContexts$:_,filterText$:I,placement$:z,...w}),patch:$,api:{clear(){b.set([])},select(e){r.api.toggleItem(e,!0)},unselect(e){r.api.toggleItem(e,!1)},toggleItem(e,t){const n=m(),c=n(e),F=M().has(c);t==null&&(t=!F),!(t&&!L().has(c)||!t&&!F)&&b.update(h=>{var R;if(h=[...h],t&&!F)h.push(e);else if(!t&&F){const X=h.findIndex(Y=>n(Y)===c);h.splice(X,1)}return(R=x())==null||R(h),h})},clearText(){},highlight(e){const t=D().findIndex(n=>n.item===e);v.set(t===-1?void 0:t)},highlightFirst(){v.set(0)},highlightPrevious(){v.update(e=>e!=null?e-1:-1)},highlightNext(){v.update(e=>e!=null?e+1:1/0)},highlightLast(){v.set(-1)},open:()=>r.api.toggle(!0),close:()=>r.api.toggle(!1),toggle(e){d.update(t=>e??!t)}},directives:{hasFocusDirective:k,floatingDirective:H,referenceDirective:q,inputContainerDirective:fe(U,V)},actions:{onInput({target:e}){const t=e.value;ie(()=>{d.set(t!=null&&t!==""),I.set(t)})},onRemoveBadgeClick(e,t){K(e,t)},onInputKeydown(e){const{ctrlKey:t,key:n}=e;let c=!0;switch(n){case"ArrowDown":{d()?t?r.api.highlightLast():r.api.highlightNext():(r.api.open(),r.api.highlightFirst());break}case"ArrowUp":t?r.api.highlightFirst():r.api.highlightPrevious();break;case"Enter":{const p=P();p&&r.api.toggleItem(p.item);break}case"Escape":d.set(!1);break;default:c=!1}c&&e.preventDefault()},onBadgeKeydown(e,t){let n=!1;switch(e.key){case"Backspace":case"Delete":{K(e,t),n=!0;break}}n&&e.preventDefault()}}};return r}const be=ve;function xe(s){s.preventDefault()}function we(s){return a.jsx(a.Fragment,{children:""+s.itemContext.item})}function $e(s){return a.jsx(a.Fragment,{children:""+s.itemContext.item})}function Ce({itemContext:s,slotContext:i}){const o=i.state;return a.jsx("div",{tabIndex:-1,className:`au-select-badge me-1 ${o.badgeClassName}`,onKeyDown:u=>i.widget.actions.onBadgeKeydown(u.nativeEvent,s.item),children:a.jsx(W,{slotContent:o.slotBadgeLabel,props:{...i,itemContext:s}})},s.id)}function Ie({slotContext:s}){const i=[];for(const o of s.state.selectedContexts)i.push(a.jsx(Ce,{itemContext:o,slotContext:s},o.id));return i.length?a.jsx(a.Fragment,{children:i}):null}function De({slotContext:s}){const{widget:i,state:o}=s,u=o.highlighted;return a.jsx(a.Fragment,{children:o.visibleItems.map(l=>{const{id:m}=l,f=["au-select-item dropdown-item position-relative"];return l===u&&f.push("text-bg-primary"),l.selected&&f.push("selected"),a.jsx("li",{role:"option","aria-selected":l.selected,className:f.join(" "),onClick:()=>i.api.toggleItem(l.item),style:{cursor:"pointer"},children:a.jsx(W,{slotContent:o.slotItem,props:{...s,itemContext:l}})},m)})})}const Fe={slotBadgeLabel:we,slotItem:$e};function Pe(s){const[i,o]=Z(be,s,"select",Fe),u={state:i,widget:re(o)},{id:l,ariaLabel:m,visibleItems:f,filterText:y,open:x,className:j,menuClassName:N,placement:w}=i,$=`${l}-menu`,{directives:{floatingDirective:b,hasFocusDirective:C,referenceDirective:I,inputContainerDirective:S}}=o,k=A([C,b]);return a.jsxs("div",{className:`au-select dropdown border border-1 p-1 mb-3 d-block ${j}`,...ee(I),children:[a.jsxs("div",{...A([C,S]),role:"combobox",className:"d-flex align-items-center flex-wrap","aria-controls":$,"aria-haspopup":"listbox","aria-expanded":x,children:[a.jsx(Ie,{slotContext:u}),a.jsx("input",{id:l,"aria-label":m,className:"au-select-input flex-grow-1 border-0",type:"text",value:y,"aria-autocomplete":"list",autoCorrect:"off",autoCapitalize:"none",autoComplete:"off",onInput:o.actions.onInput,onKeyDown:d=>o.actions.onInputKeydown(d.nativeEvent)})]}),x&&f.length>0&&a.jsx("ul",{...k,role:"listbox",id:$,className:`dropdown-menu show ${N}`,"data-popper-placement":w,onMouseDown:xe,children:a.jsx(De,{slotContext:u})})]})}export{Pe as S};
