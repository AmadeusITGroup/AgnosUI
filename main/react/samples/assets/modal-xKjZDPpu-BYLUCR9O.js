import{a as oe,j as o,r as A,c as se}from"./App-XNADZBio.js";import{u as re,S as f}from"./config-CU1Tiraw.js";import{u as T}from"./directive-_62WM8Ul-DhygzKo7.js";import{c as l,b as d,w as ie,r as ne,s as ae,t as le}from"./stores-CbKlqneq.js";import{t as b,b as w,a as p,c as ce}from"./writables-DoU_XYTX-dxvvE_8w.js";import{c as F}from"./baseTransitions-B0Uz6_1l.js";import{p as de}from"./promise-CY2U8bTP-DyoYE_Xk.js";import{a as me,f as ue,m as x,d as q,r as pe,h as I,b as V,c as N}from"./directive-DpAaJgAE-dbIg0imW.js";import{f as W}from"./fade-uOobJKgw-BzWpDnkF.js";import{e as ve}from"./extendWidget-DH6bFaPr.js";const L=me((e,s)=>{let t,r;const n=()=>{var a;r&&((a=r.parentNode)==null||a.replaceChild(e,r),r=null)},i=a=>{var h,g;if(a!==t&&((a==null?void 0:a.container)!==(t==null?void 0:t.container)||(a==null?void 0:a.insertBefore)!==(t==null?void 0:t.insertBefore))){t=a;const v=(t==null?void 0:t.container)??((h=t==null?void 0:t.insertBefore)==null?void 0:h.parentElement);if(v){const $=(t==null?void 0:t.insertBefore)??null;(e.parentElement!==v||e.nextSibling!==$)&&(r||(r=(g=e.parentNode)==null?void 0:g.insertBefore(e.ownerDocument.createComment("portal"),e)),v.insertBefore(e,$))}else n()}};return i(s),{update:i,destroy:()=>{var a;n(),(a=e.parentNode)==null||a.removeChild(e)}}}),be=e=>{const s=new Map,t=r=>{const n=r.parentElement;n&&r!==document.body&&(Array.from(n.children).forEach(i=>{i!==r&&i.nodeName!=="SCRIPT"&&(s.set(i,i.hasAttribute("inert")),i.toggleAttribute("inert",!0))}),t(n))};return t(e),()=>s.forEach((r,n)=>{n.toggleAttribute("inert",r)})};let _=d;const fe=e=>{_(),_=e?be(e):d},{directive:he,elements$:ge}=ue(),$e=l(()=>{const e=ge();return e[e.length-1]},{equal:Object.is}),ke=l(()=>fe($e())),Ce=x(he,q(ke)),Se=()=>{const e=Math.abs(window.innerWidth-document.documentElement.clientWidth),s=document.body,t=s.style,{overflow:r,paddingRight:n}=t;if(e>0){const i=parseFloat(window.getComputedStyle(s).paddingRight);t.paddingRight=`${i+e}px`}return t.overflow="hidden",()=>{e>0&&(t.paddingRight=n),t.overflow=r}};let B=d;const ye=()=>{B(),B=Se()},Be=()=>{B(),B=d},De=Symbol(),je=Symbol(),we={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:async()=>{},closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:async()=>{},onBeforeClose:d,onVisibleChange:d,onHidden:d,onShown:d,slotDefault:void 0,slotFooter:void 0,slotHeader:void 0,slotStructure:void 0,slotTitle:void 0,visible:!1,contentData:void 0},Ne={animated:b,ariaCloseButtonLabel:w,backdrop:b,backdropClass:w,backdropTransition:p,closeButton:b,closeOnOutsideClick:b,container:ce,className:w,modalTransition:p,onBeforeClose:p,onVisibleChange:p,onHidden:p,onShown:p,visible:b},z=pe(),xe=l(()=>z().length>0),Te=l(()=>{xe()?ye():Be()}),Ee=l(()=>{Te()});function He(e){const[{animated$:s,backdrop$:t,backdropTransition$:r,closeOnOutsideClick$:n,container$:i,modalTransition$:a,onBeforeClose$:h,onVisibleChange$:g,onHidden$:v,onShown$:$,ariaCloseButtonLabel$:D,className$:E,backdropClass$:H,visible$:M,...G},k]=ie(we,e,Ne),m=F({props:{transition:a,visible:M,animated:s,animatedOnInit:s,onVisibleChange:g,onHidden:v,onShown:$}}),R=m.stores.visible$,O=F({props:{transition:r,visible:M,animated:s,animatedOnInit:s}}),P=l(()=>m.stores.transitioning$()||t()&&O.stores.transitioning$()),C=l(()=>!P()&&!R()),J=l(()=>!t()||C());let S;const j=c=>{S=c;const u={get result(){return S},set result(te){S=te},cancel:!1};h()(u),!u.cancel&&k({visible:!1})},K=I(L,l(()=>({container:i()}))),Q=I(L,l(()=>{const c=i(),u=c?m.stores.element$():void 0;return{container:c,insertBefore:(u==null?void 0:u.parentElement)===c?u:void 0}})),U=ne(void 0,()=>z.register(y)),X=l(()=>{m.stores.elementPresent$()&&!C()&&U(),Ee()}),Y=N(()=>({attributes:{type:"button","aria-label":D},events:{click:y.actions.closeButtonClick}})),Z=N(()=>({attributes:{class:H}})),ee=N(()=>({attributes:{class:E},events:{click:y.actions.modalClick}})),y={...ae({backdropHidden$:J,container$:i,hidden$:C,transitioning$:P,visible$:R,modalElement$:m.stores.element$,ariaCloseButtonLabel$:D,className$:E,backdropClass$:H,...G}),directives:{modalPortalDirective:K,backdropPortalDirective:Q,backdropDirective:x(V(O.directives.directive),Z),modalDirective:x(V(m.directives.directive),Ce,q(X),ee),closeButtonDirective:Y},patch:k,api:{close:j,async open(){return k({visible:!0}),await de(C).promise,S},patch:k},actions:{modalClick(c){c.currentTarget===c.target&&n()&&j(De)},closeButtonClick(c){j(je)}}};return y}const Me=({children:e,container:s})=>s?oe.createPortal(e,s):o.jsx(o.Fragment,{children:e}),Re={backdropTransition:W,modalTransition:W},Oe=ve(He,{},{},Re),Pe=Oe,Ae=e=>{const s=T(e.widget.directives.closeButtonDirective);return o.jsxs(o.Fragment,{children:[o.jsx("h5",{className:"modal-title",children:o.jsx(f,{slotContent:e.state.slotTitle,props:e})}),e.state.closeButton&&o.jsx("button",{className:"btn-close",...s})]})},Fe=e=>o.jsxs(o.Fragment,{children:[e.state.slotTitle&&o.jsx("div",{className:"modal-header",children:o.jsx(f,{slotContent:e.state.slotHeader,props:e})}),o.jsx("div",{className:"modal-body",children:o.jsx(f,{slotContent:e.state.slotDefault,props:e})}),e.state.slotFooter&&o.jsx("div",{className:"modal-footer",children:o.jsx(f,{slotContent:e.state.slotFooter,props:e})})]}),Ie={slotHeader:Ae,slotStructure:Fe},Ve=({widget:e})=>o.jsx("div",{className:"modal-backdrop",...T(e.directives.backdropDirective)}),We=e=>o.jsx("div",{className:"modal d-block",...T(e.widget.directives.modalDirective),children:o.jsx("div",{className:"modal-dialog",children:o.jsx("div",{className:"modal-content",children:o.jsx(f,{slotContent:e.state.slotStructure,props:e})})})}),Le=A.forwardRef(function(s,t){const[r,n]=re(Pe,s,"modal",{...Ie,slotDefault:s.children});A.useImperativeHandle(t,()=>n.api,[]);const i={state:r,widget:le(n)};return o.jsxs(Me,{container:r.container,children:[!r.backdropHidden&&o.jsx(Ve,{...i}),!r.hidden&&o.jsx(We,{...i})]})});async function Ze(e){const s=se.createRoot(document.createElement("div"));try{return await(await new Promise(r=>{s.render(o.jsx(Le,{...e,ref:r}))})).open()}finally{s.unmount()}}export{Le as M,De as a,je as m,Ze as o};
