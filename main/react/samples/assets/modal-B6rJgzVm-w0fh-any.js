import{a as se,j as s,r as P,c as re}from"./App-XNADZBio.js";import{u as ie,S as b}from"./config-CCs_7nqP.js";import{a as _,u as ne}from"./directive-Kqp31pwt-CpBdIrAv.js";import{l as ae,p as le,c as l,e as N,g as q,h as d,r as ce,w as de,q as A,d as me,s as ue,j as F,f as w,t as pe,k as z}from"./directive-DCYlDznf-D2hjAqcK.js";import{t as v,b as x,a as p,c as ve}from"./writables-DoU_XYTX-Dq9jyVLj.js";import{c as V}from"./baseTransitions-Amn6yFiO.js";import{p as fe}from"./promise-CY2U8bTP-ChJZdKFm.js";import{f as I}from"./fade-uOobJKgw-CncxQG4y.js";import{e as be}from"./extendWidget-B-unuY20.js";import{c as ge}from"./index-Bh3NuAq4.js";const W=ae((e,o)=>{let t,r;const n=()=>{var a;r&&((a=r.parentNode)==null||a.replaceChild(e,r),r=null)},i=a=>{var g,h;if(a!==t&&((a==null?void 0:a.container)!==(t==null?void 0:t.container)||(a==null?void 0:a.insertBefore)!==(t==null?void 0:t.insertBefore))){t=a;const f=(t==null?void 0:t.container)??((g=t==null?void 0:t.insertBefore)==null?void 0:g.parentElement);if(f){const $=(t==null?void 0:t.insertBefore)??null;(e.parentElement!==f||e.nextSibling!==$)&&(r||(r=(h=e.parentNode)==null?void 0:h.insertBefore(e.ownerDocument.createComment("portal"),e)),f.insertBefore(e,$))}else n()}};return i(o),{update:i,destroy:()=>{var a;n(),(a=e.parentNode)==null||a.removeChild(e)}}}),he=e=>{const o=new Map,t=r=>{const n=r.parentElement;n&&r!==document.body&&(Array.from(n.children).forEach(i=>{i!==r&&i.nodeName!=="SCRIPT"&&(o.set(i,i.hasAttribute("inert")),i.toggleAttribute("inert",!0))}),t(n))};return t(e),()=>o.forEach((r,n)=>{n.toggleAttribute("inert",r)})};let L=d;const $e=e=>{L(),L=e?he(e):d},{directive:ke,elements$:Ce}=le(),Se=l(()=>{const e=Ce();return e[e.length-1]},{equal:Object.is}),ye=l(()=>$e(Se())),De=N(ke,q(ye)),Be=()=>{const e=Math.abs(window.innerWidth-document.documentElement.clientWidth),o=document.body,t=o.style,{overflow:r,paddingRight:n}=t;if(e>0){const i=parseFloat(window.getComputedStyle(o).paddingRight);t.paddingRight=`${i+e}px`}return t.overflow="hidden",()=>{e>0&&(t.paddingRight=n),t.overflow=r}};let D=d;const je=()=>{D(),D=Be()},we=()=>{D(),D=d},xe=Symbol(),Ne=Symbol(),Ee={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:async()=>{},closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:async()=>{},onBeforeClose:d,onVisibleChange:d,onHidden:d,onShown:d,visible:!1,contentData:void 0},Te={animated:v,ariaCloseButtonLabel:x,backdrop:v,backdropClass:x,backdropTransition:p,closeButton:v,closeOnOutsideClick:v,container:ve,className:x,modalTransition:p,onBeforeClose:p,onVisibleChange:p,onHidden:p,onShown:p,visible:v},G=ce(),He=l(()=>G().length>0),Me=l(()=>{He()?je():we()}),Re=l(()=>{Me()});function Oe(e){const[{animated$:o,backdrop$:t,backdropTransition$:r,closeOnOutsideClick$:n,container$:i,modalTransition$:a,onBeforeClose$:g,onVisibleChange$:h,onHidden$:f,onShown$:$,ariaCloseButtonLabel$:B,className$:E,backdropClass$:T,visible$:H,...J},k]=de(Ee,e,Te),m=V({props:{transition:a,visible:H,animated:o,animatedOnInit:o,onVisibleChange:h,onHidden:f,onShown:$}}),M=m.stores.visible$,R=V({props:{transition:r,visible:H,animated:o,animatedOnInit:o}}),O=l(()=>m.stores.transitioning$()||t()&&R.stores.transitioning$()),C=l(()=>!O()&&!M()),K=l(()=>!t()||C());let S;const j=c=>{S=c;const u={get result(){return S},set result(oe){S=oe},cancel:!1};g()(u),!u.cancel&&k({visible:!1})},Q=A(W,l(()=>({container:i()}))),U=A(W,l(()=>{const c=i(),u=c?m.stores.element$():void 0;return{container:c,insertBefore:(u==null?void 0:u.parentElement)===c?u:void 0}})),X=me(void 0,()=>G.register(y)),Y=l(()=>{m.stores.elementPresent$()&&!C()&&X(),Re()}),Z=w(()=>({attributes:{type:"button","aria-label":B},events:{click:y.actions.closeButtonClick}})),ee=w(()=>({attributes:{class:T}})),te=w(()=>({attributes:{class:E},events:{click:y.actions.modalClick}})),y={...ue({backdropHidden$:K,container$:i,hidden$:C,transitioning$:O,visible$:M,modalElement$:m.stores.element$,ariaCloseButtonLabel$:B,className$:E,backdropClass$:T,...J}),directives:{modalPortalDirective:Q,backdropPortalDirective:U,backdropDirective:N(F(R.directives.directive),ee),modalDirective:N(F(m.directives.directive),De,q(Y),te),closeButtonDirective:Z},patch:k,api:{close:j,async open(){return k({visible:!0}),await fe(C).promise,S},patch:k},actions:{modalClick(c){c.currentTarget===c.target&&n()&&j(xe)},closeButtonClick(c){j(Ne)}}};return y}const Pe={slotDefault:void 0,slotFooter:void 0,slotHeader:void 0,slotStructure:void 0,slotTitle:void 0,fullscreen:!1},Ae={backdropTransition:I,modalTransition:I},Fe={fullscreen:v},Ve=be(Oe,Pe,Fe,Ae),Ie=({children:e,container:o})=>o?se.createPortal(e,o):s.jsx(s.Fragment,{children:e}),We=Ve,Le=e=>{const o=ne(e.widget.directives.closeButtonDirective);return s.jsxs(s.Fragment,{children:[s.jsx("h5",{className:"modal-title",children:s.jsx(b,{slotContent:e.state.slotTitle,props:e})}),e.state.closeButton&&s.jsx("button",{className:"btn-close",...o})]})},_e=e=>s.jsxs(s.Fragment,{children:[e.state.slotTitle&&s.jsx("div",{className:"modal-header",children:s.jsx(b,{slotContent:e.state.slotHeader,props:e})}),s.jsx("div",{className:"modal-body",children:s.jsx(b,{slotContent:e.state.slotDefault,props:e})}),e.state.slotFooter&&s.jsx("div",{className:"modal-footer",children:s.jsx(b,{slotContent:e.state.slotFooter,props:e})})]}),qe={slotHeader:Le,slotStructure:_e},ze=({widget:e})=>s.jsx("div",{..._([z,"modal-backdrop"],e.directives.backdropDirective)}),Ge=e=>{const{fullscreen:o}=e.state;return s.jsx("div",{..._([z,"modal d-block"],e.widget.directives.modalDirective),children:s.jsx("div",{className:ge("modal-dialog",{"modal-fullscreen":o}),children:s.jsx("div",{className:"modal-content",children:s.jsx(b,{slotContent:e.state.slotStructure,props:e})})})})},Je=P.forwardRef(function(o,t){const[r,n]=ie(We,o,"modal",{...qe,slotDefault:o.children});P.useImperativeHandle(t,()=>n.api,[]);const i={state:r,widget:pe(n)};return s.jsxs(Ie,{container:r.container,children:[!r.backdropHidden&&s.jsx(ze,{...i}),!r.hidden&&s.jsx(Ge,{...i})]})});async function rt(e){const o=re.createRoot(document.createElement("div"));try{return await(await new Promise(r=>{o.render(s.jsx(Je,{...e,ref:r}))})).open()}finally{o.unmount()}}export{Je as M,xe as a,Ne as m,rt as o};
