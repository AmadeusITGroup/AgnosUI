import{a as se,j as o,r as P,c as ie}from"./App-XNADZBio.js";import{u as re,S as f}from"./config-CU1Tiraw.js";import{a as _,u as ne}from"./directive-CRCdIwrf-BOCwrDYW.js";import{c as l,b as d,w as ae,r as le,s as ce,t as de}from"./stores-CbKlqneq.js";import{t as b,b as w,a as p,c as me}from"./writables-DoU_XYTX-dxvvE_8w.js";import{c as A}from"./baseTransitions-CZ0xF46J.js";import{p as ue}from"./promise-CY2U8bTP-DyoYE_Xk.js";import{e as pe,h as ve,m as N,d as q,r as be,i as F,b as I,c as x,a as z}from"./directive-ClyvktyQ-C8pWaTxk.js";import{f as V}from"./fade-uOobJKgw-D9QQpHO8.js";import{e as fe}from"./extendWidget-DH6bFaPr.js";const W=pe((e,s)=>{let t,i;const n=()=>{var a;i&&((a=i.parentNode)==null||a.replaceChild(e,i),i=null)},r=a=>{var h,g;if(a!==t&&((a==null?void 0:a.container)!==(t==null?void 0:t.container)||(a==null?void 0:a.insertBefore)!==(t==null?void 0:t.insertBefore))){t=a;const v=(t==null?void 0:t.container)??((h=t==null?void 0:t.insertBefore)==null?void 0:h.parentElement);if(v){const $=(t==null?void 0:t.insertBefore)??null;(e.parentElement!==v||e.nextSibling!==$)&&(i||(i=(g=e.parentNode)==null?void 0:g.insertBefore(e.ownerDocument.createComment("portal"),e)),v.insertBefore(e,$))}else n()}};return r(s),{update:r,destroy:()=>{var a;n(),(a=e.parentNode)==null||a.removeChild(e)}}}),he=e=>{const s=new Map,t=i=>{const n=i.parentElement;n&&i!==document.body&&(Array.from(n.children).forEach(r=>{r!==i&&r.nodeName!=="SCRIPT"&&(s.set(r,r.hasAttribute("inert")),r.toggleAttribute("inert",!0))}),t(n))};return t(e),()=>s.forEach((i,n)=>{n.toggleAttribute("inert",i)})};let L=d;const ge=e=>{L(),L=e?he(e):d},{directive:$e,elements$:ke}=ve(),Ce=l(()=>{const e=ke();return e[e.length-1]},{equal:Object.is}),Se=l(()=>ge(Ce())),ye=N($e,q(Se)),De=()=>{const e=Math.abs(window.innerWidth-document.documentElement.clientWidth),s=document.body,t=s.style,{overflow:i,paddingRight:n}=t;if(e>0){const r=parseFloat(window.getComputedStyle(s).paddingRight);t.paddingRight=`${r+e}px`}return t.overflow="hidden",()=>{e>0&&(t.paddingRight=n),t.overflow=i}};let D=d;const Be=()=>{D(),D=De()},je=()=>{D(),D=d},we=Symbol(),xe=Symbol(),Ne={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:async()=>{},closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:async()=>{},onBeforeClose:d,onVisibleChange:d,onHidden:d,onShown:d,slotDefault:void 0,slotFooter:void 0,slotHeader:void 0,slotStructure:void 0,slotTitle:void 0,visible:!1,contentData:void 0},Te={animated:b,ariaCloseButtonLabel:w,backdrop:b,backdropClass:w,backdropTransition:p,closeButton:b,closeOnOutsideClick:b,container:me,className:w,modalTransition:p,onBeforeClose:p,onVisibleChange:p,onHidden:p,onShown:p,visible:b},G=be(),Ee=l(()=>G().length>0),He=l(()=>{Ee()?Be():je()}),Me=l(()=>{He()});function Re(e){const[{animated$:s,backdrop$:t,backdropTransition$:i,closeOnOutsideClick$:n,container$:r,modalTransition$:a,onBeforeClose$:h,onVisibleChange$:g,onHidden$:v,onShown$:$,ariaCloseButtonLabel$:B,className$:T,backdropClass$:E,visible$:H,...J},k]=ae(Ne,e,Te),m=A({props:{transition:a,visible:H,animated:s,animatedOnInit:s,onVisibleChange:g,onHidden:v,onShown:$}}),M=m.stores.visible$,R=A({props:{transition:i,visible:H,animated:s,animatedOnInit:s}}),O=l(()=>m.stores.transitioning$()||t()&&R.stores.transitioning$()),C=l(()=>!O()&&!M()),K=l(()=>!t()||C());let S;const j=c=>{S=c;const u={get result(){return S},set result(oe){S=oe},cancel:!1};h()(u),!u.cancel&&k({visible:!1})},Q=F(W,l(()=>({container:r()}))),U=F(W,l(()=>{const c=r(),u=c?m.stores.element$():void 0;return{container:c,insertBefore:(u==null?void 0:u.parentElement)===c?u:void 0}})),X=le(void 0,()=>G.register(y)),Y=l(()=>{m.stores.elementPresent$()&&!C()&&X(),Me()}),Z=x(()=>({attributes:{type:"button","aria-label":B},events:{click:y.actions.closeButtonClick}})),ee=x(()=>({attributes:{class:E}})),te=x(()=>({attributes:{class:T},events:{click:y.actions.modalClick}})),y={...ce({backdropHidden$:K,container$:r,hidden$:C,transitioning$:O,visible$:M,modalElement$:m.stores.element$,ariaCloseButtonLabel$:B,className$:T,backdropClass$:E,...J}),directives:{modalPortalDirective:Q,backdropPortalDirective:U,backdropDirective:N(I(R.directives.directive),ee),modalDirective:N(I(m.directives.directive),ye,q(Y),te),closeButtonDirective:Z},patch:k,api:{close:j,async open(){return k({visible:!0}),await ue(C).promise,S},patch:k},actions:{modalClick(c){c.currentTarget===c.target&&n()&&j(we)},closeButtonClick(c){j(xe)}}};return y}const Oe=({children:e,container:s})=>s?se.createPortal(e,s):o.jsx(o.Fragment,{children:e}),Pe={backdropTransition:V,modalTransition:V},Ae=fe(Re,{},{},Pe),Fe=Ae,Ie=e=>{const s=ne(e.widget.directives.closeButtonDirective);return o.jsxs(o.Fragment,{children:[o.jsx("h5",{className:"modal-title",children:o.jsx(f,{slotContent:e.state.slotTitle,props:e})}),e.state.closeButton&&o.jsx("button",{className:"btn-close",...s})]})},Ve=e=>o.jsxs(o.Fragment,{children:[e.state.slotTitle&&o.jsx("div",{className:"modal-header",children:o.jsx(f,{slotContent:e.state.slotHeader,props:e})}),o.jsx("div",{className:"modal-body",children:o.jsx(f,{slotContent:e.state.slotDefault,props:e})}),e.state.slotFooter&&o.jsx("div",{className:"modal-footer",children:o.jsx(f,{slotContent:e.state.slotFooter,props:e})})]}),We={slotHeader:Ie,slotStructure:Ve},Le=({widget:e})=>o.jsx("div",{..._([z,"modal-backdrop"],e.directives.backdropDirective)}),_e=e=>o.jsx("div",{..._([z,"modal d-block"],e.widget.directives.modalDirective),children:o.jsx("div",{className:"modal-dialog",children:o.jsx("div",{className:"modal-content",children:o.jsx(f,{slotContent:e.state.slotStructure,props:e})})})}),qe=P.forwardRef(function(s,t){const[i,n]=re(Fe,s,"modal",{...We,slotDefault:s.children});P.useImperativeHandle(t,()=>n.api,[]);const r={state:i,widget:de(n)};return o.jsxs(Oe,{container:i.container,children:[!i.backdropHidden&&o.jsx(Le,{...r}),!i.hidden&&o.jsx(_e,{...r})]})});async function tt(e){const s=ie.createRoot(document.createElement("div"));try{return await(await new Promise(i=>{s.render(o.jsx(qe,{...e,ref:i}))})).open()}finally{s.unmount()}}export{qe as M,we as a,xe as m,tt as o};
