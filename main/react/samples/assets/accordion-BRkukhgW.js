import{r as $,j as m}from"./index-D1jVmOie.js";import{w as P,s as R,m as U,n as X}from"./stores-m8eykaCI.js";import{c as Y}from"./baseTransitions-muvy8cPQ.js";import{c as Z}from"./collapse-hyOmdecH.js";import{c as h,w as F,n as f}from"./func-BRtNsj1u.js";import{t as u,a as l,b as r}from"./writables-BNxSaSLV.js";import{r as ee,d as te,b as ie,u as E}from"./directive-CX3maK86.js";import{g as se}from"./dom-Hs1W5kAC.js";import{u as W,S as N}from"./config-CT8Z2Jij.js";function ae(e,s,o){let d;return s.length==2?(o=o??s[0],d=s.find(a=>a!==o)):s.length>2&&(d=s[0]),d&&e.forEach(a=>{a.state$().itemId!==d&&a.state$().itemVisible&&a.patch({itemVisible:!1})}),e}function j(e,s){return e.find(o=>o.state$().itemId===s)}const i={closeOthers:!1,onShown:f,onHidden:f,className:"",itemId:"",itemDestroyOnHide:!0,itemDisabled:!1,itemVisible:!1,itemAnimated:!0,itemTransition:Z,itemHeadingTag:"",onItemShown:f,onItemHidden:f,onItemVisibleChange:f,slotItemStructure:void 0,slotItemBody:void 0,slotItemHeader:void 0,itemClass:"",itemHeaderClass:"",itemButtonClass:"",itemBodyContainerClass:"",itemBodyClass:""},M={itemId:i.itemId,itemDestroyOnHide:i.itemDestroyOnHide,itemDisabled:i.itemDisabled,itemVisible:i.itemVisible,itemAnimated:i.itemAnimated,itemTransition:i.itemTransition,onItemShown:i.onItemShown,onItemHidden:i.onItemHidden,onItemVisibleChange:i.onItemVisibleChange,slotItemStructure:i.slotItemStructure,slotItemBody:i.slotItemBody,slotItemHeader:i.slotItemHeader,itemClass:i.itemClass,itemHeaderClass:i.itemHeaderClass,itemButtonClass:i.itemButtonClass,itemBodyContainerClass:i.itemBodyContainerClass,itemBodyClass:i.itemBodyClass,itemHeadingTag:i.itemHeadingTag},x=Object.keys(M),ne={closeOthers:u,onShown:l,onHidden:l,itemId:r,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimated:u,itemTransition:l,onItemShown:l,onItemHidden:l,onItemVisibleChange:l,itemClass:r,itemHeaderClass:r,itemButtonClass:r,itemBodyContainerClass:r,itemBodyClass:r,itemHeadingTag:r},oe={itemId:r,itemDestroyOnHide:u,itemDisabled:u,itemVisible:u,itemAnimated:u,itemTransition:l,onItemShown:l,onItemHidden:l,onItemVisibleChange:l,itemClass:r,itemHeaderClass:r,itemButtonClass:r,itemBodyContainerClass:r,itemBodyClass:r,itemHeadingTag:r};function de(e,s,o){const[{itemAnimated$:d,itemTransition$:a,itemDestroyOnHide$:c,onItemShown$:p,onItemHidden$:b,onItemVisibleChange$:S,itemVisible$:g,itemId$:v,itemDisabled$:y,...A},V]=P(M,o,oe),D=F(!1),w=h(()=>se()),H=h(()=>v()||w()),T=h(()=>c()===!1||!B.state$().hidden),B=Y({props:{transition:a,visible:g,onVisibleChange:S,animated:d,animatedOnInit:!1,initDone:D,onHidden:()=>{s()(H()),b()()},onShown:()=>{e()(H()),p()()}}});return{...R({itemVisible$:g,itemId$:H,shouldBeInDOM$:T,itemDisabled$:y,...A}),patch:V,actions:{click:()=>{y()||g.update(C=>!C)}},api:{initDone:()=>{D.set(!0)},collapse:()=>{g.set(!1)},expand:()=>{g.set(!0)},toggle:()=>{g.update(C=>!C)}},directives:{collapseDirective:ie(B.directives.directive),accordionItemDirective:f}}}function re(e){const[{closeOthers$:s,onShown$:o,onHidden$:d,itemId$:a,itemAnimated$:c,itemClass$:p,itemDisabled$:b,itemVisible$:S,itemTransition$:g,itemDestroyOnHide$:v,itemBodyClass$:y,itemButtonClass$:A,itemBodyContainerClass$:V,itemHeaderClass$:D,itemHeadingTag$:w,onItemVisibleChange$:H,onItemHidden$:T,onItemShown$:B,slotItemStructure$:C,slotItemBody$:z,slotItemHeader$:q,...G},J]=P(i,e,ne),K={itemId:a,itemClass:p,itemAnimated:c,itemDisabled:b,itemVisible:S,itemTransition:g,itemDestroyOnHide:v,itemBodyClass:y,itemButtonClass:A,itemBodyContainerClass:V,itemHeaderClass:D,itemHeadingTag:w,onItemVisibleChange:H,onItemHidden:T,onItemShown:B,slotItemStructure:C,slotItemBody:z,slotItemHeader:q},I=ee(),O=h(()=>{const t=[];return I().forEach(n=>{n.state$().itemVisible&&t.push(n.state$().itemId)}),t}),k=F(O()[0]),L=h(()=>{s()&&(ae(I(),O(),k()),k.set(O()[0]))}),Q=h(()=>{L()});return{...R({itemsWidget$:I,...G}),patch:J,actions:{},api:{expand:t=>{var n;(n=j(I(),t))==null||n.api.expand()},collapse:t=>{var n;(n=j(I(),t))==null||n.api.collapse()},toggle:t=>{var n;(n=j(I(),t))==null||n.api.toggle()},expandAll:()=>{I().forEach(t=>t.api.expand())},collapseAll:()=>{I().forEach(t=>t.api.collapse())},registerItem:t=>{const n=de(o,d,{config:U(x,X(x,t==null?void 0:t.config),K),props:t==null?void 0:t.props});return n.directives.accordionItemDirective=()=>({destroy:I.register(n)}),n}},directives:{accordionDirective:te(Q)}}}const me=re,_=$.createContext({}),ce=e=>{const s=E(e.widget.directives.collapseDirective),d=new RegExp("^h[1-6]$").test(e.state.itemHeadingTag)?e.state.itemHeadingTag:"h2";return m.jsxs(m.Fragment,{children:[m.jsx(d,{className:`accordion-header ${e.state.itemHeaderClass}`,children:m.jsx("button",{type:"button",id:`${e.state.itemId}-toggle`,onClick:e.widget.actions.click,className:`accordion-button ${e.state.itemButtonClass} ${e.state.itemVisible?"":"collapsed"}`,disabled:e.state.itemDisabled,"aria-controls":`${e.state.itemId}-collapse`,"aria-disabled":e.state.itemDisabled,"aria-expanded":e.state.itemVisible,children:m.jsx(N,{slotContent:e.state.slotItemHeader,props:e})})}),e.state.shouldBeInDOM?m.jsx("div",{className:`accordion-collapse ${e.state.itemBodyContainerClass}`,id:`${e.state.itemId}-collapse`,"aria-labelledby":`${e.state.itemId}-toggle`,ref:s,children:m.jsx("div",{className:`accordion-body ${e.state.itemBodyClass}`,children:m.jsx(N,{slotContent:e.state.slotItemBody,props:e})})}):null]})},le={slotItemStructure:ce},Ce=$.forwardRef(function(s,o){const{registerItem:d}=$.useContext(_),[a,c]=W(d,s,null,{...le}),p={state:a,widget:c},b=E(c.directives.accordionItemDirective);return $.useImperativeHandle(o,()=>c.api,[]),$.useEffect(()=>{c.api.initDone()},[]),m.jsx("div",{className:`accordion-item ${a.itemClass}`,id:a.itemId,ref:b,children:m.jsx(N,{slotContent:a.slotItemStructure,props:p})})}),ye=$.forwardRef(function(s,o){const[d,a]=W(me,s,"accordion");$.useImperativeHandle(o,()=>a.api,[]);const c=E(a.directives.accordionDirective);return m.jsx(_.Provider,{value:a.api,children:m.jsx("div",{className:`accordion ${d.className}`,ref:c,children:s.children})})});export{ye as A,Ce as a};
