import{Z as o,Y as r,a1 as c}from"./AppCommon-CwgpheFC.js";import{e as l}from"./extendWidget-BbVO4Y6F.js";import{a as n,g as p}from"./dom-iY0R3D7u-B4H-kIla.js";import{t as m}from"./stores-Zo5ehpUA.js";import{l as h,c as f}from"./writables-Is1bF1Vt-DduVNjup.js";import{c as T}from"./common-CCxNtFNM-DztJTKMW.js";import{c as b}from"./widget-DZPJugrQ.js";const v={autoHide:!0,delay:5e3},g={autoHide:f,delay:h(0,1/0,{strict:!0})},x=b("toast",u=>{let e;const t=l(T,v,g)(u),s=o(()=>{clearTimeout(e),t.stores.autoHide$()&&(e=setTimeout(()=>t.api.close(),t.stores.delay$()))}),a=n(()=>({attributes:{role:r("alert"),"aria-atomic":r("true"),class:o(()=>t.stores.className$())},classNames:{"au-toast":m,toast:m}})),i=n(()=>({attributes:{type:r("button"),"aria-label":o(()=>t.stores.ariaCloseButtonLabel$())},events:{click:t.api.close}}));return{...t,directives:{...t.directives,autoHideDirective:p(s),bodyDirective:a,closeButtonDirective:i}}}),d={duration:5e3,position:"bottomRight",dismissible:!1};let B=class{#s=0;#e=c([]);toasts=o(()=>this.#e().sort((e,t)=>t.id-e.id).slice(0,this.options().limit));options=c(d);#t=new Map;get timers(){return new Map(this.#t)}constructor(e){this.options.set({...d,...e}),this.options.subscribe(()=>{this.updateToasts()})}addTimer=(e,t=this.options().duration)=>{t>0&&this.#t.set(e,{timeout:setTimeout(()=>this.removeToast(e),t),started:performance.now(),duration:t})};pauseTimer=e=>{if(this.#t.has(e)){const t=this.#t.get(e);t&&t.timeout&&(clearTimeout(t.timeout),t.timeout=null,t.paused=performance.now())}};resumeTimer=e=>{if(this.#t.has(e)){const t=this.#t.get(e);if(t){const a=(t.paused??t.started)-t.started,i=(t.duration??0)-a;this.addTimer(e,i),t.duration=i,t.paused=void 0}}};eventsDirective=n(e=>({events:{pointerenter:()=>this.options().pauseOnHover&&this.pauseTimer(e()),pointerleave:()=>this.options().pauseOnHover&&this.resumeTimer(e())}}));addToast=e=>{const t=e.autoHide??this.options().duration>0;return this.#e.update(s=>[...s,{id:this.#s++,props:e}]),t&&this.addTimer(this.#s-1,e.delay),this.#s-1};removeToast=e=>{this.#t.delete(e),this.#e.update(t=>t.filter(s=>s.id!==e))};updateToasts=()=>{this.options().duration===0&&(this.options().dismissible=!0)};closeAll=()=>{this.#e.set([]),this.#t.clear()}};export{B as T,x as c,d};
