import{a0 as o,$ as v}from"./AppCommon-fKgCL6YI.js";import{c as n,b as i,t as $,e as U}from"./writables-DYGjj5T3-BuJtDJfU.js";import{w as X,s as Y}from"./stores-DBcJ-LkE.js";import{c as T}from"./baseTransitions--AwQDa3X.js";import{d as Z}from"./promise-D-RZVPuv-TlEohQL0.js";import{n as a,d as f,a as k,b as _,m as O,g as ee,v as te,r as oe}from"./dom-BPD8lUxd-BXl1zwuB.js";import{p as A,f as se,r as ie,a as ae,s as ne}from"./focusElement-C974rgaF.js";import{c as re}from"./widget-D35XOKjg.js";const ce=Symbol(),le=Symbol(),de=Symbol(),be={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:a,closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:a,onBeforeClose:a,onVisibleChange:a,onHidden:a,onShown:a,visible:!1},me={animated:n,ariaCloseButtonLabel:$,backdrop:n,backdropClass:$,backdropTransition:i,closeButton:n,closeOnOutsideClick:n,container:U,className:$,modalTransition:i,onBeforeClose:i,onVisibleChange:i,onHidden:i,onShown:i,visible:n},E=oe(),pe=o(()=>E().length>0),ue=o(()=>{pe()?ie():ae()}),ve=o(()=>{ue()}),De=re("modal",H=>{const[{animated$:r,backdrop$:g,backdropTransition$:P,closeOnOutsideClick$:V,container$:p,modalTransition$:M,onBeforeClose$:N,onVisibleChange$:F,onHidden$:I,onShown$:L,ariaCloseButtonLabel$:C,className$:h,backdropClass$:y,visible$:w,...x},c]=X(be,H,me),s=T({props:{transition:M,visible:w,animated:r,animatedOnInit:r,onVisibleChange:F,onHidden:I,onShown:L}}),u=s.stores.visible$,D=T({props:{transition:P,visible:w,animated:r,animatedOnInit:r}}),S=o(()=>s.stores.transitioning$()||g()&&D.stores.transitioning$()),l=o(()=>!S()&&!u()),q=o(()=>!g()||l());let d;const b=e=>{d=e;const t={get result(){return d},set result(m){d=m},cancel:!1};N()(t),!t.cancel&&c({visible:!1})},R=f(A,o(()=>({container:p()}))),W=f(A,o(()=>{const e=p(),t=e?s.stores.element$():void 0;return{container:e,insertBefore:t?.parentElement===e?t:void 0}})),j=v(void 0,()=>E.register(B)),z=o(()=>{s.stores.elementPresent$()&&!l()&&j(),ve()}),G=k(()=>({attributes:{type:v("button"),"aria-label":C},events:{click:()=>b(le)}})),J=k(()=>({attributes:{class:y}})),K=k(()=>({attributes:{class:h,tabIndex:v("-1")},events:{click:e=>{e.currentTarget===e.target&&V()&&b(ce)},keydown:e=>{const{key:t}=e;t==="Escape"&&(b(de),e.stopPropagation())}}})),B={...Y({backdropHidden$:q,container$:p,hidden$:l,transitioning$:S,visible$:u,modalElement$:s.stores.element$,ariaCloseButtonLabel$:C,className$:h,backdropClass$:y,...x}),directives:{modalPortalDirective:R,backdropPortalDirective:W,backdropDirective:O(D.directives.directive,J),modalDirective:O(s.directives.directive,te(ne),ee(z),K,se),closeButtonDirective:G,dialogDirective:f(_((e,t)=>{const m=Q=>{Q?e.showModal():e.close()};return m(t),{update:m}}),u)},patch:c,api:{close:b,async open(){return c({visible:!0}),await Z(l).promise,d},patch:c}};return B});export{ce as a,le as b,De as c,de as m};
