import{n as l,P as a,a9 as g,ab as d,a6 as _,k as p,$ as h,a7 as m,ac as k}from"./AppCommon-CC-VkUgW.js";function q(e){l(e,e.v+1)}const f=[];function S(e,u=a){let t=null;const r=new Set;function i(s){if(g(e,s)&&(e=s,t)){const b=!f.length;for(const n of r)n[1](),f.push(n,e);if(b){for(let n=0;n<f.length;n+=2)f[n][0](f[n+1]);f.length=0}}}function o(s){i(s(e))}function c(s,b=a){const n=[s,b];return r.add(n),r.size===1&&(t=u(i,o)||a),s(e),()=>{r.delete(n),r.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:c}}function w(e){let u;return d(e,t=>u=t)(),u}function $(e){let u,t=k(0),r=0,i=a;function o(){return _()?(p(t),h(()=>{if(r===0){let c=!1;i=e.subscribe(s=>{u=s,c&&q(t)}),c=!0}return r+=1,()=>{r-=1,m().then(()=>{r===0&&i()})}}),u):w(e)}return"set"in e?{get current(){return o()},set current(c){e.set(c)}}:{get current(){return o()}}}export{$ as f,S as w};
