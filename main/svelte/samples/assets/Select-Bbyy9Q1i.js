import{ac as c,ai as we,ad as le,ag as _e,p as Fe,P as se,c as b,R as ce,s as de,d as Ie,b as N,a as ye,t as V,q as pe,M as ke,e as J,n as ue,l as T,g as w,O as ae}from"./AppCommon-BIOVedX1.js";import{a as d}from"./actions-7pTMrPq9.js";import{t as Se}from"./class-DOHDOVt-.js";import{S as me}from"./Slot-DPwmoMlC.js";import{c as $e}from"./config-C5p3ln_V.js";import{c as Ne,o as Te,a as Le,b as Pe}from"./floatingUI-BB0POX-B.js";import{c as Ae}from"./focustrack-DEqzxZlA.js";import{c as Me}from"./navManager-BmRdlxuy.js";import{w as Ee,j as Oe,y as Be,x as He,s as Re,m as We,B as qe,h as oe,a as L,c as Q}from"./directive-CKEccryv-CfUcKfmP.js";import{e as ze}from"./extendWidget-C-nVXE9K.js";const Ue={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:p=>p.querySelectorAll(".au-select-badge,input"),itemIdFn:p=>""+p,onOpenChange:oe,onFilterTextChange:oe,onSelectedChange:oe,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:""};function je(p){const[{id$:_,open$:X,filterText$:Y,items$:O,itemIdFn$:I,onOpenChange$:B,onFilterTextChange$:Z,onSelectedChange$:h,allowedPlacements$:K,navSelector$:n,className$:ee,badgeClassName$:P,ariaLabel$:H,menuClassName$:R,...W},te]=Ee(Ue,p),{selected$:A}=W,y=c(()=>_()??Oe()),x=Be(Y,Z),{hasFocus$:q,directive:C}=Ae(),u=He(B,[X,q],([e,t])=>e&&t),k=c(()=>{const e=new Map,t=I();for(const a of A()){const m=t(a);e.set(m,{item:a,id:t(a),selected:!0})}return e}),z=c(()=>[...k().values()]),f=function(){const e=we(0);return le(e,t=>{const{length:a}=i();t!=null&&(a?t<0?t=a-1:t>=a&&(t=0):t=void 0),e.set(t)})}(),U=c(()=>{const e=new Map;if(u()){const t=k(),a=I();for(const m of O()){const D=a(m);e.set(D,{item:m,id:D,selected:t.has(D)})}}return e}),i=c(()=>u()?[...U().values()]:[]),s=c(()=>{const e=i(),t=f();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:l,referenceDirective:o},stores:{placement$:g}}=Ne({props:{computePositionOptions:le(c(()=>({middleware:[Te(5),Le({allowedPlacements:K()}),Pe()]})))}}),{directive:v,refreshElements:M,focusFirst:S,focusLast:ie,focusLeft:j,focusRight:$}=Me(),E=c(()=>({keys:{Home:S,End:ie,ArrowLeft:j,ArrowRight:$},selector:n()})),re=(e,t)=>{const a=e.target;M(),r.api.unselect(t),a instanceof HTMLElement&&setTimeout(()=>{j({event:e,referenceElement:a})||$({event:e,referenceElement:a})}),e.preventDefault()},ge=L(()=>({attributes:{role:"combobox","aria-haspopup":"listbox","aria-expanded":c(()=>`${u()}`),"aria-controls":c(()=>`${y()}-menu`)}})),ve=L(e=>({attributes:{tabindex:-1,class:P},classNames:{"au-select-badge":!0},events:{keydown:t=>{let a=!1;switch(t.key){case"Backspace":case"Delete":{re(t,e().item),a=!0;break}}a&&t.preventDefault()}}})),fe=L(()=>({attributes:{role:"listbox",id:c(()=>`${y()}-menu`),"data-popper-placement":g,class:R},events:{mousedown:e=>e.preventDefault()}})),be=L(e=>({attributes:{role:"option","aria-selected":c(()=>`${e().selected}`),style:"cursor: pointer"},classNames:{"au-select-item":!0,selected:c(()=>e().selected)},events:{click:()=>r.api.toggleItem(e().item)}})),he=L(()=>({attributes:{id:y(),type:"text","aria-label":H(),"aria-autocomplete":"list",autocorrect:"off",autocapitalize:"none",autocomplete:"off"},classNames:{"au-select-input":!0},events:{input:e=>{const t=e.target.value;_e(()=>{u.set(t!=null&&t!==""),x.set(t)})},keydown:({ctrlKey:e,key:t,preventDefault:a})=>{let m=!0;switch(t){case"ArrowDown":{u()?e?r.api.highlightLast():r.api.highlightNext():(r.api.open(),r.api.highlightFirst());break}case"ArrowUp":e?r.api.highlightFirst():r.api.highlightPrevious();break;case"Enter":{const D=s();D&&r.api.toggleItem(D.item);break}case"Escape":u.set(!1);break;default:m=!1}m&&a()}}})),xe=L(e=>({events:{click:t=>{re(t,e().item)}}})),r={...Re({id$:y,visibleItems$:i,highlighted$:s,open$:u,selectedContexts$:z,filterText$:x,placement$:g,className$:ee,badgeClassName$:P,ariaLabel$:H,menuClassName$:R,...W}),patch:te,api:{clear(){A.set([])},select(e){r.api.toggleItem(e,!0)},unselect(e){r.api.toggleItem(e,!1)},toggleItem(e,t){const a=I(),m=a(e),G=k().has(m);t==null&&(t=!G),!(t&&!U().has(m)||!t&&!G)&&A.update(F=>{var ne;if(F=[...F],t&&!G)F.push(e);else if(!t&&G){const Ce=F.findIndex(De=>a(De)===m);F.splice(Ce,1)}return(ne=h())==null||ne(F),F})},clearText(){},highlight(e){const t=i().findIndex(a=>a.item===e);f.set(t===-1?void 0:t)},highlightFirst(){f.set(0)},highlightPrevious(){f.update(e=>e!=null?e-1:-1)},highlightNext(){f.update(e=>e!=null?e+1:1/0)},highlightLast(){f.set(-1)},open:()=>r.api.toggle(!0),close:()=>r.api.toggle(!1),toggle(e){u.update(t=>e??!t)}},directives:{hasFocusDirective:C,floatingDirective:l,referenceDirective:o,inputContainerDirective:We(qe(v,E),ge),badgeAttributesDirective:ve,menuAttributesDirective:fe,itemAttributesDirective:be,inputDirective:he,badgeCloseButtonDirective:xe}};return r}const Ge={badgeLabel:({itemContext:p})=>p.item,itemLabel:({itemContext:p})=>p.item},Je=ze(je,Ge),Qe=Je;var Ve=V("<div><!></div>"),Xe=V("<li><!></li>"),Ye=V("<ul></ul>"),Ze=V("<div><div><!> <input></div> <!></div>");function ct(p,_){Fe(_,!0);const X=(i,s)=>{let l=()=>s==null?void 0:s().itemContext;var o=pe();b(()=>ue(o,l().item)),N(i,o)},Y=(i,s)=>{let l=()=>s==null?void 0:s().itemContext;var o=pe();b(()=>ue(o,l().item)),N(i,o)};let O=se(_,"open",15,!1),I=se(_,"filterText",15),B=se(_,"selected",15),Z=ke(_,["$$slots","$$events","$$legacy","open","filterText","selected"]);const h=$e({factory:Qe,widgetName:"select",get props(){return{...Z,open:O(),filterText:I(),selected:B()}},enablePatchChanged:!0,defaultConfig:{badgeLabel:X,itemLabel:Y},events:{onOpenChange(i){O(i)},onSelectedChange:i=>{B(i)},onFilterTextChange:i=>{I(i)}}}),K=h.api,{state:n,directives:{floatingDirective:ee,hasFocusDirective:P,referenceDirective:H,inputContainerDirective:R,badgeAttributesDirective:W,menuAttributesDirective:te,itemAttributesDirective:A,inputDirective:y}}=h;var x=Ze();let q;b(()=>q=T(x,q,{}));var C=J(x);let u;b(()=>u=T(C,u,{}));var k=J(C);ce(k,17,()=>n.selectedContexts,i=>i.id,(i,s)=>{var l=Ve();let o;b(()=>o=T(l,o,{}));var g=J(l),v=ae(()=>({state:n,directives:h.directives,api:h.api,itemContext:w(s)}));me(g,{get content(){return n.badgeLabel},get props(){return w(v)}}),d(l,(M,S)=>W(M,S),()=>w(s)),N(i,l)});var z=de(k,2);let f;b(()=>f=T(z,f,{value:n.filterText}));var U=de(C,2);return Ie(U,()=>n.open&&n.visibleItems.length>0,i=>{var s=Ye();let l;b(()=>l=T(s,l,{})),ce(s,21,()=>n.visibleItems,o=>o.id,(o,g)=>{var v=Xe();const M=ae(()=>w(g)===n.highlighted);let S;b(()=>S=T(v,S,{}));var ie=J(v),j=ae(()=>({state:n,directives:h.directives,api:h.api,itemContext:w(g)}));me(ie,{get content(){return n.itemLabel},get props(){return w(j)}}),b(()=>Se(v,"text-bg-primary",w(M))),d(v,($,E)=>Q($,E),()=>"dropdown-item position-relative"),d(v,($,E)=>A($,E),()=>w(g)),N(o,v)}),d(s,o=>P(o)),d(s,o=>ee(o)),d(s,o=>te(o)),d(s,(o,g)=>Q(o,g),()=>"dropdown-menu show"),N(i,s)}),d(z,i=>y(i)),d(C,i=>P(i)),d(C,i=>R(i)),d(C,(i,s)=>Q(i,s),()=>"d-flex align-items-center flex-wrap gap-1"),d(x,i=>H(i)),d(x,(i,s)=>Q(i,s),()=>"au-select dropdown border border-1 p-1 mb-3 d-block "+n.className),N(p,x),ye({api:K})}export{ct as S};
