import{a0 as d,ae as we,a1 as ae,$ as f,af as Fe,a as _e,O as V,K as Ie,f as z,e as y,h as R,Q as se,g as F,d as L,s as oe,j as ke,p as ye,L as X,q as ne,t as ce,k as le}from"./AppCommon-C3njszSs.js";import{a as p}from"./actions-D_tXn74T.js";import{S as re}from"./Slot-YqfKOSXr.js";import{c as Se}from"./config-Nkjhrqa6.js";import{c as Le,o as Te,a as Ne,b as Ae}from"./floatingUI-BJOvrf-b.js";import{c as Pe}from"./focustrack-C3SMhsBU.js";import{c as Me}from"./navManager-BKumOyfj.js";import{n as Y,g as Ee,m as Oe,a as S,o as He,c as q}from"./dom-BhJG5nY--BK8Qu-np.js";import{w as We,e as Be,d as Re,s as qe,t as Z}from"./stores-D502qs93.js";import{c as ze}from"./widget-Byox2iix.js";import{e as Ue}from"./extendWidget-Dcy1Uq-c.js";const je={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:n=>n.querySelectorAll(".au-select-badge,input"),itemIdFn:n=>""+n,onOpenChange:Y,onFilterTextChange:Y,onSelectedChange:Y,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:""},Qe=ze("select",n=>{const[{id$:u,open$:C,filterText$:v,items$:A,itemIdFn$:T,onOpenChange$:D,onFilterTextChange$:U,onSelectedChange$:l,allowedPlacements$:j,navSelector$:P,className$:Q,badgeClassName$:M,ariaLabel$:E,menuClassName$:O,...H},G]=We(je,n),{selected$:x}=H,m=d(()=>u()??Ee()),N=Be(v,U),{hasFocus$:W,directive:J}=Pe(),h=Re(D,[C,W],([e,t])=>e&&t),i=d(()=>{const e=new Map,t=T();for(const s of x()){const g=t(s);e.set(g,{item:s,id:t(s),selected:!0})}return e}),o=d(()=>[...i().values()]),a=function(){const e=we(0);return ae(e,t=>{const{length:s}=r();t!=null&&(s?t<0?t=s-1:t>=s&&(t=0):t=void 0),e.set(t)})}(),b=d(()=>{const e=new Map;if(h()){const t=i(),s=T();for(const g of A()){const w=s(g);e.set(w,{item:g,id:w,selected:t.has(w)})}}return e}),r=d(()=>h()?[...b().values()]:[]),I=d(()=>{const e=r(),t=a();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:K,referenceDirective:$},stores:{placement$:k}}=Le({props:{computePositionOptions:ae(d(()=>({middleware:[Te(5),Ne({allowedPlacements:j()}),Ae()]})))}}),{directive:de,refreshElements:pe,focusFirst:ue,focusLast:me,focusLeft:ee,focusRight:te}=Me(),ge=d(()=>({keys:{Home:ue,End:me,ArrowLeft:ee,ArrowRight:te},selector:P()})),ie=(e,t)=>{const s=e.target;pe(),c.api.unselect(t),s instanceof HTMLElement&&setTimeout(()=>{ee({event:e,referenceElement:s})||te({event:e,referenceElement:s})}),e.preventDefault()},fe=S(()=>({attributes:{role:f("combobox"),"aria-haspopup":f("listbox"),"aria-expanded":d(()=>`${h()}`),"aria-controls":d(()=>`${m()}-menu`)}})),ve=S(e=>({attributes:{tabindex:f(-1),class:M},classNames:{"au-select-badge":Z},events:{keydown:t=>{let s=!1;switch(t.key){case"Backspace":case"Delete":{ie(t,e().item),s=!0;break}}s&&t.preventDefault()}}})),he=S(()=>({attributes:{role:f("listbox"),id:d(()=>`${m()}-menu`),"data-popper-placement":k,class:O},events:{mousedown:e=>e.preventDefault()}})),be=S(e=>({attributes:{role:f("option"),"aria-selected":d(()=>`${e().selected}`),style:f("cursor: pointer")},classNames:{"au-select-item":Z,selected:d(()=>e().selected)},events:{click:()=>c.api.toggleItem(e().item)}})),xe=S(()=>({attributes:{id:m,type:f("text"),"aria-label":E,"aria-autocomplete":f("list"),autocorrect:f("off"),autocapitalize:f("none"),autocomplete:f("off")},classNames:{"au-select-input":Z},events:{input:e=>{const t=e.target.value;Fe(()=>{h.set(t!=null&&t!==""),N.set(t)})},keydown:({ctrlKey:e,key:t,preventDefault:s})=>{let g=!0;switch(t){case"ArrowDown":{h()?e?c.api.highlightLast():c.api.highlightNext():(c.api.open(),c.api.highlightFirst());break}case"ArrowUp":e?c.api.highlightFirst():c.api.highlightPrevious();break;case"Enter":{const w=I();w&&c.api.toggleItem(w.item);break}case"Escape":h.set(!1);break;default:g=!1}g&&s()}}})),$e=S(e=>({events:{click:t=>{ie(t,e().item)}}})),c={...qe({id$:m,visibleItems$:r,highlighted$:I,open$:h,selectedContexts$:o,filterText$:N,placement$:k,className$:Q,badgeClassName$:M,ariaLabel$:E,menuClassName$:O,...H}),patch:G,api:{clear(){x.set([])},select(e){c.api.toggleItem(e,!0)},unselect(e){c.api.toggleItem(e,!1)},toggleItem(e,t){const s=T(),g=s(e),B=i().has(g);t==null&&(t=!B),!(t&&!b().has(g)||!t&&!B)&&x.update(_=>{if(_=[..._],t&&!B)_.push(e);else if(!t&&B){const Ce=_.findIndex(De=>s(De)===g);_.splice(Ce,1)}return l()?.(_),_})},clearText(){},highlight(e){const t=r().findIndex(s=>s.item===e);a.set(t===-1?void 0:t)},highlightFirst(){a.set(0)},highlightPrevious(){a.update(e=>e!=null?e-1:-1)},highlightNext(){a.update(e=>e!=null?e+1:1/0)},highlightLast(){a.set(-1)},open:()=>c.api.toggle(!0),close:()=>c.api.toggle(!1),toggle(e){h.update(t=>e??!t)}},directives:{hasFocusDirective:J,floatingDirective:K,referenceDirective:$,inputContainerDirective:Oe(He(de,ge),fe),badgeAttributesDirective:ve,menuAttributesDirective:he,itemAttributesDirective:be,inputDirective:xe,badgeCloseButtonDirective:$e}};return c}),Ge={badgeLabel:({itemContext:n})=>n.item,itemLabel:({itemContext:n})=>n.item},Je=Ue(Qe,Ge),Ke=Je,Ve=(n,u)=>{let C=()=>u?.().itemContext;var v=ne();ce(()=>le(v,C().item)),L(n,v)},Xe=(n,u)=>{let C=()=>u?.().itemContext;var v=ne();ce(()=>le(v,C().item)),L(n,v)};var Ye=z("<div><!></div>"),Ze=z("<li><!></li>"),et=z("<ul></ul>"),tt=z("<div><div><!> <input/></div> <!></div>");function mt(n,u){_e(u,!0);let C=V(u,"open",15,!1),v=V(u,"filterText",15),A=V(u,"selected",15),T=Ie(u,["$$slots","$$events","$$legacy","open","filterText","selected"]);const D=Se(Ke,{get props(){return{...T,open:C(),filterText:v(),selected:A()}},defaultConfig:{badgeLabel:Ve,itemLabel:Xe},events:{onOpenChange(i){C(i)},onSelectedChange:i=>{A(i)},onFilterTextChange:i=>{v(i)}}}),U=D.api,{state:l,directives:{floatingDirective:j,hasFocusDirective:P,referenceDirective:Q,inputContainerDirective:M,badgeAttributesDirective:E,menuAttributesDirective:O,itemAttributesDirective:H,inputDirective:G}}=D;var x=tt();y(x,i=>({...i}),[()=>({})]);var m=R(x);y(m,i=>({...i}),[()=>({})]);var N=R(m);se(N,17,()=>l.selectedContexts,i=>i.id,(i,o)=>{var a=Ye();y(a,r=>({...r}),[()=>({})]);var b=R(a);{let r=X(()=>({state:l,directives:D.directives,api:D.api,itemContext:F(o)}));re(b,{get content(){return l.badgeLabel},get props(){return F(r)}})}p(a,(r,I)=>E?.(r,I),()=>F(o)),L(i,a)});var W=oe(N,2);y(W,i=>({value:l.filterText,...i}),[()=>({})]),p(W,i=>G?.(i)),p(m,i=>P?.(i)),p(m,i=>M?.(i)),p(m,(i,o)=>q?.(i,o),()=>"d-flex align-items-center flex-wrap gap-1");var J=oe(m,2);{var h=i=>{var o=et();y(o,a=>({...a}),[()=>({})]),se(o,21,()=>l.visibleItems,a=>a.id,(a,b)=>{var r=Ze();const I=X(()=>F(b)===l.highlighted);y(r,$=>({...$}),[()=>({})]);var K=R(r);{let $=X(()=>({state:l,directives:D.directives,api:D.api,itemContext:F(b)}));re(K,{get content(){return l.itemLabel},get props(){return F($)}})}p(r,($,k)=>q?.($,k),()=>["dropdown-item position-relative",{"text-bg-primary":F(I)}]),p(r,($,k)=>H?.($,k),()=>F(b)),L(a,r)}),p(o,a=>P?.(a)),p(o,a=>j?.(a)),p(o,a=>O?.(a)),p(o,(a,b)=>q?.(a,b),()=>"dropdown-menu show"),L(i,o)};ke(J,i=>{l.open&&l.visibleItems.length>0&&i(h)})}return p(x,i=>Q?.(i)),p(x,(i,o)=>q?.(i,o),()=>"au-select dropdown border border-1 p-1 mb-3 d-block "+l.className),L(n,x),ye({api:U})}export{mt as S};
