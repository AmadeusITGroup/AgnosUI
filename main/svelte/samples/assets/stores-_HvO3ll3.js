import{a8 as V,H as l,a9 as k,aa as g,a7 as b,a0 as y,I as h,ab as O,ac as D}from"./AppCommon-FSNPofIP.js";import{i as p}from"./func-DR0n-ShK-fOTgS_tI.js";const A=t=>({actions:t.actions,api:t.api,directives:t.directives,state$:t.state$,stores:t.stores}),m=Symbol();function W(t){return function(s){g(()=>{var r;for(const[o,e]of Object.entries(s??{}))(r=t[`${o}$`])==null||r.set(e)})}}function j(t,s){if(t===s)return null;let r=!1;const o={},e=new Set([...Object.keys(t),...Object.keys(s)]);for(const n of e){const a=s[n];t[n]!==a&&(o[n]=a,r=!0)}return r?o:null}function $(t,s=y(void 0),r={},o=h(void 0)){const{normalizeValue:e=p,equal:n=Object.is}=r,a=()=>t,i=(c,u=a)=>{const f=c===void 0?void 0:e(c);return f===m?(console.error("Not using invalid value",c),u()):f===void 0?u():f},d=l(()=>i(s()),{equal:n}),S=l(()=>i(o(),d),{equal:n});return b(S,c=>{if(c!==void 0){const u=e(c);if(u===m){console.error("Not setting invalid value",c);return}c=u}o.set(c)})}const v=t=>!!(t&&typeof t=="function"&&"subscribe"in t),z=t=>v(t)?t:y(t),I=t=>v(t)?t:h(t),N=(t,s)=>{const r={};if(s){const o=v(s);for(const e of t)r[e]=o?l(()=>s()[e]):z(s[e])}return r},E=(t,s,r)=>{const o={};for(const e of t){const n=s==null?void 0:s[e],a=r==null?void 0:r[e];o[e]=n&&a?l(()=>n()??a()):n||a}return o},q=(t,s,r)=>{const o={},e=Object.keys(t),n=N(e,s==null?void 0:s.config),a=s==null?void 0:s.props;for(const i of e){const d=a==null?void 0:a[i];o[`${i}$`]=$(t[i],n[i],r==null?void 0:r[i],I(d))}return o},L=(t,s,r)=>{const o=q(t,s,r);return[o,W(o)]},R=t=>{const s=[],r=[],o={};for(const e of Object.keys(t))if(e.endsWith("$")){const n=t[e];s.push(e.substring(0,e.length-1)),r.push(n),o[e]=V(n)}return{stores:o,state$:l(()=>{const e=r.map(k),n={};return s.forEach((a,i)=>{n[a]=e[i]}),n})}},U=(t,s,r=e=>e[0],o=(e,n)=>n===e)=>{let e=s[0]();return b(O(s,{derive(n){const a=r(n),i=!o(n[0],a);return i&&s[0].set(a),(i||!o(e,a))&&(e=a,t()(a)),a},equal:o}),s[0].set.bind(s[0]))},_=(t,s,r=p,o=D)=>b(l(()=>r(t()),{equal:o}),e=>{const n=r(e);o(t(),n)||(t.set(n),s()(n))});export{m as I,z as a,U as b,_ as c,q as d,j as f,E as m,N as n,R as s,A as t,L as w};
