import{a8 as v,G as u,a9 as O,aa as D,a7 as b,a0 as h,H as S,ab as W,ac as $}from"./AppCommon-wxtIAwqp.js";import{i as V}from"./func-tK0QDe5R.js";const L=e=>({actions:e.actions,api:e.api,directives:e.directives,state$:e.state$,stores:e.stores}),y=Symbol();function z(e){return function(t){D(()=>{var n;for(const[a,s]of Object.entries(t??{}))(n=e[`${a}$`])==null||n.set(s)})}}function R(e,t){if(e===t)return null;let n=!1;const a={},s=new Set([...Object.keys(e),...Object.keys(t)]);for(const r of s){const o=t[r];e[r]!==o&&(a[r]=o,n=!0)}return n?a:null}function N(e,t=h(void 0),n={},a=S(void 0)){const{normalizeValue:s=V,equal:r=Object.is}=n,o=()=>e,c=(i,l=o)=>{const f=i===void 0?void 0:s(i);return f===y?(console.error("Not using invalid value",i),l()):f===void 0?l():f},d=u(()=>c(t()),{equal:r}),k=u(()=>c(a(),d),{equal:r});return b(k,i=>{if(i!==void 0){const l=s(i);if(l===y){console.error("Not setting invalid value",i);return}i=l}a.set(i)})}const m=e=>!!(e&&typeof e=="function"&&"subscribe"in e),I=e=>m(e)?e:h(e),P=e=>m(e)?e:S(e),w=(e,t)=>{const n={};if(t){const a=m(t);for(const s of e)n[s]=a?u(()=>t()[s]):I(t[s])}return n},U=(e,t,n)=>{const a={};for(const s of e){const r=t==null?void 0:t[s],o=n==null?void 0:n[s];a[s]=r&&o?u(()=>r()??o()):r||o}return a},A=(e,t,n)=>{const a={},s=Object.keys(e),r=w(s,t==null?void 0:t.config),o=t==null?void 0:t.props;for(const c of s){const d=o==null?void 0:o[c];a[`${c}$`]=N(e[c],r[c],n==null?void 0:n[c],P(d))}return a},F=(e,t,n)=>{const a=A(e,t,n);return[a,z(a)]},G=e=>{const t=[],n=[],a={};for(const s of Object.keys(e))if(s.endsWith("$")){const r=e[s];t.push(s.substring(0,s.length-1)),n.push(r),a[s]=v(r)}return{stores:a,state$:u(()=>{const s=n.map(O),r={};return t.forEach((o,c)=>{r[o]=s[c]}),r})}},H=(e,t,n=s=>s[0],a=(s,r)=>r===s)=>{let s=t[0]();return b($(t,{derive(r){const o=n(r),c=!a(r[0],o);return c&&t[0].set(o),(c||!a(s,o))&&(s=o,e()(o)),o},equal:a}),t[0].set.bind(t[0]))},_=(e,t,n=V,a=W)=>b(u(()=>n(e()),{equal:a}),s=>{const r=n(s);a(e(),r)||(e.set(r),t()(r))});export{y as I,I as a,H as b,_ as c,A as d,R as f,U as m,w as n,G as s,L as t,F as w};
