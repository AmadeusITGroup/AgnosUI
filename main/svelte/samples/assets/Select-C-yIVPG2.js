import{a0 as l,af as we,a1 as ae,$ as f,a2 as Fe,a as _e,O as V,K as Ie,f as z,e as y,h as R,Q as se,g as _,d as L,s as oe,j as ke,p as ye,L as X,q as ne,t as ce,k as le}from"./AppCommon-D-Irf_br.js";import{a as d}from"./actions-pAf8lVTc.js";import{S as re}from"./Slot-Cev775w6.js";import{c as Se}from"./config-DpJbrCpM.js";import{c as Le,o as Te,a as Ne,b as Ae}from"./floatingUI-C09R3XjG.js";import{c as Pe}from"./focustrack-BgunoqPf.js";import{c as Me}from"./navManager-D6KB8EIX.js";import{n as Y,g as Ee,m as Oe,a as S,o as He,c as q}from"./dom-Bcg9ORcA-CPWV9YZz.js";import{w as We,e as Be,d as Re,s as qe,t as Z}from"./stores-CNuHRGye.js";import{c as ze}from"./widget-ccL6PuC2.js";import{e as Ue}from"./extendWidget-DIN1MyrK.js";const je={id:void 0,ariaLabel:"Select",open:!1,disabled:!1,items:[],filterText:"",loading:!1,selected:[],navSelector:r=>r.querySelectorAll(".au-select-badge,input"),itemIdFn:r=>""+r,onOpenChange:Y,onFilterTextChange:Y,onSelectedChange:Y,allowedPlacements:["bottom-start","top-start","bottom-end","top-end"],className:"",menuClassName:"",menuItemClassName:"",badgeClassName:""},Qe=ze("select",r=>{const[{id$:u,open$:D,filterText$:v,items$:A,itemIdFn$:T,onOpenChange$:w,onFilterTextChange$:U,onSelectedChange$:c,allowedPlacements$:j,navSelector$:P,className$:Q,badgeClassName$:M,ariaLabel$:E,menuClassName$:O,...H},G]=We(je,r),{selected$:$}=H,m=l(()=>u()??Ee()),N=Be(v,U),{hasFocus$:W,directive:J}=Pe(),h=Re(w,[D,W],([e,t])=>e&&t),i=l(()=>{const e=new Map,t=T();for(const s of $()){const g=t(s);e.set(g,{item:s,id:t(s),selected:!0})}return e}),o=l(()=>[...i().values()]),a=(function(){const e=we(0);return ae(e,t=>{const{length:s}=p();t!=null&&(s?t<0?t=s-1:t>=s&&(t=0):t=void 0),e.set(t)})})(),b=l(()=>{const e=new Map;if(h()){const t=i(),s=T();for(const g of A()){const F=s(g);e.set(F,{item:g,id:F,selected:t.has(F)})}}return e}),p=l(()=>h()?[...b().values()]:[]),x=l(()=>{const e=p(),t=a();return e.length&&t!=null?e[t]:void 0}),{directives:{floatingDirective:K,referenceDirective:C},stores:{placement$:k}}=Le({props:{computePositionOptions:ae(l(()=>({middleware:[Te(5),Ne({allowedPlacements:j()}),Ae()]})))}}),{directive:de,refreshElements:pe,focusFirst:ue,focusLast:me,focusLeft:ee,focusRight:te}=Me(),ge=l(()=>({keys:{Home:ue,End:me,ArrowLeft:ee,ArrowRight:te},selector:P()})),ie=(e,t)=>{const s=e.target;pe(),n.api.unselect(t),s instanceof HTMLElement&&setTimeout(()=>{ee({event:e,referenceElement:s})||te({event:e,referenceElement:s})}),e.preventDefault()},fe=S(()=>({attributes:{role:f("combobox"),"aria-haspopup":f("listbox"),"aria-expanded":l(()=>`${h()}`),"aria-controls":l(()=>`${m()}-menu`)}})),ve=S(e=>({attributes:{tabindex:f(-1),class:M},classNames:{"au-select-badge":Z},events:{keydown:t=>{let s=!1;switch(t.key){case"Backspace":case"Delete":{ie(t,e().item),s=!0;break}}s&&t.preventDefault()}}})),he=S(()=>({attributes:{role:f("listbox"),id:l(()=>`${m()}-menu`),"data-popper-placement":k,class:O},events:{mousedown:e=>e.preventDefault()}})),be=S(e=>({attributes:{role:f("option"),"aria-selected":l(()=>`${e().selected}`),style:f("cursor: pointer")},classNames:{"au-select-item":Z,selected:l(()=>e().selected)},events:{click:()=>n.api.toggleItem(e().item)}})),xe=S(()=>({attributes:{id:m,type:f("text"),"aria-label":E,"aria-autocomplete":f("list"),autocorrect:f("off"),autocapitalize:f("none"),autocomplete:f("off")},classNames:{"au-select-input":Z},events:{input:e=>{const t=e.target.value;Fe(()=>{h.set(t!=null&&t!==""),N.set(t)})},keydown:({ctrlKey:e,key:t,preventDefault:s})=>{let g=!0;switch(t){case"ArrowDown":{h()?e?n.api.highlightLast():n.api.highlightNext():(n.api.open(),n.api.highlightFirst());break}case"ArrowUp":e?n.api.highlightFirst():n.api.highlightPrevious();break;case"Enter":{const F=x();F&&n.api.toggleItem(F.item);break}case"Escape":h.set(!1);break;default:g=!1}g&&s()}}})),$e=S(e=>({events:{click:t=>{ie(t,e().item)}}})),n={...qe({id$:m,visibleItems$:p,highlighted$:x,open$:h,selectedContexts$:o,filterText$:N,placement$:k,className$:Q,badgeClassName$:M,ariaLabel$:E,menuClassName$:O,...H}),patch:G,api:{clear(){$.set([])},select(e){n.api.toggleItem(e,!0)},unselect(e){n.api.toggleItem(e,!1)},toggleItem(e,t){const s=T(),g=s(e),B=i().has(g);t==null&&(t=!B),!(t&&!b().has(g)||!t&&!B)&&$.update(I=>{if(I=[...I],t&&!B)I.push(e);else if(!t&&B){const Ce=I.findIndex(De=>s(De)===g);I.splice(Ce,1)}return c()?.(I),I})},clearText(){},highlight(e){const t=p().findIndex(s=>s.item===e);a.set(t===-1?void 0:t)},highlightFirst(){a.set(0)},highlightPrevious(){a.update(e=>e!=null?e-1:-1)},highlightNext(){a.update(e=>e!=null?e+1:1/0)},highlightLast(){a.set(-1)},open:()=>n.api.toggle(!0),close:()=>n.api.toggle(!1),toggle(e){h.update(t=>e??!t)}},directives:{hasFocusDirective:J,floatingDirective:K,referenceDirective:C,inputContainerDirective:Oe(He(de,ge),fe),badgeAttributesDirective:ve,menuAttributesDirective:he,itemAttributesDirective:be,inputDirective:xe,badgeCloseButtonDirective:$e}};return n}),Ge={badgeLabel:({itemContext:r})=>r.item,itemLabel:({itemContext:r})=>r.item},Je=Ue(Qe,Ge),Ke=Je,Ve=(r,u)=>{let D=()=>u?.().itemContext;var v=ne();ce(()=>le(v,D().item)),L(r,v)},Xe=(r,u)=>{let D=()=>u?.().itemContext;var v=ne();ce(()=>le(v,D().item)),L(r,v)};var Ye=z("<div><!></div>"),Ze=z("<li><!></li>"),et=z("<ul></ul>"),tt=z("<div><div><!> <input/></div> <!></div>");function mt(r,u){_e(u,!0);let D=V(u,"open",15,!1),v=V(u,"filterText",15),A=V(u,"selected",15),T=Ie(u,["$$slots","$$events","$$legacy","open","filterText","selected"]);const w=Se(Ke,{get props(){return{...T,open:D(),filterText:v(),selected:A()}},defaultConfig:{badgeLabel:Ve,itemLabel:Xe},events:{onOpenChange(i){D(i)},onSelectedChange:i=>{A(i)},onFilterTextChange:i=>{v(i)}}}),U=w.api,{state:c,directives:{floatingDirective:j,hasFocusDirective:P,referenceDirective:Q,inputContainerDirective:M,badgeAttributesDirective:E,menuAttributesDirective:O,itemAttributesDirective:H,inputDirective:G}}=w;var $=tt();y($,i=>({...i}),[()=>({})]);var m=R($);y(m,i=>({...i}),[()=>({})]);var N=R(m);se(N,17,()=>c.selectedContexts,i=>i.id,(i,o)=>{var a=Ye();y(a,p=>({...p}),[()=>({})]);var b=R(a);{let p=X(()=>({state:c,directives:w.directives,api:w.api,itemContext:_(o)}));re(b,{get content(){return c.badgeLabel},get props(){return _(p)}})}d(a,(p,x)=>E?.(p,x),()=>_(o)),L(i,a)});var W=oe(N,2);y(W,i=>({value:c.filterText,...i}),[()=>({})]),d(W,i=>G?.(i)),d(m,i=>P?.(i)),d(m,i=>M?.(i)),d(m,(i,o)=>q?.(i,o),()=>"d-flex align-items-center flex-wrap gap-1");var J=oe(m,2);{var h=i=>{var o=et();y(o,a=>({...a}),[()=>({})]),se(o,21,()=>c.visibleItems,a=>a.id,(a,b)=>{const p=X(()=>_(b)===c.highlighted);var x=Ze();y(x,C=>({...C}),[()=>({})]);var K=R(x);{let C=X(()=>({state:c,directives:w.directives,api:w.api,itemContext:_(b)}));re(K,{get content(){return c.itemLabel},get props(){return _(C)}})}d(x,(C,k)=>q?.(C,k),()=>["dropdown-item position-relative",{"text-bg-primary":_(p)}]),d(x,(C,k)=>H?.(C,k),()=>_(b)),L(a,x)}),d(o,a=>P?.(a)),d(o,a=>j?.(a)),d(o,a=>O?.(a)),d(o,(a,b)=>q?.(a,b),()=>"dropdown-menu show"),L(i,o)};ke(J,i=>{c.open&&c.visibleItems.length>0&&i(h)})}return d($,i=>Q?.(i)),d($,(i,o)=>q?.(i,o),()=>"au-select dropdown border border-1 p-1 mb-3 d-block "+c.className),L(r,$),ye({api:U})}export{mt as S};
