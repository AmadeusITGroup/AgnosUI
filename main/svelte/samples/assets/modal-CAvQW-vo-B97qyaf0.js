import{a0 as o,$ as v}from"./AppCommon-eHSu19bS.js";import{c as n,b as i,t as $,e as U}from"./writables-e0tyaQpe-d1RfmBbJ.js";import{w as X,s as Y}from"./stores-BZYYu7K_.js";import{c as T}from"./baseTransitions-DCUY4Sc8.js";import{d as Z}from"./promise-Y53vc4Ia-BK40JIGq.js";import{n as a,d as f,r as _,a as k,m as O,b as ee,f as te,u as oe}from"./dom-Bcg9ORcA-CVNNjcJh.js";import{p as A,f as se,s as ie,r as ae,a as ne}from"./focusElement-a_BRidor.js";import{c as re}from"./widget-DYj0ZdLE.js";const ce=Symbol(),le=Symbol(),de=Symbol(),be={animated:!0,ariaCloseButtonLabel:"Close",backdrop:!0,backdropClass:"",backdropTransition:a,closeButton:!0,closeOnOutsideClick:!0,container:typeof window<"u"?document.body:null,className:"",modalTransition:a,onBeforeClose:a,onVisibleChange:a,onHidden:a,onShown:a,visible:!1},me={animated:n,ariaCloseButtonLabel:$,backdrop:n,backdropClass:$,backdropTransition:i,closeButton:n,closeOnOutsideClick:n,container:U,className:$,modalTransition:i,onBeforeClose:i,onVisibleChange:i,onHidden:i,onShown:i,visible:n},E=_(),pe=o(()=>E().length>0),ue=o(()=>{pe()?ae():ne()}),ve=o(()=>{ue()}),De=re("modal",H=>{const[{animated$:r,backdrop$:C,backdropTransition$:P,closeOnOutsideClick$:V,container$:p,modalTransition$:M,onBeforeClose$:N,onVisibleChange$:F,onHidden$:I,onShown$:L,ariaCloseButtonLabel$:g,className$:h,backdropClass$:y,visible$:w,...x},c]=X(be,H,me),s=T({props:{transition:M,visible:w,animated:r,animatedOnInit:r,onVisibleChange:F,onHidden:I,onShown:L}}),u=s.stores.visible$,D=T({props:{transition:P,visible:w,animated:r,animatedOnInit:r}}),S=o(()=>s.stores.transitioning$()||C()&&D.stores.transitioning$()),l=o(()=>!S()&&!u()),q=o(()=>!C()||l());let d;const b=e=>{d=e;const t={get result(){return d},set result(m){d=m},cancel:!1};N()(t),!t.cancel&&c({visible:!1})},R=f(A,o(()=>({container:p()}))),W=f(A,o(()=>{const e=p(),t=e?s.stores.element$():void 0;return{container:e,insertBefore:t?.parentElement===e?t:void 0}})),j=v(void 0,()=>E.register(B)),z=o(()=>{s.stores.elementPresent$()&&!l()&&j(),ve()}),G=k(()=>({attributes:{type:v("button"),"aria-label":g},events:{click:()=>b(le)}})),J=k(()=>({attributes:{class:y}})),K=k(()=>({attributes:{class:h,tabIndex:v("-1")},events:{click:e=>{e.currentTarget===e.target&&V()&&b(ce)},keydown:e=>{const{key:t}=e;switch(t){case"Escape":b(de),e.stopPropagation();break}}}})),B={...Y({backdropHidden$:q,container$:p,hidden$:l,transitioning$:S,visible$:u,modalElement$:s.stores.element$,ariaCloseButtonLabel$:g,className$:h,backdropClass$:y,...x}),directives:{modalPortalDirective:R,backdropPortalDirective:W,backdropDirective:O(D.directives.directive,J),modalDirective:O(s.directives.directive,oe(ie),te(z),K,se),closeButtonDirective:G,dialogDirective:f(ee((e,t)=>{const m=Q=>{Q?e.showModal():e.close()};return m(t),{update:m}}),u)},patch:c,api:{close:b,async open(){return c({visible:!0}),await Z(l).promise,d},patch:c}};return B});export{ce as a,le as b,De as c,de as m};
