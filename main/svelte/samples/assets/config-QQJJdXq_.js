import{ae as m,a0 as i,a1 as b,V as v,J as l,I as w}from"./AppCommon-C3njszSs.js";import{i as u}from"./dom-CzJpOnsw-6p6st5u1.js";import{a as F,f as O,F as C}from"./stores-Bp74MamO.js";import{f as j}from"./index-client-z5mHnK4A.js";const d=(t,e,o=1/0)=>{if(e!==void 0)if(typeof e=="object"&&e&&o>=1){t||(t={});for(const n of Object.keys(e))Object.prototype.hasOwnProperty.call(e,n)&&(n==="__proto__"||n==="constructor"||(t[n]=d(t[n],e[n],o-1)))}else return e;return t},_=(t,e=u)=>{const o=m({}),n=e===u?t:i(()=>e(d({},t?.(),2)));return b(i(()=>d(d({},n?.(),2),o(),2)),{...o,own$:o,adaptedParent$:n,parent$:t})};function x(t,e){return o=>{const n=O(t,o);t=o,n&&e(n)}}const E=(t,e)=>e?(...o)=>{t(...o),e(...o)}:t,P=(t,e)=>{const o=m(e,{equal:Object.is});return b(i(()=>E(t,o())),{set:o.set,update:o.update})},I=(t,e)=>{const{defaultConfig:o,widgetConfig:n,events:r}=e??{},s=e?.props??{},a=F(o),p={...s};if(r)for(const c of Object.keys(r))p[c]=P(r[c],s[c]);const f=t({config:i(()=>({...a(),...n?.()})),props:p}),h=Object.fromEntries(Object.entries(f.stores).map(([c,g])=>[c.slice(0,-1),j(g)])),W=x(s,f.patch);return v(()=>{W({...e?.props})}),{api:f.api,directives:f.directives,state:new Proxy(h,{get(c,g,y){if(Reflect.has(c,g))return Reflect.get(c,g,y).current}})}},R=(t=Symbol("widgetsConfig"))=>{const e=r=>{const s=l(t),a=_(s,r);return w(t,a),a},o=r=>{const s=l(t);return i(()=>s?.()[r])};return{widgetsDefaultConfigKey:t,createWidgetsDefaultConfig:e,getContextWidgetConfig:o,callWidgetFactory:(r,s)=>I(r,{defaultConfig:s?.defaultConfig,widgetConfig:r[C]?o(r[C]):null,events:s?.events,get props(){return s?.props}})}},{callWidgetFactory:T}=R();export{T as c,R as w};
