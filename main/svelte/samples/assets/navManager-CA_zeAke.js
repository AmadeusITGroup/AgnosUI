import{a6 as S,a9 as N}from"./AppCommon-DE0E2XGg.js";import{r as k,s as D,b as x}from"./dom-BB9jLllr-DsL3TsuS.js";const C=t=>{let s=t;for(;s;){const r=getComputedStyle(s);if(s.inert||s.hidden||r.display==="none"||r.visibility==="hidden")return!0;s=s.parentElement}return!1},h=t=>{var s;if(t.disabled)return!1;const r=(s=t.parentElement)==null?void 0:s.closest("fieldset");return r?h(r):!0},O=t=>t.isContentEditable||!!t.hasAttribute("tabindex"),$={INPUT:t=>t.type!=="hidden"&&h(t),SELECT:h,TEXTAREA:h,BUTTON:h,A:t=>!!t.href||O(t)},P=t=>document.contains(t)&&!C(t)&&($[t.tagName]??O)(t),K=(t,s)=>{if(t===s)return 0;const r=t.compareDocumentPosition(s);if(r&Node.DOCUMENT_POSITION_FOLLOWING)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING)return 1;throw new Error("failed to compare elements")},b=t=>getComputedStyle(t).direction,M=new Set(["text","search","url","tel","password"]),L=t=>t instanceof HTMLInputElement&&M.has(t.type),_=t=>{let s=t.key;return t.shiftKey&&(s=`Shift+${s}`),t.altKey&&(s=`Alt+${s}`),t.ctrlKey&&(s=`Ctrl+${s}`),t.metaKey&&(s=`Meta+${s}`),s},U=t=>{const{target:s,key:r}=t;if(L(s)&&(r==="ArrowLeft"||r==="ArrowRight"||r==="Home"||r==="End")){let i;if(r==="ArrowLeft"||r==="ArrowRight"){const a=b(s);i=r===(a==="ltr"?"ArrowLeft":"ArrowRight")}else i=r==="Home";const f=s.selectionStart===s.selectionEnd?s.selectionStart:null;if(i&&f!==0||!i&&f!==s.value.length)return!0}return!1},v=t=>[t],X=()=>{const t=k(),s=S({}),r=(e=!0)=>{s.set({}),e&&(f(),a())},i=N(()=>{s();const e=[];for(const n of t())e.push(...n());return e}),f=N(()=>D(i()),{equal:Object.is}),a=N(()=>[...i()].sort(K)),d=()=>{const e=f();return e?b(e):"ltr"},g=(e,n)=>(e&&(n==null||n.preventDefault()),e),p=(e,n=0)=>{const c=a();for(;e>=0&&e<c.length;){const o=c[e];if(P(o)){if(o.focus(),n!=0&&L(o)){const u=d()!==b(o),l=n>0!==u?0:o.value.length;o.setSelectionRange(l,l,l===0?"forward":"backward")}return o}if(n===0)break;e+=n}return null},E=e=>({event:n,referenceElement:c=(n==null?void 0:n.target)??document.activeElement}={})=>{const o=c?a().indexOf(c):-1;return o>-1?g(p(o+e,e),n):null},R=x((e,n)=>{const c=u=>{var l;if(U(u))return;const F=_(u),A=(l=n.keys)==null?void 0:l[F];A&&(r(!1),A({event:u,directiveElement:e,navManager:T,context:n.context}))};e.addEventListener("keydown",c);const o=t.register(()=>((n==null?void 0:n.selector)??v)(e));return{update(u){n=u},destroy(){e.removeEventListener("keydown",c),o()}}}),y=E(-1),m=E(1),w=({event:e}={})=>g(p(0,1),e),I=({event:e}={})=>g(p(a().length-1,-1),e),T={elementsInDomOrder$:a,directive:R,focusIndex:p,focusPrevious:y,focusNext:m,focusFirst:w,focusFirstLeft:(...e)=>(d()==="rtl"?I:w)(...e),focusFirstRight:(...e)=>(d()==="rtl"?w:I)(...e),focusLast:I,focusLeft:(...e)=>(d()==="rtl"?m:y)(...e),focusRight:(...e)=>(d()==="rtl"?y:m)(...e),refreshElements:r};return T};export{X as c};
