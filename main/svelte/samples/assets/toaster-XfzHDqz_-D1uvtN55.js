import{$ as u,Z as l,ad as v}from"./AppCommon-CsXJDRZ3.js";import{e as b}from"./extendWidget-Dym7HUbM.js";import{a as m,e as w}from"./dom-gfxqXJpK-BenLeVwg.js";import{t as _}from"./stores-BElQIA3m.js";import{k as C,b as H}from"./writables-CgpOQ4hA-DwO4tqpW.js";import{c as $}from"./common-BqUjUBPy-CaOfR52U.js";import{c as W}from"./widget-DeVncyQM.js";var D=Object.defineProperty,g=i=>{throw TypeError(i)},A=(i,e,t)=>e in i?D(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,r=(i,e,t)=>A(i,typeof e!="symbol"?e+"":e,t),y=(i,e,t)=>e.has(i)||g("Cannot "+t),a=(i,e,t)=>(y(i,e,"read from private field"),t?t.call(i):e.get(i)),h=(i,e,t)=>e.has(i)?g("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),M=(i,e,t,s)=>(y(i,e,"write to private field"),e.set(i,t),t),P=(i,e,t,s)=>({set _(n){M(i,e,n)},get _(){return a(i,e,s)}}),c,d,o;const N={autoHide:!0,delay:5e3},k={autoHide:H,delay:C(0,1/0,{strict:!0})},R=W("toast",i=>{let e;const t=b($,N,k)(i),s=u(()=>{clearTimeout(e),t.stores.autoHide$()&&(e=setTimeout(()=>t.api.close(),t.stores.delay$()))}),n=m(()=>({attributes:{role:l("alert"),"aria-atomic":l("true"),class:u(()=>t.stores.className$())},classNames:{"au-toast":_,toast:_}})),p=m(()=>({attributes:{type:l("button"),"aria-label":u(()=>t.stores.ariaCloseButtonLabel$())},events:{click:t.api.close}}));return{...t,directives:{...t.directives,autoHideDirective:w(s),bodyDirective:n,closeButtonDirective:p}}}),T={duration:5e3,position:"bottomRight",dismissible:!1};let G=class{constructor(e){h(this,c,0),h(this,d,v([])),r(this,"toasts",u(()=>a(this,d).call(this).sort((t,s)=>s.id-t.id).slice(0,this.options().limit))),r(this,"options",v(T)),h(this,o,new Map),r(this,"addTimer",(t,s=this.options().duration)=>{s>0&&a(this,o).set(t,{timeout:setTimeout(()=>this.removeToast(t),s),started:performance.now(),duration:s})}),r(this,"pauseTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);s&&s.timeout&&(clearTimeout(s.timeout),s.timeout=null,s.paused=performance.now())}}),r(this,"resumeTimer",t=>{if(a(this,o).has(t)){const s=a(this,o).get(t);if(s){const p=(s.paused??s.started)-s.started,f=(s.duration??0)-p;this.addTimer(t,f),s.duration=f,s.paused=void 0}}}),r(this,"eventsDirective",m(t=>({events:{pointerenter:()=>this.options().pauseOnHover&&this.pauseTimer(t()),pointerleave:()=>this.options().pauseOnHover&&this.resumeTimer(t())}}))),r(this,"addToast",t=>{const s=t.autoHide??this.options().duration>0;return a(this,d).update(n=>[...n,{id:P(this,c)._++,props:t}]),s&&this.addTimer(a(this,c)-1,t.delay),a(this,c)-1}),r(this,"removeToast",t=>{a(this,o).delete(t),a(this,d).update(s=>s.filter(n=>n.id!==t))}),r(this,"updateToasts",()=>{this.options().duration===0&&(this.options().dismissible=!0)}),r(this,"closeAll",()=>{a(this,d).set([]),a(this,o).clear()}),this.options.set({...T,...e}),this.options.subscribe(()=>{this.updateToasts()})}get timers(){return new Map(a(this,o))}};c=new WeakMap;d=new WeakMap;o=new WeakMap;export{G as T,R as c,T as d};
