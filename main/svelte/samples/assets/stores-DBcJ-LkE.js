import{a1 as m,ah as V,ag as k,a0 as u,ai as v,a2 as D,$ as f,a3 as g,aj as O}from"./AppCommon-fKgCL6YI.js";import{k as w,j as h}from"./dom-BPD8lUxd-BXl1zwuB.js";const E=Symbol(),y=Symbol();function I(t){return function(e){D(()=>{for(const[r,n]of Object.entries(e))t[`${r}$`]?.set(n)})}}function P(t,e){if(t===e)return null;let r=!1;const n={},s=new Set([...Object.keys(t),...Object.keys(e)]);for(const o of s){const a=e[o];t[o]!==a&&(n[o]=a,r=!0)}return r?n:null}function W(t,e=f(void 0),r={},n=g(void 0)){const{normalizeValue:s=h,equal:o=Object.is}=r,a=()=>t,c=(i,l=a)=>{const b=i===void 0?void 0:s(i);return b===y?(console.error("Not using invalid value",i),l()):b===void 0?l():b},d=u(()=>c(e()),{equal:o}),S=u(()=>c(n(),d),{equal:o});return m(S,i=>{if(i!==void 0){const l=s(i);if(l===y){console.error("Not setting invalid value",i);return}i=l}n.set(i)})}const p=t=>!!(t&&typeof t=="function"&&"subscribe"in t),$=t=>p(t)?t:f(t),N=t=>p(t)?t:g(t),z=(t,e)=>{const r={};if(e){const n=p(e);for(const s of t)r[s]=n?u(()=>e()[s]):$(e[s])}return r},C=(t,e,r)=>{const n={};for(const s of t){const o=e?.[s],a=r?.[s];n[s]=o&&a?u(()=>o()??a()):o||a}return n},A=(t,e,r)=>{const n={},s=Object.keys(t),o=z(s,e?.config),a=e?.props;for(const c of s){const d=a?.[c];n[`${c}$`]=W(t[c],o[c],r?.[c],N(d))}return n},F=(t,e,r)=>{const n=A(t,e,r);return[n,I(n)]},R=t=>{const e=[],r=[],n={};for(const[s,o]of Object.entries(t))s.endsWith("$")&&(e.push(s.substring(0,s.length-1)),r.push(o),n[s]=k(o));return{stores:n,state$:u(()=>{const s=r.map(v),o={};return e.forEach((a,c)=>{o[a]=s[c]}),o})}},_=(t,e,r=s=>s[0],n=(s,o)=>o===s)=>{let s=e[0]();return m(V(e,{derive(o){const a=r(o),c=!n(o[0],a);return c&&e[0].set(a),(c||!n(s,a))&&(s=a,t()(a)),a},equal:n}),e[0].set.bind(e[0]))},L=(t,e,r=h,n=O)=>m(u(()=>r(t()),{equal:n}),s=>{const o=r(s);n(t(),o)||(t.set(o),e()(o))});function T(t){const e=u(()=>w());return u(()=>t()||e())}const U=f(!0);f(!1);export{E as F,y as I,$ as a,L as b,A as c,p as d,_ as e,P as f,T as i,C as m,z as n,R as s,U as t,F as w};
