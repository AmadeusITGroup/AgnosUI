import{ad as h,$ as f,a0 as C,U as F,J as i,I as O}from"./AppCommon-CsXJDRZ3.js";import{i as m}from"./dom-gfxqXJpK-BenLeVwg.js";import{a as j,f as _,F as b}from"./stores-BElQIA3m.js";import{f as p}from"./index-client-BaNbKOMT.js";const u=(t,e,r=1/0)=>{if(e!==void 0)if(typeof e=="object"&&e&&r>=1){t||(t={});for(const n of Object.keys(e))Object.prototype.hasOwnProperty.call(e,n)&&(n==="__proto__"||n==="constructor"||(t[n]=u(t[n],e[n],r-1)))}else return e;return t},x=(t,e=m)=>{const r=h({}),n=e===m?t:f(()=>e(u({},t==null?void 0:t(),2)));return C(f(()=>u(u({},n==null?void 0:n(),2),r(),2)),{...r,own$:r,adaptedParent$:n,parent$:t})};function E(t,e){return r=>{const n=_(t,r);t=r,n&&e(n)}}const P=(t,e)=>e?(...r)=>{t(...r),e(...r)}:t,w=(t,e)=>{const r=h(e,{equal:Object.is});return C(f(()=>P(t,r())),{set:r.set,update:r.update})},I=(t,e)=>{const{defaultConfig:r,widgetConfig:n,events:a}=e??{},c=(e==null?void 0:e.props)??{},o=j(r),g={...c};if(a)for(const s of Object.keys(a))g[s]=w(a[s],c[s]);const l=t({config:f(()=>({...o(),...n==null?void 0:n()})),props:g}),W=Object.fromEntries(Object.entries(l.stores).map(([s,d])=>[s.slice(0,-1),p(d)])),v=E(c,l.patch);return F(()=>{v({...e==null?void 0:e.props})}),{api:l.api,directives:l.directives,state:new Proxy(W,{get(s,d,y){if(Reflect.has(s,d))return Reflect.get(s,d,y).current}})}},R=(t=Symbol("widgetsConfig"))=>{const e=a=>{const c=i(t),o=x(c,a);return O(t,o),o},r=a=>{const c=i(t);return f(()=>c==null?void 0:c()[a])};return{widgetsDefaultConfigKey:t,createWidgetsDefaultConfig:e,getContextWidgetConfig:r,callWidgetFactory:(a,c)=>I(a,{defaultConfig:c==null?void 0:c.defaultConfig,widgetConfig:a[b]?r(a[b]):null,events:c==null?void 0:c.events,get props(){return c==null?void 0:c.props}})}},{callWidgetFactory:T}=R();export{T as c,R as w};
