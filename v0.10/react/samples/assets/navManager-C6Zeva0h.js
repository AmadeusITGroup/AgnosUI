import{q as k,w as S,b as I,D as $,f as b}from"./dom-iY0R3D7u-CJOgBizl.js";import{i as x}from"./isFocusable-Ckwus82R-adOM025a.js";const E=(r,e)=>{if(r===e)return 0;const o=r.compareDocumentPosition(e);if(o&Node.DOCUMENT_POSITION_FOLLOWING)return-1;if(o&Node.DOCUMENT_POSITION_PRECEDING)return 1;throw new Error("failed to compare elements")},N=r=>getComputedStyle(r).direction,F=new Set(["text","search","url","tel","password"]),R=r=>r instanceof HTMLInputElement&&F.has(r.type),T=r=>{let e=r.key;return r.shiftKey&&(e=`Shift+${e}`),r.altKey&&(e=`Alt+${e}`),r.ctrlKey&&(e=`Ctrl+${e}`),r.metaKey&&(e=`Meta+${e}`),e},P=r=>{const{target:e,key:o}=r;if(R(e)&&(o==="ArrowLeft"||o==="ArrowRight"||o==="Home"||o==="End")){let i;if(o==="ArrowLeft"||o==="ArrowRight"){const a=N(e);i=o===(a==="ltr"?"ArrowLeft":"ArrowRight")}else i=o==="Home";const f=e.selectionStart===e.selectionEnd?e.selectionStart:null;if(i&&f!==0||!i&&f!==e.value.length)return!0}return!1},C=r=>[r],U=()=>{const r=k(),e=S({}),o=(t=!0)=>{e.set({}),t&&(f(),a())},i=I(()=>{e();const t=[];for(const s of r())t.push(...s());return t}),f=I(()=>$(i()),{equal:Object.is}),a=I(()=>[...i()].sort(E)),l=()=>{const t=f();return t?N(t):"ltr"},d=(t,s)=>(t&&s?.preventDefault(),t),h=(t,s=0)=>{const c=a();for(;t>=0&&t<c.length;){const n=c[t];if(x(n)){if(n.focus(),s!=0&&R(n)){const u=l()!==N(n),m=s>0!==u?0:n.value.length;n.setSelectionRange(m,m,m===0?"forward":"backward")}return n}if(s===0)break;t+=s}return null},L=t=>({event:s,referenceElement:c=s?.target??document.activeElement}={})=>{const n=c?a().indexOf(c):-1;return n>-1?d(h(n+t,t),s):null},D=b((t,s)=>{const c=u=>{if(P(u))return;const m=T(u),A=s.keys?.[m];A&&(o(!1),A({event:u,directiveElement:t,navManager:O,context:s.context}))};t.addEventListener("keydown",c);const n=r.register(()=>(s?.selector??C)(t));return{update(u){s=u},destroy(){t.removeEventListener("keydown",c),n()}}}),g=L(-1),p=L(1),w=({event:t}={})=>d(h(0,1),t),y=({event:t}={})=>d(h(a().length-1,-1),t),O={elementsInDomOrder$:a,directive:D,focusIndex:h,focusPrevious:g,focusNext:p,focusFirst:w,focusFirstLeft:(...t)=>(l()==="rtl"?y:w)(...t),focusFirstRight:(...t)=>(l()==="rtl"?w:y)(...t),focusLast:y,focusLeft:(...t)=>(l()==="rtl"?p:g)(...t),focusRight:(...t)=>(l()==="rtl"?g:p)(...t),refreshElements:o};return O};export{U as c};
